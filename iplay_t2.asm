Ideal
; ---------------------------------------------------------------------------

struc		struct_0 ; (sizeof=0xA)
_word_244B7	dw ?
anonymous_0	dw ?
anonymous_1	dw ?
anonymous_2	dw ?
anonymous_3	dw ?			; offset (00019050)
ends		struct_0

extrn _a070295122642:Byte
extrn _aAdlibSoundcard_0:Byte
extrn _aAt:Byte
extrn _aBasePort:Byte
extrn _aBmod2stm:Byte
extrn _aCd81:Byte
extrn _aCh:Byte
extrn _aChn:Byte
extrn _aCouldNotFindT_0:Byte
extrn _aCouldNotFindThe:Byte
extrn _aCovox_0:Byte
extrn _aDeviceNotIniti:Byte
extrn _aDma:Byte
extrn _aDramDma:Byte
extrn _aE_g_:Byte
extrn _aErrorCouldNotFi:Byte
extrn _aErrorCouldNot_0:Byte
extrn _aErrorCouldNot_1:Byte
extrn _aErrorSoundcardN:Byte
extrn _aFar:Byte
extrn _aFlt4:Byte
extrn _aFlt8:Byte
extrn _aGeneralMidi_0:Byte
extrn _aGravisUltrasoun:Byte
extrn _aGsft:Byte
extrn _aHGf1Irq:Byte
extrn _aHIrq:Byte
extrn _aIf:Byte
extrn _aInertiaModule:Byte
extrn _aInertiaModule_0:Byte
extrn _aInertiaModule_1:Byte
extrn _aInertiaSample:Byte
extrn _aJn:Byte
extrn _aKhz:Byte
extrn _aMK:Byte
extrn _aMK_0:Byte
extrn _aM_k_:Byte
extrn _aMas_utrack_v:Byte
extrn _aMixedAt:Byte
extrn _aMtm:Byte
extrn _aNotEnoughDramOn:Byte
extrn _aNotEnoughMemory:Byte
extrn _aOcta:Byte
extrn _aPcHonker_0:Byte
extrn _aProAudioSpectrum:Byte
extrn _aPsm:Byte
extrn _aScream:Byte
extrn _aScrm:Byte
extrn _aSomeFunctionsOf:Byte
extrn _aSoundBlaster1616:Byte
extrn _aSoundBlasterPro:Byte
extrn _aSoundBlaster_0:Byte
extrn _aStereoOn1_0:Byte
extrn _aTdz:Byte
extrn _aThisProgramRequ:Byte
extrn _aWindowsSoundSyst:Byte
extrn _a_m_k:Byte
extrn _amplification:Word
extrn _asmprintf_tbl:Word
extrn _base_port2:Word
extrn _bit_mode:Byte
extrn _byte_11C29:Byte
extrn _byte_13C54:Byte
extrn _byte_14F70:Byte
extrn _byte_14F71:Byte
extrn _byte_14F72:Byte
extrn _byte_14F73:Byte
extrn _byte_158B4:Byte
extrn _byte_158E3:Byte
extrn _byte_15912:Byte
extrn _byte_15941:Byte
extrn _byte_15970:Byte
extrn _byte_1599F:Byte
extrn _byte_159CE:Byte
extrn _byte_159FD:Byte
extrn _byte_15A2C:Byte
extrn _byte_15A5B:Byte
extrn _byte_15A8A:Byte
extrn _byte_15AB9:Byte
extrn _byte_15AE8:Byte
extrn _byte_15B17:Byte
extrn _byte_15B46:Byte
extrn _byte_15B81:Byte
extrn _byte_15BAD:Byte
extrn _byte_15BDA:Byte
extrn _byte_15C07:Byte
extrn _byte_15C34:Byte
extrn _byte_15C61:Byte
extrn _byte_15C8E:Byte
extrn _byte_15CBB:Byte
extrn _byte_15CE8:Byte
extrn _byte_15D15:Byte
extrn _byte_15D42:Byte
extrn _byte_15D6F:Byte
extrn _byte_15D9C:Byte
extrn _byte_15DC9:Byte
extrn _byte_15DF6:Byte
extrn _byte_15E23:Byte
extrn _byte_16379:Byte
extrn _byte_163A8:Byte
extrn _byte_163D7:Byte
extrn _byte_16406:Byte
extrn _byte_16435:Byte
extrn _byte_16493:Byte
extrn _byte_164C2:Byte
extrn _byte_164F1:Byte
extrn _byte_16520:Byte
extrn _byte_1654F:Byte
extrn _byte_1657E:Byte
extrn _byte_165DC:Byte
extrn _byte_1660B:Byte
extrn _byte_16646:Byte
extrn _byte_16672:Byte
extrn _byte_1669F:Byte
extrn _byte_166CC:Byte
extrn _byte_166F9:Byte
extrn _byte_16726:Byte
extrn _byte_16753:Byte
extrn _byte_16780:Byte
extrn _byte_167AD:Byte
extrn _byte_167DA:Byte
extrn _byte_16807:Byte
extrn _byte_16834:Byte
extrn _byte_16861:Byte
extrn _byte_1688E:Byte
extrn _byte_168BB:Byte
extrn _byte_168E8:Byte
extrn _byte_24616:Byte
extrn _byte_24617:Byte
extrn _byte_24618:Byte
extrn _byte_24619:Byte
extrn _byte_2461A:Byte
extrn _byte_2461B:Byte
extrn _byte_2461C:Byte
extrn _byte_2461D:Byte
extrn _byte_2461E:Byte
extrn _byte_2461F:Byte
extrn _byte_24620:Byte
extrn _byte_24621:Byte
extrn _byte_24623:Byte
extrn _byte_24625:Byte
extrn _byte_24628:Byte
extrn _byte_24629:Byte
extrn _byte_2462B:Byte
extrn _byte_2462D:Byte
extrn _byte_2463B:Byte
extrn _byte_24645:Byte
extrn _byte_2464A:Byte
extrn _byte_2464B:Byte
extrn _byte_24650:Byte
extrn _byte_24651:Byte
extrn _byte_24664:Byte
extrn _byte_24665:Byte
extrn _byte_24666:Byte
extrn _byte_24667:Byte
extrn _byte_24668:Byte
extrn _byte_24669:Byte
extrn _byte_2466A:Byte
extrn _byte_2466B:Byte
extrn _byte_2466C:Byte
extrn _byte_2466D:Byte
extrn _byte_2466E:Byte
extrn _byte_24671:Byte
extrn _byte_24673:Byte
extrn _byte_24674:Byte
extrn _byte_24675:Byte
extrn _byte_24676:Byte
extrn _byte_24677:Byte
extrn _byte_24678:Byte
extrn _byte_24679:Byte
extrn _byte_2467A:Byte
extrn _byte_2467B:Byte
extrn _byte_2467C:Byte
extrn _byte_2467D:Byte
extrn _byte_2467E:Byte
extrn _byte_24682:Byte
extrn _byte_24683:Byte
extrn _byte_2469B:Byte
extrn _byte_2469C:Byte
extrn _byte_246A5:Byte
extrn _byte_246A8:Byte
extrn _byte_246D8:Byte
extrn _byte_246D9:Byte
extrn _byte_246DC:Byte
extrn _byte_257DA:Byte
extrn _byte_257DB:Byte
extrn _byte_257DC:Byte
extrn _byte_257F2:Byte
extrn _byte_257F3:Byte
extrn _byte_2588B:Byte
extrn _byte_2588C:Byte
extrn _byte_2588D:Byte
extrn _byte_27FE8:Byte
extrn _byte_280E7:Byte
extrn _byte_280E8:Byte
extrn _byte_281E8:Byte
extrn _byte_282E8:Byte
extrn _byte_30522:Byte
extrn _byte_30523:Byte
extrn _byte_30526:Byte
extrn _byte_30529:Byte
extrn _byte_30537:Byte
extrn _byte_30539:Byte
extrn _byte_3053A:Byte
extrn _byte_3053B:Byte
extrn _byte_30548:Byte
extrn _byte_3054B:Byte
extrn _byte_3054C:Byte
extrn _byte_30550:Byte
extrn _byte_30576:Byte
extrn _byte_30577:Byte
extrn _byte_30579:Byte
extrn _byte_3059A:Byte
extrn _byte_305F9:Byte
extrn _byte_30639:Byte
extrn _byte_3063A:Byte
extrn _byte_30641:Byte
extrn _byte_30669:Byte
extrn _byte_3066A:Byte
extrn _byte_3066B:Byte
extrn _byte_30679:Byte
extrn _byte_306DE:Byte
extrn _byte_308BE:Byte
extrn _byte_30908:Byte
extrn _byte_30940:Byte
extrn _byte_30943:Byte
extrn _byte_3150A:Byte
extrn _byte_3150C:Byte
extrn _byte_31D08:Byte
extrn _byte_33508:Byte
extrn _byte_34510:Byte
extrn _change_amplif:far
extrn _change_volume:far
extrn _chrin:Dword
extrn _clean_11C43:far
extrn _config_word:Word
extrn _covox_timer_int:far
extrn _covox_txt:Byte
extrn _deinit_125B9:far
extrn _dma_buf_pointer:Dword
extrn _dma_channel:Byte
extrn _dma_channel2:Byte
extrn _dma_channel_0:Byte
extrn _dma_chn_mask:Byte
extrn _dma_mode:Byte
extrn _dword_245BC:Dword
extrn _dword_245C0:Dword
extrn _dword_245C4:Dword
extrn _dword_2463C:Dword
extrn _dword_24640:Dword
extrn _dword_24684:Dword
extrn _dword_24694:Dword
extrn _dword_257A0:Dword
extrn _dword_25886:Dword
extrn _dword_25892:Dword
extrn _dword_25896:Dword
extrn _dword_27BC8:Dword
extrn _dword_27BCC:Dword
extrn _dword_30518:Dword
extrn _dword_3055A:Dword
extrn _dword_30566:Dword
extrn _dword_3063D:Dword
extrn _eModuleNotFound:Byte
extrn _effoff_18F60:Word
extrn _effoff_18FA2:Word
extrn _effoff_18FE4:Word
extrn _effoff_19026:Word
extrn _ems_enabled:Byte
extrn _ems_handle:Word
extrn _ems_log_pagenum:Word
extrn _ems_pageframe:Word
extrn _fhandle_module:Word
extrn _flag_playsetttings:Byte
extrn _freq1:Word
extrn _freq2:Word
extrn _freq_245DE:Word
extrn _freq_246D7:Byte
extrn _get_12F7C:far
extrn _get_playsettings:far
extrn _getset_playstate:far
extrn _gravis_port:Word
extrn _gravis_txt:Byte
extrn _int8addr:Dword
extrn _interrupt_mask:Word
extrn _intvectoffset:Word
extrn _irq_number:Byte
extrn _irq_number2:Byte
extrn _irq_number_0:Byte
extrn _memflg_2469A:Byte
extrn _memfree_125DA:far
extrn _midi_int8p:far
extrn _midi_txt:Byte
extrn _mod_readfile_11F4E:far
extrn _module_type_text:Dword
extrn _moduleflag_246D0:Word
extrn _moduleread:far
extrn _my_in:Byte
extrn _my_seg_index:Word
extrn _my_size:Word
extrn _myin:Dword
extrn _myin_0:Byte
extrn _myout:Byte
extrn _myseg_24698:Word
extrn _myseg_size:Word
extrn _offs_interpol:Word
extrn _offs_interpol2:Word
extrn _offs_noninterp:Word
extrn _offs_noninterp2:Word
extrn _old_intprocoffset:Word
extrn _old_intprocseg:Word
extrn _pc_timer_tbl:Byte
extrn _pcspeaker_text:Byte
extrn _play_state:Byte
extrn _pointer_245B4:Dword
extrn _read_sndsettings:far
extrn _s3mtable_108D6:Byte
extrn _s3mtable_108F0:Byte
extrn _savesp_245D0:Word
extrn _sb16_handler_int:far
extrn _sb16_txt:Byte
extrn _sb_base_port:Word
extrn _sb_int_counter:Byte
extrn _sb_irq_number:Byte
extrn _sb_timeconst:Byte
extrn _segs_table:Word
extrn _set_playsettings:far
extrn _snd_base_port:Word
extrn _snd_cards_offs:Word
extrn _snd_init:Byte
extrn _snd_offx:far
extrn _snd_set_flag:Byte
extrn _sndcard_type:Byte
extrn _sndflags_24622:Byte
extrn _sound_port:Word
extrn _stereo_timer_int:far
extrn _table_13EC3:Byte
extrn _table_14057:Byte
extrn _table_246F6:Word
extrn _table_24716:Word
extrn _table_24798:Word
extrn _table_24818:Word
extrn _table_24898:Byte
extrn _table_25118:Word
extrn _table_251C0:Byte
extrn _table_251E0:Byte
extrn _table_25221:Byte
extrn _table_25261:Byte
extrn _timer_int_end:far
extrn _timer_word_14F6E:Word
extrn _vlm_byte_table:Byte
extrn _volume_12A66:far
extrn _volume_245FC:Word
extrn _volume_25908:Byte
extrn _volume_prep:far
extrn _word_14913:Word
extrn _word_14BBB:Word
extrn _word_14CEB:Word
extrn _word_14F6C:Word
extrn _word_14FC0:Word
extrn _word_14FC5:Word
extrn _word_14FC8:Word
extrn _word_1504D:Word
extrn _word_15056:Word
extrn _word_15126:Word
extrn _word_1519B:Word
extrn _word_151A3:Word
extrn _word_245D2:Word
extrn _word_245D4:Word
extrn _word_245D6:Word
extrn _word_245D8:Word
extrn _word_245DA:Word
extrn _word_245DC:Word
extrn _word_245E4:Word
extrn _word_245E8:Word
extrn _word_245EA:Word
extrn _word_245EC:Word
extrn _word_245EE:Word
extrn _word_245F0:Word
extrn _word_245F2:Word
extrn _word_245F6:Word
extrn _word_245F8:Word
extrn _word_245FA:Word
extrn _word_24600:Word
extrn _word_24602:Word
extrn _word_2460C:Word
extrn _word_2460E:Word
extrn _word_24610:Word
extrn _word_24614:Word
extrn _word_24630:Word
extrn _word_24632:Word
extrn _word_24634:Word
extrn _word_24636:Word
extrn _word_24646:Word
extrn _word_24654:Word
extrn _word_2465C:Word
extrn _word_24662:Word
extrn _word_2468C:Word
extrn _word_246A6:Word
extrn _word_246A9:Word
extrn _word_246DE:Word
extrn _word_24998:Word
extrn _word_257A4:Word
extrn _word_257E6:Word
extrn _word_257E8:Word
extrn _word_257EA:Word
extrn _word_257EC:Word
extrn _word_257EE:Word
extrn _word_257F0:Word
extrn _word_2588E:Word
extrn _word_30515:Word
extrn _word_30520:Word
extrn _word_30524:Word
extrn _word_3052A:Word
extrn _word_3052C:Word
extrn _word_30532:Word
extrn _word_30552:Word
extrn _word_30554:Word
extrn _word_30556:Word
extrn _word_30562:Word
extrn _word_30564:Word
extrn _word_3063B:Word
extrn _word_31508:Word
extrn _wss_freq_table:Word
extrn _wss_freq_table2:Word
extrn asc_1058C:Byte
extrn asc_182C3:Byte
extrn asc_182D3:Byte
extrn asc_246B0:Byte
extrn asc_25856:Byte
extrn off_18E00:Word
extrn off_18E60:Word
extrn off_18E80:Word
extrn off_18EA0:Word
extrn off_18EC0:Word
extrn off_18EE0:Word
extrn off_18F00:Word
extrn off_18F20:Word
extrn off_18F40:Word
extrn off_245C8:Word
extrn off_245CA:Word
extrn off_245CC:Word
extrn off_245CE:Word
extrn off_245E0:Word
extrn off_245E2:Word
extrn off_2462E:Word
extrn off_24656:Word
extrn off_25326:Word
extrn sub_1265D:far
extrn sub_126A9:far
extrn sub_12AFD:far
extrn sub_12B18:far
extrn sub_12B83:far
extrn sub_12CAD:far
extrn sub_12D05:far
extrn sub_12D35:far
extrn sub_12DA8:far
extrn sub_12EBA:far
extrn sub_12F56:far
extrn unk_16464:Byte
extrn unk_165AD:Byte
extrn unk_257D9:Byte
extrn unk_258A6:Byte
extrn unk_30528:Byte
extrn unk_3054A:Byte
extrn unk_30941:Byte


;
;
; Input	MD5   :	3ADEF234086ACD44430B68CC52471B0D
; Input	CRC32 :	B294245C

; File Name   :	I:\IPLAY.EXE
; Format      :	MS-DOS executable (EXE)
; Base Address:	1000h Range: 10000h-35510h Loaded length: 16308h
; Entry	Point :	1905:42

		p486
		model large

; ---------------------------------------------------------------------------
; ===========================================================================

; Segment type:	Pure code
segment		seg001 byte public 'CODE' use16
		assume cs:seg001
; START	OF FUNCTION CHUNK FOR _start
		assume es:nothing, ss:nothing, ds:dseg,	fs:nothing, gs:nothing

loc_19050:				; CODE XREF: _start+4Cj
					; DATA XREF: dseg:off_1DE3Co ...
		call	_callsubx

loc_19053:
		jb	loc_192B9

loc_19057:				; "\rCurrent Soundcard settings:\r\n\n$"
		mov	dx, offset _aCurrentSoundcard
		mov	ah, 9
		int	21h		; DOS -	PRINT STRING
					; DS:DX	-> string terminated by	"$"
		mov	ax, ds
		mov	es, ax
		assume es:dseg
		mov	di, offset _buffer_1 ; 2800h
		call	sub_12D05
		mov	[byte ptr es:di], '$'

loc_1906E:				; 2800h
		mov	dx, offset _buffer_1
		mov	ah, 9
		int	21h		; DOS -	PRINT STRING
					; DS:DX	-> string terminated by	"$"
		mov	dx, offset _myendl ; "\r\n$"
		mov	ah, 9
		int	21h		; DOS -	PRINT STRING
					; DS:DX	-> string terminated by	"$"

loc_1907C:
		call	_deinit_125B9
		mov	ax, 4C00h

loc_19084:				; DOS -	2+ - QUIT WITH EXIT CODE (EXIT)
		int	21h		; AL = exit code
; ---------------------------------------------------------------------------

loc_19086:				; CODE XREF: _start+57j
		mov	dx, 0
		mov	ah, 9
		int	21h		; DOS -	PRINT STRING
					; DS:DX	-> string terminated by	"$"

loc_1908D:
		mov	ax, 4C00h

loc_19090:				; DOS -	2+ - QUIT WITH EXIT CODE (EXIT)
		int	21h		; AL = exit code
; END OF FUNCTION CHUNK	FOR _start
		assume ss:seg004, ds:nothing

; =============== S U B	R O U T	I N E =======================================


proc		_start far

; FUNCTION CHUNK AT 0000 SIZE 00000042 BYTES
; FUNCTION CHUNK AT 07D7 SIZE 00000059 BYTES
; FUNCTION CHUNK AT 0D44 SIZE 0000007D BYTES

		mov	ax, dseg

loc_19095:
		mov	ds, ax
		assume ds:dseg
		mov	[_esseg_atstart], es
		mov	ax, sp
		add	ax, 13h
		mov	cl, 4

loc_190A2:
		shr	ax, cl
		mov	bx, ss
		add	bx, ax
		mov	ax, es
		sub	bx, ax
		mov	ah, 4Ah
		int	21h		; DOS -	2+ - ADJUST MEMORY BLOCK SIZE (SETBLOCK)
					; ES = segment address of block	to change
					; BX = new size	in paragraphs
		cld

loc_190B1:
		xor	dl, dl
		mov	cx, 4D50h	; PM
		mov	bx, 5344h	; DS
		mov	ax, 60FFh

loc_190BC:
		int	2Fh
		cmp	ax, 4F4Bh	; 'KO' check for single instance
		jnz	short loc_190D3
		mov	dx, offset _aCriticalErrorT ; "\r\n\nCritical error: The	player jumped to"...
		mov	ah, 9
		int	21h		; DOS -	PRINT STRING
					; DS:DX	-> string terminated by	"$"
		xor	ah, ah
		int	16h		; KEYBOARD - READ CHAR FROM BUFFER, WAIT IF EMPTY
					; Return: AH = scan code, AL = character

loc_190CE:
		mov	ax, 4C02h
		int	21h		; DOS -	2+ - QUIT WITH EXIT CODE (EXIT)
					; AL = exit code
; ---------------------------------------------------------------------------

loc_190D3:				; CODE XREF: _start+2Fj
		call	_loadcfg
		call	_parse_cmdline
		bt	ebp, 8
		jb	loc_19050

loc_190E2:
		test	ebp, 80000080h
		jnz	short loc_19086
		bt	ebp, 0Bh
		jnb	short loc_190F7
		or	[byte ptr _configword], 4

loc_190F7:				; CODE XREF: _start+5Ej
		bt	ebp, 3
		jnb	short loc_19103
		and	[byte ptr _configword], 0FBh

loc_19103:				; CODE XREF: _start+6Aj
		bt	ebp, 6
		jnb	short loc_19114
		and	[byte ptr _configword+1], 0F1h
		or	[byte ptr _configword+1], 2

loc_19114:				; CODE XREF: _start+76j
		bt	ebp, 5
		jnb	short loc_19125
		and	[byte ptr _configword+1], 0F1h
		or	[byte ptr _configword+1], 4

loc_19125:				; CODE XREF: _start+87j
		bt	ebp, 13h
		jnb	short loc_19131
		and	[byte ptr _configword+1], 0F1h

loc_19131:				; CODE XREF: _start+98j
		bt	ebp, 4
		jnb	short loc_1913D
		and	[byte ptr _configword], 0FDh

loc_1913D:				; CODE XREF: _start+A4j
		bt	ebp, 14h
		jnb	short loc_19149
		and	[byte ptr _configword], 0FEh

loc_19149:				; CODE XREF: _start+B0j
		bt	ebp, 0Eh
		jnb	short loc_19155
		and	[byte ptr _configword], 0BFh

loc_19155:				; CODE XREF: _start+BCj
		bt	ebp, 2
		jnb	short loc_19161
		or	[byte ptr _configword], 40h

loc_19161:				; CODE XREF: _start+C8j
		bt	ebp, 15h
		setb	al
		mov	[_byte_1DE86], al
		mov	al, [_byte_1DCF8]
		mov	ah, al
		and	al, 0Fh
		mov	[_byte_1DE82], al
		shr	ah, 4
		mov	[_byte_1DE83], ah

loc_1917D:
		mov	[_videomempointer], 0B8000000h
		mov	ax, 3508h
		int	21h		; DOS -	2+ - GET INTERRUPT VECTOR
					; AL = interrupt number
					; Return: ES:BX	= value	of interrupt vector
		mov	[_oint8off_1DE14], bx
		mov	[_oint8seg_1DE16], es
		mov	ax, 3509h
		int	21h		; DOS -	2+ - GET INTERRUPT VECTOR
					; AL = interrupt number
					; Return: ES:BX	= value	of interrupt vector
		mov	[word ptr cs:_oint9_1C1A4], bx
		mov	[word ptr cs:_oint9_1C1A4+2], es

loc_191A2:
		mov	ax, 3524h

loc_191A5:				; DOS -	2+ - GET INTERRUPT VECTOR
		int	21h		; AL = interrupt number
					; Return: ES:BX	= value	of interrupt vector
		mov	[word ptr cs:_oint24_1C1AC], bx
		mov	[word ptr cs:_oint24_1C1AC+2], es
		mov	ax, 352Fh
		int	21h		; DOS -	2+ - GET INTERRUPT VECTOR
					; AL = interrupt number
					; Return: ES:BX	= value	of interrupt vector
		mov	[word ptr cs:_oint2f_1C1B4], bx
		mov	[word ptr cs:_oint2f_1C1B4+2], es
		push	ds
		mov	ax, cs
		mov	ds, ax
		assume ds:seg001
		mov	dx, offset _int9_keyb
		mov	ax, 2509h
		int	21h		; DOS -	SET INTERRUPT VECTOR
					; AL = interrupt number
					; DS:DX	= new vector to	be used	for specified interrupt
		mov	dx, offset _int24
		mov	ax, 2524h
		int	21h		; DOS -	SET INTERRUPT VECTOR
					; AL = interrupt number
					; DS:DX	= new vector to	be used	for specified interrupt
		mov	dx, offset _int2f_checkmyself
		mov	ax, 252Fh

loc_191DB:				; DOS -	SET INTERRUPT VECTOR
		int	21h		; AL = interrupt number
					; DS:DX	= new vector to	be used	for specified interrupt
		pop	ds
		assume ds:dseg
		mov	ah, 34h
		int	21h		; DOS -	2+ internal - RETURN CritSectFlag (InDOS) POINTER
		mov	[_critsectpoint_off], bx
		mov	[_critsectpoint_seg], es

loc_191EA:
		push	ds
		mov	ax, 5D06h
		int	21h		; DOS -	3.1+ internal -	GET ADDRESS OF DOS SWAPPABLE DATA AREA
					; Return: CF set on error, CF clear if successful
		mov	ax, ds
		pop	ds
		mov	[_swapdata_off],	si
		mov	[_swapdata_seg],	ax
		mov	[_byte_1DE70], 0FFh
		call	_mouse_init
		mov	bl, [byte ptr _configword+1]
		shr	bl, 1
		and	bx, 7
		cmp	bl, 5
		jbe	short loc_19212
		xor	bl, bl

loc_19212:				; CODE XREF: _start+17Cj
		shl	bx, 1
		mov	ax, [off_1CA8E+bx]
		mov	[off_1DE3C], ax
		cmp	[_buffer_1DB6C],	40h ; '@'
		jz	loc_19D94
		cmp	[_buffer_1DB6C],	20h ; ' '
		jbe	loc_192CA
		mov	[_word_1DE4E], 2
		call	_find_mods
		jb	short loc_19256
		call	_callsubx
		jb	short loc_19256
		call	_readallmoules
		jb	short loc_19250

loc_19242:
		cmp	[byte ptr _word_1DE50], 1Ch
		jz	loc_192E0
		mov	[_byte_1DE7E], 0

loc_19250:				; CODE XREF: _start+1AEj _start+5C2j ...
		cli
		call	_deinit_125B9

loc_19256:				; CODE XREF: _start+1A4j _start+1A9j ...
		call	_mouse_deinit
		push	ds
		lds	dx, [cs:_oint2f_1C1B4]
		mov	ax, 252Fh
		int	21h		; DOS -	SET INTERRUPT VECTOR
					; AL = interrupt number
					; DS:DX	= new vector to	be used	for specified interrupt
		pop	ds
		push	ds
		lds	dx, [cs:_oint24_1C1AC]
		mov	ax, 2524h
		int	21h		; DOS -	SET INTERRUPT VECTOR
					; AL = interrupt number
					; DS:DX	= new vector to	be used	for specified interrupt
		pop	ds
		push	ds
		lds	dx, [cs:_oint9_1C1A4]
		mov	ax, 2509h
		int	21h		; DOS -	SET INTERRUPT VECTOR
					; AL = interrupt number
					; DS:DX	= new vector to	be used	for specified interrupt
		pop	ds
		mov	ax, 3
		int	10h		; - VIDEO - SET	VIDEO MODE
					; AL = mode
		call	_txt_enableblink
		mov	cx, 0
		mov	dx, 124Fh
		mov	bl, 78h	; 'x'
		mov	ax, 7F03h
		call	_draw_frame
		call	_txt_draw_top_title
		mov	si, offset _hopeyoulike
		les	di, [_videomempointer]
		assume es:nothing
		call	_write_scr
		mov	dx, 1300h
		xor	bh, bh
		mov	ah, 2
		int	10h		; - VIDEO - SET	CURSOR POSITION
					; DH,DL	= row, column (0,0 = upper left)
					; BH = page number
		cmp	[_byte_1DE7E], 0
		jz	short loc_192C3
		mov	dx, 1400h
		xor	bh, bh
		mov	ah, 2
		int	10h		; - VIDEO - SET	CURSOR POSITION
					; DH,DL	= row, column (0,0 = upper left)
					; BH = page number

loc_192B9:				; CODE XREF: _start:loc_19053j
		push	ds
		lds	dx, [_messagepointer]
		mov	ah, 9
		int	21h		; DOS -	PRINT STRING
					; DS:DX	-> string terminated by	"$"
		pop	ds

loc_192C3:				; CODE XREF: _start+21Cj
		mov	ah, 4Ch	; 'L'
		mov	al, [_byte_1DE7E]
		int	21h		; DOS -	2+ - QUIT WITH EXIT CODE (EXIT)
					; AL = exit code

loc_192CA:				; CODE XREF: _start+197j
		mov	[_byte_1DE7E], 5
		mov	[word ptr _messagepointer], offset _aNotEnoughMemor ; "Not enough	memory.\r\n$"
		mov	[word ptr _messagepointer+2], ds
		call	_callsubx
		jb	loc_19256

loc_192E0:				; CODE XREF: _start+1B5j
		mov	si, offset _mystr ; str
		call	_dosgetcurdir
		mov	[_word_1DE62], 0
		mov	[_word_1DE5E], 0
		mov	[_byte_1DE7F], 1

loc_192F7:				; CODE XREF: _start+456j _start+6F3j ...
		call	_setvideomode
		mov	[_byte_1DE70], 1

loc_192FF:				; CODE XREF: _start+471j _start+4A7j ...
		mov	cx, 0
		mov	dx, 1B4Fh
		mov	bl, 78h	; 'x'
		mov	ax, 7F03h
		call	_draw_frame
		call	_txt_draw_top_title
		mov	ax, ds
		mov	es, ax
		assume es:dseg
		mov	di, offset _buffer_1 ; 2800h
		call	sub_12D05
		mov	[byte ptr es:di], 0
		sub	di, 16EFh
		and	di, 0FFFEh
		mov	ax, 50h	; 'P'
		sub	ax, di
		add	ax, 320h
		les	di, [_videomempointer]
		assume es:nothing
		add	di, ax		; videoptr
		mov	si, offset _buffer_1 ; str
		mov	ah, 78h	; 'x'   ; color
		call	_put_message
		mov	cx, 604h
		mov	dx, 84Bh
		mov	bl, 7Fh	; ''
		mov	ax, 7803h
		call	_draw_frame
		mov	ah, 19h
		int	21h		; DOS -	GET DEFAULT DISK NUMBER
		mov	edx, 5C3A41h	; "A:\"
		add	dl, al
		mov	[_buffer_1DC6C],	edx
		mov	si, (offset _buffer_1DC6C+3)
		xor	dl, dl
		mov	ah, 47h
		int	21h		; DOS -	2+ - GET CURRENT DIRECTORY
					; DL = drive (0=default, 1=A, etc.)
					; DS:SI	points to 64-byte buffer area
		mov	si, offset _buffer_1DC6C
		call	_mystrlen
		shr	ax, 1
		neg	ax
		add	ax, 257h
		shl	ax, 1
		les	di, [_videomempointer]
		add	di, ax		; videoptr
		mov	si, offset _buffer_1DC6C	; str
		mov	ah, 7Bh	; '{'   ; color
		call	_put_message
		cmp	[_byte_1DE7F], 1
		jnz	short loc_19395
		mov	si, offset _msg	; "Searching directory for modules  "
		mov	ax, 7E0Dh
		call	_message_1BE77
		call	_modules_search

loc_19395:				; CODE XREF: _start+2F5j
		mov	[_byte_1DE7E], 0
		mov	[_word_1DE60], 0FFFFh
		mov	cx, 906h
		mov	dx, 1949h
		mov	bl, 7Fh	; ''
		mov	ax, 7803h
		call	_draw_frame

loc_193AE:				; CODE XREF: _start+4C8j _start+4EAj ...
		call	_filelist_198B8
		mov	ax, [_word_1DE62]
		mov	bl, 10h
		call	_recolortxt

loc_193BC:				; CODE XREF: _start+3CBj _start+481j ...
		mov	al, [_byte_1DE7C]
		xor	al, 1
		mov	[_byte_1DE7D], al
		call	_mouse_show

loc_193C7:				; CODE XREF: _start+373j
		test	[_byte_1DE90], 2
		jnz	loc_19848
		test	[_byte_1DE90], 1
		jnz	loc_19827
		mov	al, [_byte_1DE7C]
		cmp	al, [_byte_1DE7D]
		jz	short loc_193FF	; keyboard message loop	here
		mov	[_byte_1DE7D], al
		les	di, [_videomempointer]
		add	di, 104Ah	; videoptr
		mov	ah, 78h	; 'x'   ; color
		mov	si, offset _aHitBackspaceToRe ; "Hit backspace to return	to playmode, F-"...
		cmp	[_byte_1DE7C], 0
		jz	short loc_193FC
		mov	si, offset _aPressF1ForHelpQu ; "		 Press F-1 for help, Qu"...

loc_193FC:				; CODE XREF: _start+365j
		call	_put_message

loc_193FF:				; CODE XREF: _start+34Ej
		mov	ax, [cs:_key_code] ; keyboard message loop here
		or	ax, ax
		jz	short loc_193C7
		push	ax
		call	_mouse_hide
		pop	ax
		mov	[cs:_key_code], 0
		cmp	al, 1
		jz	loc_1964E
		cmp	al, 48h	; 'H'
		jz	loc_1957F
		cmp	al, 50h	; 'P'
		jz	loc_1953C
		cmp	al, 47h	; 'G'
		jz	loc_195A7
		cmp	al, 4Fh	; 'O'
		jz	loc_195BE
		cmp	al, 49h	; 'I'
		jz	loc_195EA
		cmp	al, 51h	; 'Q'

loc_19439:
		jz	loc_19610
		cmp	al, 0Eh
		jz	loc_19762
		cmp	al, 53h	; 'S'

loc_19445:
		jz	loc_19657
		cmp	al, 3Bh	; ';'
		jz	loc_19788
		cmp	al, 42h	; 'B'
		jz	loc_197D6
		cmp	al, 43h	; 'C'
		jz	loc_197E7
		cmp	al, 1Ch
		jnz	loc_193BC
		mov	ax, [_word_1DE62]

loc_19464:				; CODE XREF: seg001:0839j
		add	ax, [_word_1DE5E]
		mov	dx, ax
		shl	ax, 1
		add	ax, dx
		add	ax, [_word_1DE52]
		mov	fs, ax
		mov	si, 0Ch
		mov	ax, ds
		mov	es, ax
		assume es:dseg
		mov	di, offset _buffer_1DB6C
		mov	dx, di
		cld
		movs	[dword ptr es:di], [dword ptr fs:si]
		movs	[dword ptr es:di], [dword ptr fs:si]
		movs	[dword ptr es:di], [dword ptr fs:si]
		mov	[byte ptr di], 0
		cmp	[byte ptr fs:2], 0
		jz	short loc_194EB
		cmp	[byte ptr fs:2], 1
		jz	short loc_19506
		push	dx

loc_1949E:
		mov	cx, 501h
		mov	dx, 1A4Eh
		mov	bl, 7Fh	; ''
		mov	ax, 7800h
		call	_draw_frame
		mov	si, offset _aLoadingModule ; _msg
		mov	ax, 7E0Dh
		call	_message_1BE77
		pop	dx
		call	_read_module

loc_194B9:
		jnb	short loc_194E3
		mov	si, offset _aNotEnoughMemo_0 ; "Not enough memory available to load all"...
		cmp	ax, 0FFFEh
		jz	short loc_194CE
		mov	si, offset _aNotEnoughDram_0 ; "Not enough DRAM on your UltraSound to l"...
		cmp	ax, 0FFFDh
		jz	short loc_194CE
		mov	si, offset _aModuleIsCorrupt ; _msg

loc_194CE:				; CODE XREF: _start+42Fj _start+437j
		mov	ax, 7E0Dh
		call	_message_1BE77
		xor	ax, ax
		mov	[cs:_key_code], ax

loc_194DA:				; CODE XREF: _start+44Fj
		xchg	ax, [cs:_key_code]
		or	ax, ax
		jz	short loc_194DA

loc_194E3:				; CODE XREF: _start:loc_194B9j
		mov	[_byte_1DE7F], 0
		jmp	loc_192F7
; ---------------------------------------------------------------------------

loc_194EB:				; CODE XREF: _start+401j
		mov	[_byte_1DE7F], 1
		mov	dx, offset _buffer_1DB6C
		mov	ah, 3Bh
		int	21h		; DOS -	2+ - CHANGE THE	CURRENT	DIRECTORY (CHDIR)
					; DS:DX	-> ASCIZ directory name	(may include drive)
		mov	[_word_1DE62], 0
		mov	[_word_1DE5E], 0
		jmp	loc_192FF
; ---------------------------------------------------------------------------

loc_19506:				; CODE XREF: _start+409j
		mov	[_byte_1DE7F], 1
		mov	dl, [fs:0Dh]
		sub	dl, 'A'
		jb	loc_193BC
		cmp	dl, 'Z' - 'A' +1
		jnb	loc_193BC
		mov	bl, dl
		inc	bl
		push	dx
		mov	ax, 440Fh
		int	21h		; DOS -	2+ - IOCTL -
		pop	dx
		mov	ah, 0Eh
		int	21h		; DOS -	SELECT DISK
					; DL = new default drive number	(0 = A,	1 = B, etc.)
					; Return: AL = number of logical drives
		mov	[_word_1DE62], 0
		mov	[_word_1DE5E], 0
		jmp	loc_192FF
; ---------------------------------------------------------------------------

loc_1953C:				; CODE XREF: _start+38Fj _start+603j ...
		cmp	[_word_1DE62], 0Eh
		jnb	short loc_1955D
		mov	bx, [_word_1DE54]
		dec	bx
		mov	ax, [_word_1DE62]
		cmp	ax, bx
		jnb	loc_193BC
		mov	bl, 70h	; 'p'
		call	_recolortxt
		inc	[_word_1DE62]
		jmp	loc_193AE
; ---------------------------------------------------------------------------

loc_1955D:				; CODE XREF: _start+4AFj
		cmp	[_word_1DE54], 0Fh
		jb	loc_193BC
		mov	ax, [_word_1DE54]
		sub	ax, [_word_1DE5E]
		jb	loc_193BC
		cmp	ax, 10h
		jb	loc_193BC
		inc	[_word_1DE5E]
		jmp	loc_193AE
; ---------------------------------------------------------------------------

loc_1957F:				; CODE XREF: _start+389j
					; DATA XREF: dseg:_str_24461o ...
		cmp	[_word_1DE62], 0
		jz	short loc_19595
		mov	ax, [_word_1DE62]
		mov	bl, 70h	; 'p'
		call	_recolortxt
		dec	[_word_1DE62]
		jmp	loc_193AE
; ---------------------------------------------------------------------------

loc_19595:				; CODE XREF: _start+4F2j
		sub	[_word_1DE5E], 1
		jnb	loc_193AE
		mov	[_word_1DE5E], 0
		jmp	loc_193AE
; ---------------------------------------------------------------------------

loc_195A7:				; CODE XREF: _start+395j
		mov	ax, [_word_1DE62]
		mov	bl, 70h	; 'p'
		call	_recolortxt
		mov	[_word_1DE62], 0
		mov	[_word_1DE5E], 0
		jmp	loc_193AE
; ---------------------------------------------------------------------------

loc_195BE:				; CODE XREF: _start+39Bj
		mov	ax, [_word_1DE62]
		mov	bl, 70h	; 'p'
		call	_recolortxt
		mov	ax, [_word_1DE54]
		dec	ax
		cmp	ax, 0Fh
		jb	short loc_195DE
		sub	ax, 0Eh
		mov	[_word_1DE5E], ax
		mov	[_word_1DE62], 0Eh
		jmp	loc_193AE
; ---------------------------------------------------------------------------

loc_195DE:				; CODE XREF: _start+53Bj
		mov	[_word_1DE5E], 0
		mov	[_word_1DE62], ax
		jmp	loc_193AE
; ---------------------------------------------------------------------------

loc_195EA:				; CODE XREF: _start+3A1j
		mov	ax, [_word_1DE62]
		mov	bl, 70h	; 'p'
		call	_recolortxt
		xor	ax, ax
		xchg	ax, [_word_1DE62]
		or	ax, ax
		jnz	loc_193AE
		sub	[_word_1DE5E], 0Fh
		jnb	loc_193AE
		mov	[_word_1DE5E], 0
		jmp	loc_193AE
; ---------------------------------------------------------------------------

loc_19610:				; CODE XREF: _start:loc_19439j
		mov	ax, [_word_1DE62]
		mov	bl, 70h	; 'p'
		call	_recolortxt
		mov	ax, [_word_1DE54]
		dec	ax
		cmp	ax, 0Fh
		jb	short loc_19648
		mov	ax, 0Eh
		xchg	ax, [_word_1DE62]
		cmp	ax, 0Eh
		jnz	loc_193AE
		add	[_word_1DE5E], 0Fh
		mov	ax, [_word_1DE54]
		sub	ax, 0Fh
		cmp	[_word_1DE5E], ax
		jbe	loc_193AE
		mov	[_word_1DE5E], ax
		jmp	loc_193AE
; ---------------------------------------------------------------------------

loc_19648:				; CODE XREF: _start+58Dj
		mov	[_word_1DE62], ax
		jmp	loc_193AE
; ---------------------------------------------------------------------------

loc_1964E:				; CODE XREF: _start+383j
					; DATA XREF: dseg:7CAFo
		mov	si, offset _mystr ; str
		call	_doschdir
		jmp	loc_19250
; ---------------------------------------------------------------------------

loc_19657:				; CODE XREF: _start:loc_19445j
		mov	ax, [_word_1DE5E]
		add	ax, [_word_1DE62]
		mov	dx, ax
		shl	ax, 1
		add	ax, dx
		add	ax, [_word_1DE52]
		mov	fs, ax
		test	[cs:_keyb_switches], 4
		jnz	short loc_196B0
		cmp	[byte ptr fs:2], 2
		jnz	loc_193BC
		mov	[_word_1DE60], 0FFFFh
		test	[byte ptr fs:3], 40h
		jnz	short loc_19698
		or	[byte ptr fs:3], 40h
		inc	[_word_1DE5C]
		jmp	loc_1953C
; ---------------------------------------------------------------------------

loc_19698:				; CODE XREF: _start+5F7j
		and	[byte ptr fs:3], 0BFh
		sub	[_word_1DE5C], 1
		jnb	loc_1953C
		mov	[_word_1DE5C], 0
		jmp	loc_1953C
; ---------------------------------------------------------------------------

loc_196B0:				; CODE XREF: _start+5DFj
		cmp	[_word_1DE5C], 0
		jz	loc_193BC
		mov	cx, 602h
		mov	dx, 1A4Eh
		mov	bl, 7Fh	; ''
		mov	ax, 7800h
		call	_draw_frame
		mov	si, offset _aDeleteMarkedFil ; "Delete marked files? [Y/N]"
		mov	ax, 7E0Dh
		call	_message_1BE77

loc_196D0:				; CODE XREF: _start+647j _start+649j
		xor	ax, ax
		xchg	ax, [cs:_key_code]
		or	ax, ax
		jz	short loc_196D0
		js	short loc_196D0
		mov	[_byte_1DE7F], 0
		cmp	ax, 15h
		jnz	loc_192FF
		mov	fs, [_word_1DE52]
		mov	cx, [_word_1DE54]

loc_196F1:				; CODE XREF: _start+6BAj
		test	[byte ptr fs:3], 40h
		jz	short loc_19744
		cmp	[byte ptr fs:2], 2
		jnz	short loc_19744
		push	cx
		push	fs
		mov	cx, 602h
		mov	dx, 1A4Eh
		mov	bl, 7Fh	; ''
		mov	ax, 7800h
		call	_draw_frame
		pop	fs
		push	fs
		mov	eax, [fs:0Ch]
		mov	[dword ptr _aFile], eax ; "File"
		mov	eax, [fs:10h]
		mov	[dword ptr _aName], eax ; "name"
		mov	eax, [fs:14h]
		mov	[dword ptr _a_ext], eax ; ".Ext"
		mov	si, offset _aDeletingFile ; "Deleting file: "
		mov	ax, 7E0Dh
		call	_message_1BE77
		mov	dx, offset _aFile ; "File"
		mov	ah, 41h
		int	21h		; DOS -	2+ - DELETE A FILE (UNLINK)
					; DS:DX	-> ASCIZ pathname of file to delete (no	wildcards allowed)
		pop	fs
		pop	cx

loc_19744:				; CODE XREF: _start+665j _start+66Dj
		mov	ax, fs
		add	ax, 3
		mov	fs, ax
		assume fs:nothing
		dec	cx
		jnz	short loc_196F1
		mov	[_word_1DE62], 0
		mov	[_word_1DE5E], 0
		mov	[_byte_1DE7F], 1
		jmp	loc_192FF
; ---------------------------------------------------------------------------

loc_19762:				; CODE XREF: _start+3ADj
					; DATA XREF: dseg:7C8Fo
		cmp	[_byte_1DE7C], 1
		jz	loc_193BC
		mov	cx, 602h
		mov	dx, 1A4Eh
		mov	bl, 7Fh	; ''
		mov	ax, 7800h
		call	_draw_frame
		call	[off_1DE3C]
		call	_keyb_19EFD
		mov	[_byte_1DE7F], 0
		jmp	loc_192F7
; ---------------------------------------------------------------------------

loc_19788:				; CODE XREF: _start+3B9j
		mov	cx, 604h
		mov	dx, 84Bh
		mov	bl, 7Fh	; ''
		mov	ax, 7803h
		call	_draw_frame
		mov	cx, 906h
		mov	dx, 1949h
		mov	bl, 7Fh	; ''
		mov	ax, 7803h
		call	_draw_frame
		les	di, [_videomempointer]
		assume es:nothing
		add	di, 1042h
		mov	cx, 4Eh	; 'N'
		mov	ax, 7820h	; 'x'
		cld
		rep stosw
		mov	si, offset _word_1D3B0
		les	di, [_videomempointer]
		call	_write_scr

loc_197BF:				; CODE XREF: _start+733j
		cmp	[byte ptr cs:_key_code],	0
		jle	short loc_197BF
		mov	[cs:_key_code], 0
		mov	[_byte_1DE7F], 0
		jmp	loc_192F7
; ---------------------------------------------------------------------------

loc_197D6:				; CODE XREF: _start+3BFj
		call	_mouse_deinit
		call	_dosexec
		call	_mouse_init
		mov	[_byte_1DE7F], 0
		jmp	loc_192F7
; ---------------------------------------------------------------------------

loc_197E7:				; CODE XREF: _start+3C5j
		xor	[byte ptr _configword], 20h
		jmp	loc_193BC
endp		_start


; =============== S U B	R O U T	I N E =======================================




; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR _start

loc_19827:				; CODE XREF: _start+343j
		call	_mouse_hide
		and	[_byte_1DE90], 0FEh
		mov	bx, offset _str_24461 ; _mystr
		mov	ax, [_mousecolumn]
		mov	bp, [_mouserow]
		shr	ax, 3
		shr	bp, 3
		call	_mouse_1C7CF
		jb	loc_193BC
		jmp	bx
; ---------------------------------------------------------------------------

loc_19848:				; CODE XREF: _start+33Aj
		call	_mouse_hide
		mov	bx, offset stru_2448B ;	_mystr
		mov	ax, [_mousecolumn]
		mov	bp, [_mouserow]
		shr	ax, 3
		shr	bp, 3
		call	_mouse_1C7CF
		jb	loc_193BC
		push	es
		xor	dx, dx
		mov	es, dx
		assume es:nothing
		mov	edx, [es:46Ch]
		cmp	edx, [_dword_1DE88]
		jz	short loc_1987C
		mov	[_dword_1DE88], edx
		pop	es
		assume es:nothing
		jmp	bx
; ---------------------------------------------------------------------------

loc_1987C:				; CODE XREF: _start+7E0j
		pop	es
		jmp	loc_193BC
; END OF FUNCTION CHUNK	FOR _start
; ---------------------------------------------------------------------------

loc_19880:				; DATA XREF: dseg:7C85o
		cmp	bp, 0Eh
		ja	loc_193BC
		mov	ax, bp
		jmp	loc_19464

; =============== S U B	R O U T	I N E =======================================


; void __usercall _dosgetcurdir(char *str<esi>)
proc		_dosgetcurdir near	; CODE XREF: _start+251p _dosexec+53p
		push	si
		mov	ah, 19h
		int	21h		; DOS -	GET DEFAULT DISK NUMBER
		pop	si
		mov	[si], al
		mov	[byte ptr si+1], '\'
		add	si, 2
		xor	dl, dl
		mov	ah, 47h
		int	21h		; DOS -	2+ - GET CURRENT DIRECTORY
					; DL = drive (0=default, 1=A, etc.)
					; DS:SI	points to 64-byte buffer area
		retn
endp		_dosgetcurdir


; =============== S U B	R O U T	I N E =======================================


; void __usercall _doschdir(char	*str<esi>)
proc		_doschdir near		; CODE XREF: _start+5BFp _dosexec+A6p
		mov	dl, [si]
		inc	si
		push	si
		mov	ah, 0Eh
		int	21h		; DOS -	SELECT DISK
					; DL = new default drive number	(0 = A,	1 = B, etc.)
					; Return: AL = number of logical drives
		pop	dx
		mov	ah, 3Bh
		int	21h		; DOS -	2+ - CHANGE THE	CURRENT	DIRECTORY (CHDIR)
					; DS:DX	-> ASCIZ directory name	(may include drive)
		retn
endp		_doschdir

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR _filelist_198B8

_recolortxtx:				; CODE XREF: _filelist_198B8+8j
		mov	ax, [_word_1DE62]
		mov	bl, 70h	; 'p'
		jmp	_recolortxt
; END OF FUNCTION CHUNK	FOR _filelist_198B8

; =============== S U B	R O U T	I N E =======================================


proc		_filelist_198B8 near	; CODE XREF: _start:loc_193AEp

; FUNCTION CHUNK AT 0860 SIZE 00000008 BYTES

		cld
		mov	ax, [_word_1DE5E]
		cmp	ax, [_word_1DE60]
		jz	short _recolortxtx
		mov	[_word_1DE60], ax
		mov	cx, [_word_1DE54]
		sub	cx, [_word_1DE5E]
		cmp	cx, 0Fh
		jb	short loc_198D5
		mov	cx, 0Fh

loc_198D5:				; CODE XREF: _filelist_198B8+18j
		mov	ax, [_word_1DE5E]
		mov	dx, ax
		shl	ax, 1
		add	ax, dx
		add	ax, [_word_1DE52]
		mov	fs, ax
		assume fs:nothing
		mov	ax, (80*10+10)*2

loc_198E7:				; CODE XREF: _filelist_198B8+13Cj
		push	ax
		push	cx
		les	di, [_videomempointer]
		add	di, ax
		mov	bp, di
		mov	ah, 7Eh	; '~'
		cmp	[byte ptr fs:2], 2
		jz	short loc_198FD
		mov	ah, 7Bh	; '{'

loc_198FD:				; CODE XREF: _filelist_198B8+41j
		mov	si, 0Ch
		mov	cx, 0Ch

loc_19903:				; CODE XREF: _filelist_198B8+5Aj
		mov	al, [fs:si]
		or	al, al
		jz	short loc_19914	; " " fill the space after file	names
		mov	[es:di], ax
		inc	si
		add	di, 2
		dec	cx
		jnz	short loc_19903

loc_19914:				; CODE XREF: _filelist_198B8+50j
		mov	ax, 7E20h	; " " fill the space after file	names
		cld
		rep stosw
		cmp	[byte ptr fs:2], 2
		jz	short loc_1992A
		mov	cx, 51

loc_19925:
		rep stosw
		jmp	loc_199E7
; ---------------------------------------------------------------------------

loc_1992A:				; CODE XREF: _filelist_198B8+68j
		push	bp
		mov	ax, ds
		mov	es, ax
		assume es:dseg
		mov	di, offset _buffer_1 ; 2800h
		mov	bp, 8		; count
		mov	eax, [fs:8]
		call	_my_u32toa_fill

loc_1993D:
		mov	ax, [fs:6]
		and	al, 1Fh
		movzx	eax, al
		mov	bp, 3		; count
		call	_my_u32toa_fill
		mov	[byte ptr di], '-'

loc_19950:
		inc	di
		mov	ax, [fs:6]
		shr	ax, 5

loc_19958:
		and	eax, 0Fh
		lea	si, [_aJanfebmaraprmayj+eax+eax*2] ; "	JanFebMarAprMayJunJulAugSepOctNovDec"
		cld
		movsw
		movsb
		mov	[byte ptr di], '-'
		inc	di
		movzx	eax, [word ptr fs:6]
		shr	ax, 9
		add	ax, 1980
		mov	bp, 4		; count
		call	_my_u32toa_fill
		mov	[byte ptr di], ' '
		inc	di
		mov	ax, [fs:4]
		shr	ax, 0Bh
		mov	dl, 10
		div	dl
		or	ax, '00'
		mov	[di], ax
		mov	[byte ptr di+2], ':'
		mov	ax, [fs:4]
		shr	ax, 5
		and	ax, 3Fh	; '?'
		div	dl
		or	ax, '00'
		mov	[di+3],	ax
		mov	[word ptr di+5], ' '
		pop	bp
		mov	si, offset _buffer_1 ; str
		mov	es, [word ptr _videomempointer+2]
		assume es:nothing
		lea	di, [bp+18h]
		mov	ah, 7Fh	; ''
		call	_text_1BF69
		test	[byte ptr fs:3], 40h
		jz	short loc_199CF
		mov	si, offset _aMarkedToDelete ; "<Marked to Delete>    "
		mov	ah, 7Fh	; ''
		call	_text_1BF69
		jmp	short loc_199E7
; ---------------------------------------------------------------------------

loc_199CF:				; CODE XREF: _filelist_198B8+10Bj
		mov	ah, 7Eh	; '~'
		mov	si, 1Ah

loc_199D4:				; CODE XREF: _filelist_198B8+12Dj
		mov	al, [fs:si]
		or	al, al
		jz	short loc_199E7
		mov	[es:di], ax
		inc	si
		add	di, 2
		cmp	si, 30h	; '0'
		jb	short loc_199D4

loc_199E7:				; CODE XREF: _filelist_198B8+6Fj
					; _filelist_198B8+115j ...
		mov	ax, fs
		add	ax, 3
		mov	fs, ax
		assume fs:nothing
		pop	cx
		pop	ax
		add	ax, 0A0h ; ' '
		dec	cx
		jnz	loc_198E7
		retn
endp		_filelist_198B8


; =============== S U B	R O U T	I N E =======================================


proc		_recolortxt near		; CODE XREF: _start+324p _start+4C1p ...
		imul	di, ax,	80*2
		add	di, (80*2*10)+(8*2)+1
		mov	cx, 64

loc_19A04:				; CODE XREF: _recolortxt+19j
		mov	al, [es:di]
		and	al, 0Fh
		or	al, bl
		mov	[es:di], al
		add	di, 2
		dec	cx
		jnz	short loc_19A04
		retn
endp		_recolortxt


; =============== S U B	R O U T	I N E =======================================


proc		_cpy_printable near	; CODE XREF: _modules_search+230p
		push	si
		push	di

loc_19A17:				; CODE XREF: _cpy_printable+Ej
		mov	al, [si]
		inc	si
		cmp	al, ' '
		jb	short loc_19A25
		mov	[es:di], al
		inc	di
		dec	cx
		jnz	short loc_19A17

loc_19A25:				; CODE XREF: _cpy_printable+7j
		cld
		mov	al, ' '
		rep stosb
		pop	di
		pop	si
		retn
endp		_cpy_printable

; ---------------------------------------------------------------------------
		dec	cx
		jz	short locret_19A3E
		mov	al, [es:si]
		inc	si

loc_19A34:				; CODE XREF: seg001:09ECj
		xor	[es:si], al
		mov	al, [es:si]
		inc	si
		dec	cx
		jnz	short loc_19A34

locret_19A3E:				; CODE XREF: seg001:09DEj
		retn
; ---------------------------------------------------------------------------
		dec	cx
		jz	short locret_19A52
		mov	al, [es:si]
		inc	si

loc_19A46:				; CODE XREF: seg001:0A00j
		mov	ah, [es:si]
		xor	[es:si], al
		mov	al, ah
		inc	si
		dec	cx
		jnz	short loc_19A46

locret_19A52:				; CODE XREF: seg001:09F0j
		retn

; =============== S U B	R O U T	I N E =======================================


proc		_modules_search near	; CODE XREF: _start+300p
		mov	[_word_1DE64], 2192
		mov	[_word_1DE66], 0
		cmp	[_word_1DE52], 0
		jz	short loc_19A6E
		mov	es, [_word_1DE52]
		assume es:nothing
		mov	ah, 49h
		int	21h		; DOS -	2+ - FREE MEMORY
					; ES = segment address of area to be freed

loc_19A6E:				; CODE XREF: _modules_search+11j
		mov	bx, 1000h
		mov	ah, 48h
		int	21h		; DOS -	2+ - ALLOCATE MEMORY
					; BX = number of 16-byte paragraphs desired
		jb	loc_19250
		mov	[_word_1DE52], ax
		mov	es, ax
		assume es:nothing
		xor	di, di
		mov	cx, 4000h
		xor	eax, eax
		cld
		rep stosd
		mov	[dword ptr _buffer_1DB6C], 2A2E2Ah ; '*.*'
		mov	[_word_1DE5C], 0
		mov	[_word_1DE54], 0
		mov	[_word_1DE56], 0
		mov	[_word_1DE58], 0
		mov	[_word_1DE5A], 0
		cld
		mov	[_word_1DE4E], 12h
		call	_find_mods
		mov	es, [_word_1DE52]
		jb	loc_19CA2

loc_19AC3:				; CODE XREF: _modules_search+CFj
		lfs	di, [_videomempointer]
		assume fs:nothing
		add	di, [_word_1DE64]
		mov	bx, [_word_1DE66]
		mov	ah, 7Fh	; ''
		mov	al, [byte ptr _slider+bx] ; "Ä\\|/Ä\\|/"
		mov	[fs:di], ax
		inc	[_word_1DE66]
		and	[_word_1DE66], 7
		test	[byte ptr unk_1DC01], 10h
		jz	short loc_19B1D
		cmp	[word ptr _buffer_1DB6C], '.'
		jz	short loc_19B1D
		mov	[byte ptr es:2], 0
		mov	si, offset _buffer_1DB6C
		mov	di, 0Ch
		cld
		movsd
		movsd
		movsd
		movsb
		inc	[_word_1DE56]
		mov	ax, es
		add	ax, 3
		mov	es, ax
		assume es:nothing
		inc	[_word_1DE54]
		cmp	[_word_1DE54], 52Bh
		jnb	loc_19CA2

loc_19B1D:				; CODE XREF: _modules_search+94j
					; _modules_search+9Bj
		push	es
		call	_dosfindnext
		pop	es
		assume es:nothing
		jnb	short loc_19AC3

loc_19B24:				; '*.*'
		mov	[dword ptr _buffer_1DB6C], 2A2E2Ah
		mov	[_word_1DE4E], 2
		push	es
		call	_find_mods
		pop	es
		assume es:nothing
		jb	loc_19CA2

loc_19B3C:				; CODE XREF: _modules_search+24Bj
		lfs	di, [_videomempointer]
		add	di, [_word_1DE64]
		mov	bx, [_word_1DE66]
		mov	ah, 7Fh	; ''
		mov	al, [byte ptr _slider+bx] ; "Ä\\|/Ä\\|/"
		mov	[fs:di], ax
		inc	[_word_1DE66]
		and	[_word_1DE66], 7
		test	[byte ptr unk_1DC01], 10h
		jnz	loc_19C99
		mov	si, offset _buffer_1DB6C
		mov	cx, 8

loc_19B6A:				; CODE XREF: _modules_search+125j
		inc	si
		cmp	[byte ptr si], 0
		jz	loc_19C99
		cmp	[byte ptr si], '.'
		jz	short loc_19B7D
		dec	cx
		jnz	short loc_19B6A
		jmp	loc_19C99
; ---------------------------------------------------------------------------

loc_19B7D:				; CODE XREF: _modules_search+122j
		mov	edx, [si]
		mov	si, offset _a_mod_nst_669_s ; ".MOD.NST.669.STM.S3M.MTM.PSM.WOW.INR.FA"...

loc_19B83:				; CODE XREF: _modules_search+13Fj
		mov	eax, [si]
		or	al, al
		jz	loc_19C99
		add	si, 4
		cmp	eax, edx
		jnz	short loc_19B83
		mov	si, offset _buffer_1DB6C
		mov	dx, si
		mov	[byte ptr es:2], 2
		mov	[word ptr es:0], 0
		mov	di, 0Ch
		cld
		movsd
		movsd
		movsd
		movsb
		mov	si, offset unk_1DC01

loc_19BB4:
		mov	di, 3
		movsb
		and	[byte ptr es:3], 3Fh ; '?'
		movsd
		movsd
		mov	ebp, eax
		inc	[_word_1DE58]
		cmp	[cs:_key_code], 1
		jnz	short loc_19BDD
		mov	[cs:_key_code], 0
		or	[byte ptr _configword], 20h

loc_19BDD:				; CODE XREF: _modules_search+17Cj
		mov	si, offset asc_1DA00 ; "		      "
		mov	cx, 16h
		test	[byte ptr _configword], 20h
		jnz	loc_19C80
		mov	ax, 3D00h
		int	21h		; DOS -	2+ - OPEN DISK FILE WITH HANDLE
					; DS:DX	-> ASCIZ filename
					; AL = access mode
					; 0 - read
		jb	loc_19C86
		mov	bx, ax
		mov	dx, offset _buffer_1DC6C
		mov	bx, ax
		mov	cx, 80h	; '€'
		mov	ah, 3Fh	; '?'
		push	bx
		int	21h		; DOS -	2+ - READ FROM FILE WITH HANDLE
					; BX = file handle, CX = number	of bytes to read
					; DS:DX	-> buffer
		pop	bx
		pushf
		mov	ah, 3Eh
		int	21h		; DOS -	2+ - CLOSE A FILE WITH HANDLE
					; BX = file handle
		popf
		jb	short loc_19C86
		mov	si, offset _byte_1DC7C
		mov	cx, 16h
		cmp	ebp, 524E492Eh	; .INR
		jz	short loc_19C80
		mov	si, offset unk_1DC7B
		mov	cx, 16h
		cmp	ebp, 544C552Eh	; .ULT
		jz	short loc_19C80
		mov	si, offset unk_1DC70
		mov	cx, 16h
		cmp	ebp, 4D544D2Eh	; .MTM
		jz	short loc_19C80
		cmp	ebp, 4D53502Eh	; .PSM
		jz	short loc_19C80
		cmp	ebp, 5241462Eh	; .FAR
		jz	short loc_19C80
		cmp	ebp, 3936362Eh	; .669
		jz	short loc_19C71
		mov	si, offset _byte_1DC7C
		mov	cx, 16h
		cmp	ebp, 5353542Eh	; .TSS
		jz	short loc_19C80
		mov	si, offset _buffer_1DC6C
		mov	cx, 16h
		mov	[word ptr si+14h], '  '
		jmp	short loc_19C80
; ---------------------------------------------------------------------------

loc_19C71:				; CODE XREF: _modules_search+200j
		mov	si, (offset _buffer_1DC6C+1)
		mov	cx, 54h	; 'T'

loc_19C77:				; CODE XREF: _modules_search+228j
		inc	si
		cmp	[byte ptr si], ' '
		loope	loc_19C77
		mov	cx, 16h

loc_19C80:				; CODE XREF: _modules_search+195j
					; _modules_search+1C7j ...
		mov	di, 1Ah
		call	_cpy_printable

loc_19C86:				; CODE XREF: _modules_search+19Ej
					; _modules_search+1B8j
		mov	ax, es
		add	ax, 3
		mov	es, ax
		assume es:nothing
		inc	[_word_1DE54]
		cmp	[_word_1DE54], 52Bh
		jnb	short loc_19CA2

loc_19C99:				; CODE XREF: _modules_search+10Dj
					; _modules_search+11Bj ...
		push	es
		call	_dosfindnext
		pop	es
		jnb	loc_19B3C

loc_19CA2:				; CODE XREF: _modules_search+6Cj
					; _modules_search+C6j ...
		mov	ah, 19h
		int	21h		; DOS -	GET DEFAULT DISK NUMBER
		push	ax
		xor	dl, dl

loc_19CA9:				; CODE XREF: _modules_search+291j
		push	dx
		mov	ah, 0Eh
		int	21h		; DOS -	SELECT DISK
					; DL = new default drive number	(0 = A,	1 = B, etc.)
					; Return: AL = number of logical drives
		mov	ah, 19h
		int	21h		; DOS -	GET DEFAULT DISK NUMBER
		pop	dx
		cmp	al, dl
		jnz	short loc_19CDF
		mov	eax, 5D3A415Bh	; [A:]
		add	ah, dl
		mov	[es:0Ch], eax
		mov	[byte ptr es:10h], 0
		mov	[byte ptr es:2], 1
		inc	[_word_1DE5A]
		mov	ax, es
		add	ax, 3
		mov	es, ax
		assume es:nothing
		inc	[_word_1DE54]

loc_19CDF:				; CODE XREF: _modules_search+262j
		inc	dl

loc_19CE1:
		cmp	dl, 1Ah
		jb	short loc_19CA9
		pop	dx
		mov	ah, 0Eh
		int	21h		; DOS -	SELECT DISK
					; DL = new default drive number	(0 = A,	1 = B, etc.)
					; Return: AL = number of logical drives
		mov	es, [_word_1DE52]
		assume es:nothing
		mov	ax, [_word_1DE54]
		mov	bx, ax
		shl	ax, 1
		add	bx, ax
		mov	ah, 4Ah
		int	21h		; DOS -	2+ - ADJUST MEMORY BLOCK SIZE (SETBLOCK)
					; ES = segment address of block	to change
					; BX = new size	in paragraphs
		clc
		retn
endp		_modules_search


; =============== S U B	R O U T	I N E =======================================


proc		_parse_cmdline near	; CODE XREF: _start+44p
		mov	ax, ds
		mov	es, ax
		assume es:dseg
		xor	ebp, ebp
		mov	ds, [_esseg_atstart]
		assume ds:nothing
		mov	si, 80h	; '€'   ; psp:80h commandline
		mov	di, offset _buffer_1DB6C
		xor	dl, dl
		cld
		lodsb
		movzx	cx, al		; number of bytes on commandline
		stc
		jcxz	short loc_19D64

loc_19D19:				; CODE XREF: _parse_cmdline+29j
					; _parse_cmdline+47j ...
		lodsb
		cmp	al, 0Dh
		jz	short loc_19D63
		or	al, al
		jz	short loc_19D63
		cmp	al, ' '
		jnz	short loc_19D4E
		dec	cx
		jnz	short loc_19D19
		stc
		jmp	short loc_19D64
; ---------------------------------------------------------------------------

loc_19D2C:				; CODE XREF: _parse_cmdline+52j
		lodsb
		cmp	al, 0Dh
		jz	short loc_19D63
		or	al, al
		jz	short loc_19D63
		cmp	al, '?'
		jz	short loc_19D47
		and	al, 0DFh
		sub	al, 'A'
		movzx	eax, al
		bts	ebp, eax
		jmp	short loc_19D19
; ---------------------------------------------------------------------------

loc_19D47:				; CODE XREF: _parse_cmdline+39j
		bts	ebp, 1Fh
		jmp	short loc_19D19
; ---------------------------------------------------------------------------

loc_19D4E:				; CODE XREF: _parse_cmdline+26j
					; _parse_cmdline+62j
		cmp	al, '/'
		jz	short loc_19D2C
		stosb
		lodsb
		cmp	al, 0Dh
		jz	short loc_19D63
		or	al, al
		jz	short loc_19D63
		cmp	al, ' '
		jz	short loc_19D63
		loop	loc_19D4E
		stosb

loc_19D63:				; CODE XREF: _parse_cmdline+1Ej
					; _parse_cmdline+22j ...
		clc

loc_19D64:				; CODE XREF: _parse_cmdline+19j
					; _parse_cmdline+2Cj
		mov	[byte ptr es:di], 0
		mov	ax, es
		mov	ds, ax
		assume ds:dseg
		retn
endp		_parse_cmdline


; =============== S U B	R O U T	I N E =======================================


proc		_readallmoules near	; CODE XREF: _start+1ABp
					; _readallmoules+12j ...
		mov	dx, offset _buffer_1DB6C
		call	_read_module
		jb	short loc_19D83

loc_19D75:
		cmp	[_word_1DE50], 1
		jz	short loc_19D81
		call	_dosfindnext
		jnb	short _readallmoules

loc_19D81:				; CODE XREF: _readallmoules+Dj
		clc
		retn
; ---------------------------------------------------------------------------

loc_19D83:				; CODE XREF: _readallmoules+6j
		mov	[_byte_1DE7E], 3
		mov	[word ptr _messagepointer], offset _aModuleLoadErro ; "Module load error.\r\n$"
		mov	[word ptr _messagepointer+2], ds
		stc
		retn
endp		_readallmoules

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR _start

loc_19D94:				; CODE XREF: _start+18Ej
		mov	[_byte_1DE7E], 4
		mov	[word ptr _messagepointer], offset _aListFileNotFou ; "List file not found.\r\n$"
		mov	[word ptr _messagepointer+2], ds
		mov	dx, (offset _buffer_1DB6C+1)
		mov	ax, 3D00h
		int	21h		; DOS -	2+ - OPEN DISK FILE WITH HANDLE
					; DS:DX	-> ASCIZ filename
					; AL = access mode
					; 0 - read
		jb	loc_19256
		push	ax
		call	_callsubx
		pop	bx
		jb	loc_19256

loc_19DB8:				; CODE XREF: _start+D4Fj _start+D56j ...
		mov	dx, offset _buffer_1DB6C

loc_19DBB:				; CODE XREF: _start+D45j
		mov	cx, 1
		mov	ah, 3Fh	; '?'
		push	bx
		push	dx
		int	21h		; DOS -	2+ - READ FROM FILE WITH HANDLE
					; BX = file handle, CX = number	of bytes to read
					; DS:DX	-> buffer
		pop	dx
		pop	bx
		mov	di, dx
		jb	short loc_19E03
		or	ax, ax
		jz	short loc_19E03
		inc	dx
		cmp	[byte ptr di], 1Ah
		jz	short loc_19E03
		cmp	[byte ptr di], ' '
		jnb	short loc_19DBB
		mov	[byte ptr di], 0
		cmp	[_buffer_1DB6C],	0
		jz	short loc_19DB8
		cmp	[_buffer_1DB6C],	';'
		jz	short loc_19DB8
		push	bx
		mov	[_word_1DE4E], 2
		call	_find_mods
		jb	short loc_19DF9
		call	_readallmoules

loc_19DF9:				; CODE XREF: _start+D62j
		pop	bx
		cmp	[_word_1DE50], 1
		jnz	short loc_19DB8
		jmp	short loc_19E09
; ---------------------------------------------------------------------------

loc_19E03:				; CODE XREF: _start+D36j _start+D3Aj ...
		mov	[byte ptr di], 0
		call	_readallmoules

loc_19E09:				; CODE XREF: _start+D6Fj
		mov	[_byte_1DE7E], 0
		jmp	loc_19250
; END OF FUNCTION CHUNK	FOR _start

; =============== S U B	R O U T	I N E =======================================


proc		_read_module near	; CODE XREF: _start+424p
					; _readallmoules+3p
		mov	[_byte_1DE7E], 3
		mov	[word ptr _messagepointer], offset _aModuleLoadErro ; "Module load error.\r\n$"
		mov	[word ptr _messagepointer+2], ds
		mov	si, dx

loc_19E22:				; CODE XREF: _read_module+16j
		inc	si
		cmp	[byte ptr si-1], 0
		jnz	short loc_19E22
		mov	cx, 0Ch

loc_19E2C:				; CODE XREF: _read_module+2Dj
		dec	si
		cmp	[byte ptr si-1], ':'
		jz	short loc_19E41
		cmp	[byte ptr si-1], '\'
		jz	short loc_19E41
		cmp	si, dx
		jbe	short loc_19E41
		dec	cx
		jnz	short loc_19E2C
		dec	si

loc_19E41:				; CODE XREF: _read_module+20j
					; _read_module+26j ...
		mov	di, offset _aFilename_ext ; "FileName.Ext"
		mov	cx, 0Ch

loc_19E47:				; CODE XREF: _read_module+4Bj
		mov	al, [si]
		inc	si
		or	al, al
		jz	short loc_19E5E
		cmp	al, 'a'
		jb	short loc_19E58
		cmp	al, 'z'
		ja	short loc_19E58
		and	al, 0DFh	; upper	case

loc_19E58:				; CODE XREF: _read_module+3Fj
					; _read_module+43j
		mov	[di], al
		inc	di
		dec	cx
		jnz	short loc_19E47

loc_19E5E:				; CODE XREF: _read_module+3Bj
		mov	ax, ds
		mov	es, ax
		mov	al, ' '
		cld
		rep stosb
		call	_moduleread
		jb	loc_1A042
		mov	[_current_patterns], 0
		mov	[_byte_1DE84], 0
		call	sub_126A9
		mov	[dword ptr _module_type_txt], eax ; "	"
		xor	ch, ch
		mov	[_amount_of_x], cx
		mov	[_byte_1DE73], bl
		call	_read_sndsettings
		mov	[_outp_freq], bp
		call	sub_1265D
		mov	[_byte_1DE78], dl
		mov	al, dh
		and	al, 10h
		shr	al, 4
		mov	[_byte_1DE7B], al
		mov	[word ptr _segfsbx_1DE28], si
		mov	[word ptr _segfsbx_1DE28+2], es
		mov	si, di
		mov	di, offset asc_1CC2D ; "			      "
		mov	cx, 30

loc_19EBA:				; CODE XREF: _read_module+B4j
		mov	al, [es:si]
		or	al, al
		jz	short loc_19EC7
		mov	[di], al
		inc	si
		inc	di
		loop	loc_19EBA

loc_19EC7:				; CODE XREF: _read_module+AEj
		mov	cx, 17
		xor	si, si

loc_19ECC:				; CODE XREF: _read_module+C3j
		mov	al, [es:si]
		mov	[byte ptr _a130295211558+si], al	; "13/02/95 21:15:58"
		inc	si
		loop	loc_19ECC
		call	_video_prp_mtr_positn
		xor	edx, edx
		mov	eax, 317
		movzx	ebx, [_amount_of_x]
		div	ebx
		mov	[_volume_1DE34],	eax
		mov	[_byte_1DE7C], 0
		call	sub_12EBA
		call	[off_1DE3C]
endp		_read_module ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


proc		_keyb_19EFD near		; CODE XREF: _start+6EBp _keyb_19EFD+5Aj ...
		call	sub_1265D
		mov	[_byte_1DE72], ah
		mov	[_byte_1DE74], al
		mov	[_byte_1DE75], bh
		mov	[_byte_1DE76], ch
		mov	ax, -1
		call	_change_volume
		mov	[_word_1DE6A], ax
		mov	ax, -1
		call	_change_amplif
		mov	[_word_1DE6C], ax
		call	_get_playsettings
		mov	[_flg_play_settings], al
		call	[_offs_draw]
		cmp	[_byte_1DE7C], 1
		jz	loc_1A393
		test	[_byte_1DE90], 2
		jnz	loc_1A3C5
		test	[_byte_1DE90], 1
		jnz	loc_1A3A7
		xor	ax, ax
		xchg	ax, [cs:_key_code]
		or	ax, ax
		jz	short _keyb_19EFD
		mov	[_word_1DE50], ax
		mov	cx, 2
		cmp	ax, 0E04Dh	; gr_right
		jz	_l_1A044
		mov	cx, 10
		cmp	ax, 0E048h	; gr_up

loc_19F6C:
		jz	_l_1A044
		mov	cx, 2
		cmp	ax, 0E04Bh	; gr_left
		jz	loc_1A070
		mov	ecx, 10
		cmp	ax, 0E050h
		jz	loc_1A070	; gr_down
		cmp	al, 4Dh	; 'M'
		jz	_l_right
		cmp	al, 48h	; 'H'
		jz	_l_up
		cmp	al, 4Bh	; 'K'
		jz	_l_left
		cmp	al, 50h	; 'P'
		jz	_l_down
		cmp	al, 4Eh	; 'N'
		jz	_l_plus
		cmp	al, 4Ah	; 'J'
		jz	_l_minus
		cmp	al, 1Ah
		jz	_l_lbracket
		cmp	al, 1Bh
		jz	_l_rbracket
		cmp	al, 3Bh	; ';'
		jz	_l_f1
		cmp	al, 3Ch	; '<'
		jz	_l_f2
		cmp	al, 3Dh	; '='
		jz	_l_f3
		cmp	al, 3Eh	; '>'
		jz	_l_f4
		cmp	al, 3Fh	; '?'
		jz	_l_f5
		cmp	al, 40h	; '@'
		jz	_l_f6
		cmp	al, 42h	; 'B'
		jz	_l_f8
		cmp	al, 43h	; 'C'
		jz	_l_f9
		cmp	al, 44h	; 'D'
		jz	_l_f10
		cmp	al, 57h	; 'W'
		jz	_l_f11
		cmp	al, 58h	; 'X'
		jz	_l_f12
		cmp	al, 26h	; '&'
		jz	_l_l
		cmp	al, 32h	; '2'
		jz	_l_m
		cmp	al, 13h
		jz	_l_r
		cmp	al, 1Fh
		jz	_l_s
		cmp	al, 0Fh
		jz	_l_tab
		cmp	al, 45h	; 'E'
		jz	_l_numlock
		cmp	al, 46h	; 'F'
		jz	_l_scrollock
		cmp	al, 4Fh	; 'O'
		jz	_l_1_end
		cmp	al, 1Ch
		jz	_l_enter
		cmp	al, 1
		jz	_l_esc
		jb	_keyb_19EFD
		cmp	al, 0Bh
		jbe	loc_1A33E
		jmp	_keyb_19EFD
; ---------------------------------------------------------------------------

loc_1A042:				; CODE XREF: _read_module+5Bj
		stc
		retn
; ---------------------------------------------------------------------------

_l_1A044:				; CODE XREF: _keyb_19EFD+65j
					; _keyb_19EFD:loc_19F6Cj ...
		push	cx
		call	_get_12F7C
		and	bx, 3Fh
		movzx	eax, ax
		shl	eax, 6
		or	al, bl
		inc	eax
		mov	bl, al
		and	bl, 3Fh
		shr	eax, 6
		mov	bh, 1
		call	sub_12F56
		pop	cx
		dec	cx
		jnz	short _l_1A044
		jmp	_keyb_19EFD
; ---------------------------------------------------------------------------

loc_1A070:				; CODE XREF: _keyb_19EFD+79j
					; _keyb_19EFD+86j ...
		push	cx
		call	_get_12F7C
		and	bx, 3Fh
		movzx	eax, ax
		shl	eax, 6
		or	al, bl
		sub	eax, 1
		jb	short loc_1A0A0
		mov	bl, al
		and	bl, 3Fh
		shr	eax, 6
		mov	bh, 1
		call	sub_12F56
		pop	cx
		dec	cx
		jnz	short loc_1A070
		jmp	_keyb_19EFD
; ---------------------------------------------------------------------------

loc_1A0A0:				; CODE XREF: _keyb_19EFD+18Aj
		pop	cx
		jmp	_keyb_19EFD
; ---------------------------------------------------------------------------

_l_up:					; CODE XREF: _keyb_19EFD+92j
		sub	[_byte_1DE84], 1
		jnb	_keyb_19EFD
		mov	[_byte_1DE84], 0
		jmp	_keyb_19EFD
; ---------------------------------------------------------------------------

_l_down:					; CODE XREF: _keyb_19EFD+9Ej
		inc	[_byte_1DE84]
		mov	ax, [_amount_of_x]
		cmp	[_byte_1DE84], al
		jb	_keyb_19EFD
		dec	al
		mov	[_byte_1DE84], al
		jmp	_keyb_19EFD
; ---------------------------------------------------------------------------

_l_right:				; CODE XREF: _keyb_19EFD+8Cj
		lfs	bx, [_segfsbx_1DE28]
		mov	al, 50h	; 'P'
		mul	[_byte_1DE84]
		add	bx, ax
		mov	cl, 8
		test	[cs:_keyb_switches], 3
		jnz	short loc_1A0E6
		mov	cl, 1

loc_1A0E6:				; CODE XREF: _keyb_19EFD+1E5j
		mov	al, [fs:bx+3Ah]
		add	al, cl
		cmp	al, 80h	; '€'
		jbe	short loc_1A0F2
		mov	al, 80h	; '€'

loc_1A0F2:				; CODE XREF: _keyb_19EFD+1F1j
					; _keyb_19EFD+221j ...
		mov	ch, [_byte_1DE84]
		call	sub_12AFD
		jmp	_keyb_19EFD
; ---------------------------------------------------------------------------

_l_left:					; CODE XREF: _keyb_19EFD+98j
		lfs	bx, [_segfsbx_1DE28]
		mov	al, 50h	; 'P'
		mul	[_byte_1DE84]
		add	bx, ax
		mov	cl, 8
		test	[cs:_keyb_switches], 3
		jnz	short loc_1A118
		mov	cl, 1

loc_1A118:				; CODE XREF: _keyb_19EFD+217j
		mov	al, [fs:bx+3Ah]
		sub	al, cl
		jnb	short loc_1A0F2
		mov	al, 0
		jmp	short loc_1A0F2
; ---------------------------------------------------------------------------

_l_l:					; CODE XREF: _keyb_19EFD+FEj
		mov	al, 0
		jmp	short loc_1A0F2
; ---------------------------------------------------------------------------

_l_m:					; CODE XREF: _keyb_19EFD+104j
		mov	al, 64
		jmp	short loc_1A0F2
; ---------------------------------------------------------------------------

_l_r:					; CODE XREF: _keyb_19EFD+10Aj
		mov	al, 128
		jmp	short loc_1A0F2
; ---------------------------------------------------------------------------

_l_s:					; CODE XREF: _keyb_19EFD+110j
		mov	al, 166
		jmp	short loc_1A0F2
; ---------------------------------------------------------------------------

_l_plus:					; CODE XREF: _keyb_19EFD+A4j
		mov	ax, -1
		call	_change_volume
		mov	cx, 32
		test	[cs:_keyb_switches], 3
		jnz	short loc_1A14B
		mov	cx, 2

loc_1A14B:				; CODE XREF: _keyb_19EFD+249j
		add	ax, cx
		cmp	ax, 256
		jb	short loc_1A155
		mov	ax, 256

loc_1A155:				; CODE XREF: _keyb_19EFD+253j
		call	_change_volume
		jmp	_keyb_19EFD
; ---------------------------------------------------------------------------

_l_minus:				; CODE XREF: _keyb_19EFD+AAj
		mov	ax, -1
		call	_change_volume
		mov	cx, 32
		test	[cs:_keyb_switches], 3
		jnz	short loc_1A174
		mov	cx, 2

loc_1A174:				; CODE XREF: _keyb_19EFD+272j
		sub	ax, cx
		jnb	short loc_1A17A
		xor	ax, ax

loc_1A17A:				; CODE XREF: _keyb_19EFD+279j
		call	_change_volume
		jmp	_keyb_19EFD
; ---------------------------------------------------------------------------

_l_rbracket:				; CODE XREF: _keyb_19EFD+B6j
		mov	ax, 0FFFFh
		call	_change_amplif
		mov	cx, 1
		test	[cs:_keyb_switches], 3
		jnz	short loc_1A199
		mov	cx, 0Ah

loc_1A199:				; CODE XREF: _keyb_19EFD+297j
		add	ax, cx
		cmp	ax, 2500
		jb	short loc_1A1A3
		mov	ax, 2500

loc_1A1A3:				; CODE XREF: _keyb_19EFD+2A1j
		call	_change_amplif
		jmp	_keyb_19EFD
; ---------------------------------------------------------------------------

_l_lbracket:				; CODE XREF: _keyb_19EFD+B0j
		mov	ax, -1
		call	_change_amplif
		mov	cx, 1
		test	[cs:_keyb_switches], 3
		jnz	short loc_1A1C2
		mov	cx, 10

loc_1A1C2:				; CODE XREF: _keyb_19EFD+2C0j
		sub	ax, cx
		jnb	short loc_1A1C9
		mov	ax, 50

loc_1A1C9:				; CODE XREF: _keyb_19EFD+2C7j
		cmp	ax, 50
		ja	short loc_1A1D1
		mov	ax, 50

loc_1A1D1:				; CODE XREF: _keyb_19EFD+2CFj
		call	_change_amplif
		jmp	_keyb_19EFD
; ---------------------------------------------------------------------------

_l_f1:					; CODE XREF: _keyb_19EFD+BCj
		call	_f1_help
		jmp	_keyb_19EFD
; ---------------------------------------------------------------------------

_l_f2:					; CODE XREF: _keyb_19EFD+C2j
		call	_f2_waves
		jmp	_keyb_19EFD
; ---------------------------------------------------------------------------

_l_f3:					; CODE XREF: _keyb_19EFD+C8j
		call	_f3_textmetter
		mov	[_byte_1DE85], 0
		test	[cs:_keyb_switches], 3
		jz	_keyb_19EFD
		mov	[_byte_1DE85], 1
		jmp	_keyb_19EFD
; ---------------------------------------------------------------------------

_l_f4:					; CODE XREF: _keyb_19EFD+CEj
		cmp	[_offs_draw], offset _f4_draw
		jnz	short loc_1A219
		mov	ax, [_word_1DE6E]
		dec	ax
		add	[_current_patterns], ax
		mov	ax, [_current_patterns]
		cmp	ax, [_word_1DE46]
		jb	short loc_1A21F

loc_1A219:				; CODE XREF: _keyb_19EFD+309j
		mov	[_current_patterns], 0

loc_1A21F:				; CODE XREF: _keyb_19EFD+31Aj
		call	_f4_patternnae
		jmp	_keyb_19EFD
; ---------------------------------------------------------------------------

_l_f5:					; CODE XREF: _keyb_19EFD+D4j
		call	_f5_graphspectr
		jmp	_keyb_19EFD
; ---------------------------------------------------------------------------

_l_f6:					; CODE XREF: _keyb_19EFD+DAj
		call	_f6_undoc
		jmp	_keyb_19EFD
; ---------------------------------------------------------------------------

_l_f8:					; CODE XREF: _keyb_19EFD+E0j
		call	[off_1DE42]
		call	_dosexec
		mov	[_byte_1DE70], 0FFh
		call	[off_1DE3C]
		jmp	_keyb_19EFD
; ---------------------------------------------------------------------------

_l_f9:					; CODE XREF: _keyb_19EFD+E6j
		test	[cs:_keyb_switches], 100b
		jnz	short _l_f11
		call	_get_playsettings
		xor	al, 1
		call	_set_playsettings
		jmp	_keyb_19EFD
; ---------------------------------------------------------------------------

_l_f10:					; CODE XREF: _keyb_19EFD+ECj
		test	[cs:_keyb_switches], 100b
		jnz	short _l_f12
		call	_get_playsettings
		xor	al, 2
		call	_set_playsettings
		jmp	_keyb_19EFD
; ---------------------------------------------------------------------------

_l_f11:					; CODE XREF: _keyb_19EFD+F2j
					; _keyb_19EFD+34Ej
		call	_get_playsettings
		xor	al, 4
		call	_set_playsettings
		jmp	_keyb_19EFD
; ---------------------------------------------------------------------------

_l_f12:					; CODE XREF: _keyb_19EFD+F8j
					; _keyb_19EFD+366j
		call	_get_playsettings

loc_1A288:
		xor	al, 10h
		call	_set_playsettings

loc_1A28F:
		xor	[byte ptr _configword+1], 1
		jmp	_keyb_19EFD
; ---------------------------------------------------------------------------

_l_tab:					; CODE XREF: _keyb_19EFD+116j
		test	[cs:_keyb_switches], 100b
		jnz	short loc_1A2C1

loc_1A2A0:
		test	[cs:_keyb_switches], 1000b
		jnz	short loc_1A2D1
		test	[cs:_keyb_switches], 11b
		jnz	short loc_1A2E1
		call	_get_playsettings
		xor	al, 8
		call	_set_playsettings

loc_1A2BE:
		jmp	_keyb_19EFD
; ---------------------------------------------------------------------------

loc_1A2C1:				; CODE XREF: _keyb_19EFD+3A1j
		mov	cx, 0FFh
		xor	bx, bx
		mov	dx, 7D0Fh
		call	sub_12CAD
		jmp	_keyb_19EFD
; ---------------------------------------------------------------------------

loc_1A2D1:				; CODE XREF: _keyb_19EFD+3AAj
		mov	cx, 0FFh
		xor	bx, bx
		mov	dx, 910Fh
		call	sub_12CAD
		jmp	_keyb_19EFD
; ---------------------------------------------------------------------------

loc_1A2E1:				; CODE XREF: _keyb_19EFD+3B3j
		mov	cx, 0FFh
		xor	bx, bx
		mov	dx, 960Fh
		call	sub_12CAD
		jmp	_keyb_19EFD
; ---------------------------------------------------------------------------

_l_numlock:				; CODE XREF: _keyb_19EFD+11Cj
		test	[cs:_keyb_switches], 100b
		jz	_keyb_19EFD
		mov	al, 0FFh
		call	_getset_playstate
		mov	ah, al
		mov	al, 1
		cmp	ah, al
		jnz	short loc_1A30D
		mov	al, 0

loc_1A30D:				; CODE XREF: _keyb_19EFD+40Cj
		call	_getset_playstate
		jmp	_keyb_19EFD
; ---------------------------------------------------------------------------

_l_scrollock:				; CODE XREF: _keyb_19EFD+122j
		mov	al, 0FFh
		call	_getset_playstate
		mov	ah, al
		mov	al, 2
		cmp	ah, al
		jnz	short loc_1A326
		mov	al, 0

loc_1A326:				; CODE XREF: _keyb_19EFD+425j
		call	_getset_playstate
		jmp	_keyb_19EFD
; ---------------------------------------------------------------------------

_l_1_end:				; CODE XREF: _keyb_19EFD+128j
		mov	cx, 0FFh
		xor	bx, bx
		mov	dx, 0Dh
		call	sub_12CAD
		jmp	_keyb_19EFD
; ---------------------------------------------------------------------------

loc_1A33E:				; CODE XREF: _keyb_19EFD+13Ej
		sub	al, 2
		test	[cs:_keyb_switches], 11b
		jz	short loc_1A34B
		add	al, 10

loc_1A34B:				; CODE XREF: _keyb_19EFD+44Aj
		test	[cs:_keyb_switches], 100b
		jz	short loc_1A356
		add	al, 20

loc_1A356:				; CODE XREF: _keyb_19EFD+455j
		cmp	al, [byte ptr _amount_of_x]
		jnb	_keyb_19EFD
		mov	ch, al
		lfs	bx, [_segfsbx_1DE28]
		mov	ah, 80
		mul	ah
		add	bx, ax
		xor	[byte ptr fs:bx+17h], 2
		mov	bx, 0FEh ; 'þ'
		xor	cl, cl
		xor	dx, dx
		call	sub_12CAD
		jmp	_keyb_19EFD
; ---------------------------------------------------------------------------

_l_enter:				; CODE XREF: _keyb_19EFD+12Ej
					; DATA XREF: dseg:stru_244ABo
		call	[_offs_draw]
		call	[_offs_draw2]
		clc
		retn
; ---------------------------------------------------------------------------

_l_esc:					; CODE XREF: _keyb_19EFD+134j
					; DATA XREF: dseg:stru_244B7o
		mov	[_byte_1DE7C], 1
		and	[_byte_1DE90], 0FDh

loc_1A393:				; CODE XREF: _keyb_19EFD+3Bj
		call	[_offs_draw]
		call	[_offs_draw2]
		call	_snd_offx
		call	_memfree_125DA
		clc
		retn
; ---------------------------------------------------------------------------

loc_1A3A7:				; CODE XREF: _keyb_19EFD+4Dj
		and	[_byte_1DE90], 0FEh
		mov	bx, offset stru_244AB ;	_mystr
		mov	ax, [_mousecolumn]
		mov	bp, [_mouserow]
		shr	ax, 3
		shr	bp, 3
		call	_mouse_1C7CF
		jb	_keyb_19EFD
		jmp	bx
; ---------------------------------------------------------------------------

loc_1A3C5:				; CODE XREF: _keyb_19EFD+44j
		mov	bx, offset stru_244B7 ;	_mystr
		mov	ax, [_mousecolumn]
		mov	bp, [_mouserow]
		shr	ax, 3
		shr	bp, 3
		call	_mouse_1C7CF
		jb	_keyb_19EFD
		push	es
		xor	dx, dx
		mov	es, dx
		assume es:nothing
		mov	edx, [es:46Ch]
		cmp	edx, [_dword_1DE88]
		jz	short loc_1A3F6
		mov	[_dword_1DE88], edx
		pop	es
		assume es:nothing
		jmp	bx
; ---------------------------------------------------------------------------

loc_1A3F6:				; CODE XREF: _keyb_19EFD+4EFj
		pop	es
		jmp	loc_193BC
endp		_keyb_19EFD


; =============== S U B	R O U T	I N E =======================================


proc		_f1_help	near		; CODE XREF: _keyb_19EFD:_l_f1p
					; DATA XREF: dseg:02A6o
		mov	[off_1DE3C], offset _text_init
		mov	[_offs_draw], offset _f1_draw
		mov	[_offs_draw2], offset _text_init2
		mov	[off_1DE42], offset loc_1A4A6
		call	_text_init
		retn
endp		_f1_help


; =============== S U B	R O U T	I N E =======================================


proc		_f2_waves near		; CODE XREF: _keyb_19EFD:_l_f2p
					; DATA XREF: dseg:02A0o
		mov	[off_1DE3C], offset _init_vga_waves
		mov	[_offs_draw], offset _f2_draw_waves
		mov	[_offs_draw2], offset _f2_draw_waves2
		mov	[off_1DE42], offset _init_vga_waves
		call	_init_vga_waves
		retn
endp		_f2_waves


; =============== S U B	R O U T	I N E =======================================


proc		_f3_textmetter near	; CODE XREF: _keyb_19EFD:_l_f3p
					; DATA XREF: dseg:off_1CA8Eo
		mov	[off_1DE3C], offset _text_init
		mov	[_offs_draw], offset _f3_draw
		mov	[_offs_draw2], offset _text_init2
		mov	[off_1DE42], offset loc_1A4A6
		call	_text_init
		retn
endp		_f3_textmetter


; =============== S U B	R O U T	I N E =======================================


proc		_f4_patternnae near	; CODE XREF: _keyb_19EFD:loc_1A21Fp
					; DATA XREF: dseg:02A4o
		mov	[off_1DE3C], offset _text_init
		mov	[_offs_draw], offset _f4_draw
		mov	[_offs_draw2], offset _text_init2
		mov	[off_1DE42], offset loc_1A4A6
		call	_text_init
		retn
endp		_f4_patternnae


; =============== S U B	R O U T	I N E =======================================


proc		_f5_graphspectr near	; CODE XREF: _keyb_19EFD:_l_f5p
					; DATA XREF: dseg:02A2o
		mov	[off_1DE3C], offset _init_f5_spectr
		mov	[_offs_draw], offset _f5_draw_spectr
		mov	[_offs_draw2], offset _f5_draw_spectr
		mov	[off_1DE42], offset _init_f5_spectr
		call	_init_f5_spectr
		retn
endp		_f5_graphspectr


; =============== S U B	R O U T	I N E =======================================


proc		_f6_undoc near		; CODE XREF: _keyb_19EFD:_l_f6p
					; DATA XREF: dseg:02A8o
		mov	[off_1DE3C], offset _text_init
		mov	[_offs_draw], offset _f6_draw
		mov	[_offs_draw2], offset _text_init2
		mov	[off_1DE42], offset loc_1A4A6
		call	_text_init
		retn
endp		_f6_undoc


; =============== S U B	R O U T	I N E =======================================


proc		_text_init near		; CODE XREF: _f1_help+18p
					; _f3_textmetter+18p ...
		call	_text_init2
		retn
endp		_text_init

; ---------------------------------------------------------------------------

loc_1A4A6:				; DATA XREF: _f1_help+12o
					; _f3_textmetter+12o ...
		call	_text_init2
		retn

; =============== S U B	R O U T	I N E =======================================


proc		_text_init2 near		; CODE XREF: _text_initp
					; seg001:loc_1A4A6p
					; DATA XREF: ...

; FUNCTION CHUNK AT 14A2 SIZE 0000026B BYTES

		cmp	[_byte_1DE86], 1
		jz	short loc_1A4F2
		cmp	[_amount_of_x], 0Ah
		jbe	short loc_1A4F2
		jmp	loc_1A5AB
endp		_text_init2


; =============== S U B	R O U T	I N E =======================================


proc		_setvideomode near	; CODE XREF: _start:loc_192F7p
					; _text_init2:loc_1A4F2p
		cmp	[_byte_1DE70], 0
		jz	short locret_1A4F1
		cmp	[_byte_1DE70], 1
		jz	short locret_1A4F1
		mov	ax, 3
		cmp	[_byte_1DE70], 2
		jnz	short loc_1A4D5
		or	al, 80h

loc_1A4D5:				; CODE XREF: _setvideomode+16j
		int	10h		; - VIDEO - SET	VIDEO MODE
					; AL = mode
		call	_txt_blinkingoff
		cmp	[_byte_1DE86], 1
		jz	short loc_1A4E8
		mov	ax, 1111h
		xor	bl, bl
		int	10h		; - VIDEO - TEXT-MODE CHARACTER	GENERATOR FUNCTIONS (PS, EGA, VGA)
					; AL = 00h, 10h: load user-specified patterns
					; AL = 01h, 11h: load ROM monochrome patterns (8 by 14)
					; AL = 02h, 12h: load ROM 8 by 8 double-dot patterns
					; AL = 03h: set	block specifier

loc_1A4E8:				; CODE XREF: _setvideomode+24j
		mov	dx, 1D00h
		xor	bh, bh
		mov	ah, 2
		int	10h		; - VIDEO - SET	CURSOR POSITION
					; DH,DL	= row, column (0,0 = upper left)
					; BH = page number

locret_1A4F1:				; CODE XREF: _setvideomode+5j
					; _setvideomode+Cj
		retn
endp		_setvideomode

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR _text_init2

loc_1A4F2:				; CODE XREF: _text_init2+5j
					; _text_init2+Cj
		call	_setvideomode
		cmp	[_byte_1DE86], 1
		jz	short loc_1A55B
		mov	[_word_1DE6E], 0Ah
		mov	eax, [_videomempointer]
		add	ax, 36*80
		mov	[_videopoint_shiftd], eax
		cmp	[_byte_1DE70], 0
		jz	short loc_1A545
		cmp	[_byte_1DE70], 1
		jz	short loc_1A529
		mov	cx, 0
		mov	dx, 1B4Fh
		mov	bl, 78h	; 'x'
		mov	ax, 7F03h
		call	_draw_frame

loc_1A529:				; CODE XREF: _text_init2+6Fj
		mov	cx, 1103h
		mov	dx, 1A25h
		mov	bl, 7Fh	; ''
		mov	ax, 7803h
		call	_draw_frame
		mov	cx, 112Ah
		mov	dx, 1A4Ch
		mov	bl, 7Fh	; ''
		mov	ax, 7803h
		call	_draw_frame

loc_1A545:				; CODE XREF: _text_init2+68j
		mov	cx, 501h
		mov	dx, 104Eh
		mov	bl, 7Fh	; ''
		mov	ax, 7803h
		call	_draw_frame
		mov	[_byte_1DE70], 0
		jmp	loc_1A628
; ---------------------------------------------------------------------------

loc_1A55B:				; CODE XREF: _text_init2+50j
		mov	[_word_1DE6E], 7
		mov	eax, [_videomempointer]
		add	ax, 30*80
		mov	[_videopoint_shiftd], eax
		mov	cx, 0
		mov	dx, 184Fh
		mov	bl, 78h	; 'x'
		mov	ax, 7F03h
		call	_draw_frame
		mov	cx, 0E03h
		mov	dx, 1725h
		mov	bl, 7Fh	; ''
		mov	ax, 7803h
		call	_draw_frame
		mov	cx, 0E2Ah
		mov	dx, 174Ch
		mov	bl, 7Fh	; ''
		mov	ax, 7803h
		call	_draw_frame
		mov	cx, 501h
		mov	dx, 0D4Eh
		mov	bl, 7Fh	; ''
		mov	ax, 7803h
		call	_draw_frame
		mov	[_byte_1DE70], 0
		jmp	short loc_1A628
; ---------------------------------------------------------------------------

loc_1A5AB:				; CODE XREF: _text_init2+Ej
		cmp	[_byte_1DE70], 2
		jz	short loc_1A61A
		mov	ax, 3
		cmp	[_byte_1DE70], 1
		jz	short loc_1A5C3
		cmp	[_byte_1DE70], 0
		jnz	short loc_1A5C5

loc_1A5C3:				; CODE XREF: _text_init2+110j
		or	al, 80h

loc_1A5C5:				; CODE XREF: _text_init2+117j
		int	10h		; - VIDEO - SET	VIDEO MODE
					; AL = mode
		call	_txt_blinkingoff
		mov	ax, 1112h
		xor	bl, bl
		int	10h		; - VIDEO - TEXT-MODE CHARACTER	GENERATOR FUNCTIONS (PS, EGA, VGA)
					; AL = 00h, 10h: load user-specified patterns
					; AL = 01h, 11h: load ROM monochrome patterns (8 by 14)
					; AL = 02h, 12h: load ROM 8 by 8 double-dot patterns
					; AL = 03h: set	block specifier
		mov	dx, 3300h
		xor	bh, bh
		mov	ah, 2
		int	10h		; - VIDEO - SET	CURSOR POSITION
					; DH,DL	= row, column (0,0 = upper left)
					; BH = page number
		mov	[_byte_1DE70], 2
		mov	[_word_1DE6E], 20h ; ' '
		mov	eax, [_videomempointer]
		add	ax, 6400
		mov	[_videopoint_shiftd], eax
		mov	cx, 0
		mov	dx, 314Fh
		mov	bl, 78h	; 'x'
		mov	ax, 7F03h
		call	_draw_frame
		mov	cx, 2703h
		mov	dx, 3025h
		mov	bl, 7Fh	; ''
		mov	ax, 7803h
		call	_draw_frame
		mov	cx, 272Ah
		mov	dx, 304Ch
		mov	bl, 7Fh	; ''
		mov	ax, 7803h
		call	_draw_frame

loc_1A61A:				; CODE XREF: _text_init2+106j
		mov	cx, 501h
		mov	dx, 264Eh
		mov	bl, 7Fh	; ''
		mov	ax, 7803h
		call	_draw_frame

loc_1A628:				; CODE XREF: _text_init2+AEj
					; _text_init2+FFj
		call	_txt_draw_top_title
		mov	ax, ds
		mov	bx, offset _buffer_1 ; 2800h
		shr	bx, 4
		add	ax, bx
		mov	[_buffer_1seg], ax
		movzx	si, [_snd_card_type]
		cmp	si, 0Ah
		jb	short loc_1A645
		mov	si, 0Ah

loc_1A645:				; CODE XREF: _text_init2+196j
		shl	si, 1
		mov	si, [_table_sndcrdname+si] ; str
		les	di, [_videopoint_shiftd]
		add	di, 58h	; 'X'   ; videoptr
		mov	ah, 7Fh	; ''   ; color
		call	_put_message
		cmp	[_snd_card_type], 0
		jnz	short loc_1A687
		push	di
		push	es
		call	sub_1265D
		pop	es
		pop	di
		mov	[word ptr es:di], 7F20h
		add	di, 2		; videoptr
		movzx	si, dh
		and	si, 1100000b
		shr	si, 3
		add	si, offset _a256	; str
		mov	ah, 7Fh	; ''   ; color
		call	_put_message
		mov	si, offset _aKb	; str
		call	_put_message

loc_1A687:				; CODE XREF: _text_init2+1B2j
		cmp	[_snd_card_type], 0Ah
		jz	short loc_1A6B7
		mov	si, (offset _buffer_1DC6C+2)

loc_1A691:				; ' )'
		mov	[word ptr _buffer_1DC6C], 2820h
		xor	dx, dx

loc_1A699:
		mov	ax, [_outp_freq]
		mov	cx, 1000
		div	cx

loc_1A6A1:
		call	_my_u8toa10
		mov	[dword ptr si],	297A486Bh ; 'kHz('
		mov	[byte ptr si+4], 0
		mov	si, offset _buffer_1DC6C	; str
		mov	ah, 7Fh	; ''   ; color
		call	_put_message

loc_1A6B7:				; CODE XREF: _text_init2+1E2j
		mov	al, 78h	; 'x'
		cmp	[_byte_1DE7B], 1
		jnz	short loc_1A6C2
		mov	al, 7Ch	; '|'

loc_1A6C2:				; CODE XREF: _text_init2+214j
		mov	[_byte_1CCEB], al
		les	di, [_videopoint_shiftd]
		mov	si, offset _bottom_menu ; str
		call	_write_scr
		call	sub_126A9
		mov	[word ptr _dword_1DE2C],	si
		mov	[word ptr _dword_1DE2C+2], es
		push	cx
		mov	si, offset _buffer_1DC6C
		mov	al, ch
		push	bx
		call	_my_u8toa10
		pop	bx
		mov	[byte ptr si], '/'
		inc	si
		movzx	ax, bh
		mov	[_word_1DE46], ax
		call	_my_u8toa10
		mov	[dword ptr si],	'   '
		mov	si, offset _buffer_1DC6C	; str
		les	di, [_videopoint_shiftd]
		add	di, 2AAh	; videoptr
		mov	ah, 7Fh	; ''   ; color
		call	_put_message
		pop	cx
		mov	si, offset _buffer_1DC6C
		mov	al, cl
		call	_my_u8toa10
		mov	[dword ptr si],	'   '
		sub	si, cx		; str
		les	di, [_videopoint_shiftd]
		add	di, 20Ah	; videoptr
		mov	ah, 7Fh	; ''   ; color
		call	_put_message
		mov	bx, 0FFFFh
		mov	ah, 48h
		int	21h		; DOS -	2+ - ALLOCATE MEMORY
					; BX = number of 16-byte paragraphs desired
		mov	ax, bx
		shr	ax, 6
		mov	si, offset _buffer_1DC6C
		call	_my_u16toa10
		mov	[dword ptr si],	20424Bh	; 'KB '
		cmp	si, (offset _buffer_1DC6C+2)
		jb	short loc_1A74D
		mov	[byte ptr si+2], 0

loc_1A74D:				; CODE XREF: _text_init2+29Dj
		sub	si, cx		; str
		les	di, [_videopoint_shiftd]
		add	di, 12Eh	; videoptr
		mov	ah, 7Fh	; ''   ; color
		call	_put_message
		retn
; END OF FUNCTION CHUNK	FOR _text_init2

; =============== S U B	R O U T	I N E =======================================


proc		_txt_draw_top_title near	; CODE XREF: _start+201p _start+27Bp ...
		mov	cx, 102h
		mov	dx, 44Dh
		mov	bl, 78h	; 'x'
		mov	ax, 7F03h
		call	_draw_frame
		les	di, [_videomempointer]
		mov	si, offset _atop_title ;	str
		call	_write_scr
		retn
endp		_txt_draw_top_title


; =============== S U B	R O U T	I N E =======================================


proc		_txt_draw_bottom	near	; CODE XREF: seg001:_f3_drawp
					; seg001:_f4_drawp ...
		mov	si, offset _buffer_1DC6C
		mov	eax, '    '
		mov	[si], eax
		mov	[si+4],	eax
		mov	[si+8],	eax
		mov	[si+0Ch], al
		mov	[byte ptr si+0Dh], 0
		mov	al, [_byte_1DE75]
		call	_my_u8toa10
		mov	[dword ptr si],	20746120h ; ' at '
		add	si, 4
		mov	al, [_byte_1DE76]
		call	_my_u8toa10
		mov	[word ptr si], 7062h ; bp
		mov	[byte ptr si+2], 'm'
		mov	si, offset _buffer_1DC6C	; str
		les	di, [_videopoint_shiftd]
		add	di, 48Ah	; videoptr
		mov	ah, 7Fh	; ''   ; color
		call	_put_message
		mov	si, offset _aPal	; "(PAL) "
		test	[_flg_play_settings], 8
		jnz	short loc_1A7CC
		mov	si, offset _aNtsc ; str

loc_1A7CC:				; CODE XREF: _txt_draw_bottom+51j
		les	di, [_videopoint_shiftd]
		add	di, 476h	; videoptr
		mov	ah, 7Eh	; '~'   ; color
		call	_put_message
		mov	si, offset _buffer_1DC6C
		mov	al, [_byte_1DE72]
		inc	al
		call	_my_u8toa10
		mov	[byte ptr si], '/'
		inc	si
		mov	al, [_byte_1DE73]
		call	_my_u8toa10
		mov	[dword ptr si],	'   '
		mov	si, offset _buffer_1DC6C	; str
		les	di, [_videopoint_shiftd]
		add	di, 34Ah	; videoptr
		mov	ah, 7Fh	; ''   ; color
		call	_put_message
		mov	si, offset _buffer_1DC6C
		mov	al, [_byte_1DE74]
		inc	al
		call	_my_u8toa10
		mov	[dword ptr si],	2034362Fh ; /64
		mov	[word ptr si+4], ' '
		sub	si, cx		; str
		les	di, [_videopoint_shiftd]
		add	di, 3EAh	; videoptr
		mov	ah, 7Fh	; ''   ; color
		call	_put_message
		les	di, [_videopoint_shiftd]
		add	di, 198h
		mov	ah, 7Ch	; '|'
		test	[_flg_play_settings], 1
		jnz	short loc_1A83E
		mov	ah, 78h	; 'x'

loc_1A83E:				; CODE XREF: _txt_draw_bottom+C4j
		mov	al, 0FEh ; 'þ'
		mov	[es:di], ax
		les	di, [_videopoint_shiftd]
		add	di, 238h
		mov	ah, 7Ch	; '|'
		test	[_flg_play_settings], 2
		jnz	short loc_1A856
		mov	ah, 78h	; 'x'

loc_1A856:				; CODE XREF: _txt_draw_bottom+DCj
		mov	al, 0FEh ; 'þ'
		mov	[es:di], ax
		les	di, [_videopoint_shiftd]
		add	di, 2D8h
		mov	ah, 7Ch	; '|'
		test	[_flg_play_settings], 4
		jnz	short loc_1A86E
		mov	ah, 78h	; 'x'

loc_1A86E:				; CODE XREF: _txt_draw_bottom+F4j
		mov	al, 0FEh ; 'þ'
		mov	[es:di], ax
		les	di, [_videopoint_shiftd]
		add	di, 378h	; interp text offset
		mov	ah, 7Ch	; '|'
		test	[_flg_play_settings], 10h
		jnz	short loc_1A886
		mov	ah, 78h	; 'x'

loc_1A886:				; CODE XREF: _txt_draw_bottom+10Cj
		mov	al, 0FEh ; 'þ'
		mov	[es:di], ax
		mov	si, offset _buffer_1DC6C
		imul	ax, [_word_1DE6A], 100
		mov	al, ah
		call	_my_u8toa10
		mov	[dword ptr si],	202025h	; '%  '
		sub	si, cx		; str
		les	di, [_videopoint_shiftd]
		add	di, 43Ah	; videoptr
		mov	ah, 7Fh	; ''   ; color
		call	_put_message
		mov	si, offset _buffer_1DC6C
		mov	ax, [_word_1DE6C]
		call	_my_u16toa10
		mov	[dword ptr si],	202025h	; '%  '
		sub	si, cx		; str
		les	di, [_videopoint_shiftd]
		add	di, 4DAh	; videoptr
		mov	ah, 7Fh	; ''   ; color
		call	_put_message
		mov	al, 0FFh
		call	_getset_playstate
		movzx	si, al
		shl	si, 2
		add	si, offset _aPlaypausloop ; "PlayPausLoop"
		les	di, [_videopoint_shiftd]
		add	di, 0FCh ; 'ü'
		mov	ah, 7Eh	; '~'
		mov	cx, 4

loc_1A8EB:				; CODE XREF: _txt_draw_bottom+17Fj
		mov	al, [si]
		mov	[es:di], ax
		inc	si
		add	di, 2
		dec	cx
		jnz	short loc_1A8EB
		retn
endp		_txt_draw_bottom

; ---------------------------------------------------------------------------

_f3_draw:				; DATA XREF: _f3_textmetter+6o
		call	_txt_draw_bottom
		cmp	[_byte_1DE85], 1
		jz	short loc_1A913
		mov	es, [_buffer_1seg]
		assume es:nothing
		xor	di, di
		mov	cx, 50h	; 'P'
		mov	ax, 4001h
		call	_volume_prep

loc_1A913:				; CODE XREF: seg001:18B0j
		mov	[_buffer_2seg], offset _buffer_1 ; 2800h
		lfs	bx, [_segfsbx_1DE28]
		les	di, [_videomempointer]
		assume es:nothing
		add	di, 3C4h
		mov	cx, [_amount_of_x]
		cmp	cx, [_word_1DE6E]
		jbe	short loc_1A934
		mov	cx, [_word_1DE6E]

loc_1A934:				; CODE XREF: seg001:18DEj
		inc	[_byte_1DE71]
		xor	ax, ax

loc_1A93A:				; CODE XREF: seg001:1AB8j
		push	ax
		push	cx
		push	di
		mov	dl, al
		add	al, '1'
		cmp	al, '9'
		jbe	short loc_1A947
		add	al, 7

loc_1A947:				; CODE XREF: seg001:18F3j
		mov	ah, 1Eh
		cmp	dl, [_byte_1DE84]
		jz	short loc_1A951
		mov	ah, 7Eh	; '~'

loc_1A951:				; CODE XREF: seg001:18FDj
		mov	[es:di+2], ax
		mov	al, ' '
		mov	[es:di], ax
		mov	[es:di+4], ax
		add	di, 6
		movzx	si, [byte ptr fs:bx+35h]
		mov	al, ' '
		test	si, 0Fh
		jz	short loc_1A975
		mov	ax, si
		shr	al, 4
		add	al, '0'

loc_1A975:				; CODE XREF: seg001:191Cj
		mov	ah, 7Fh	; ''
		mov	[es:di+4], ax
		and	si, 0Fh
		shl	si, 1
		mov	al, [byte ptr _notes+si]	; "  C-C#D-D#E-F-F#G-G#A-A#B-"
		mov	[es:di], ax
		mov	al, [byte ptr (_notes+1)+si]
		mov	[es:di+2], ax
		add	di, 8
		test	[byte ptr fs:bx+17h], 1
		jnz	short loc_1A9AD
		mov	si, offset _aMute ; "<Mute>		  "
		mov	ah, 7Fh	; ''
		test	[byte ptr fs:bx+17h], 2
		jnz	short loc_1A9A8

loc_1A9A5:				; CODE XREF: seg001:1964j
		mov	si, offset asc_1DA00 ; "		      "

loc_1A9A8:				; CODE XREF: seg001:1953j
		call	_put_message
		jmp	short loc_1A9C2
; ---------------------------------------------------------------------------

loc_1A9AD:				; CODE XREF: seg001:1947j
		movzx	eax, [byte ptr fs:bx+2]
		dec	ax
		js	short loc_1A9A5
		shl	ax, 6
		mov	si, ax
		add	si, [word ptr _dword_1DE2C]
		call	_txt_1ABAE

loc_1A9C2:				; CODE XREF: seg001:195Bj
		add	di, 2
		cmp	[_byte_1DE85], 1
		jnz	short loc_1AA1A
		push	di
		push	es
		mov	ax, ds
		mov	es, ax
		assume es:dseg
		mov	di, offset _buffer_1 ; 2800h
		cld
		movzx	eax, [byte ptr fs:bx+2]
		mov	bp, 2
		call	_my_u32toa_fill
		mov	bp, 4
		movzx	eax, [byte ptr fs:bx+22h]
		call	_my_u32toa_fill
		mov	bp, 7
		movzx	eax, [word ptr fs:bx+1Eh]
		call	_my_u32toa_fill
		mov	ax, ds
		mov	es, ax
		mov	eax, '    '
		mov	cx, 4
		rep stosd
		mov	[byte ptr di], 0
		pop	es
		assume es:nothing
		pop	di
		mov	si, offset _buffer_1 ; 2800h
		mov	ah, 7Eh	; '~'
		call	_put_message

loc_1AA17:
		jmp	loc_1AACB
; ---------------------------------------------------------------------------

loc_1AA1A:				; CODE XREF: seg001:197Aj
		cmp	[_snd_card_type], 0Ah
		jz	short loc_1AA62
		mov	si, [_buffer_2seg]
		mov	cx, 50h	; 'P'
		xor	eax, eax
		xor	edx, edx

loc_1AA2E:				; CODE XREF: seg001:19EBj
		mov	dl, [si]
		or	dl, dl
		jns	short loc_1AA36
		neg	dl

loc_1AA36:				; CODE XREF: seg001:19E2j
		inc	si
		add	eax, edx
		dec	cx
		jnz	short loc_1AA2E
		mov	[_buffer_2seg], si
		xor	edx, edx
		div	[_volume_1DE34]
		cmp	al, 60
		jb	short loc_1AA4F
		mov	al, 60

loc_1AA4F:				; CODE XREF: seg001:19FBj
		cmp	[_byte_1DE83], 0
		jz	short loc_1AA5C
		cmp	al, [fs:bx+1Ah]
		jb	short loc_1AA73

loc_1AA5C:				; CODE XREF: seg001:1A04j
		mov	[fs:bx+1Ah], al
		jmp	short loc_1AA88
; ---------------------------------------------------------------------------

loc_1AA62:				; CODE XREF: seg001:19CFj
		test	[byte ptr fs:bx+17h], 1
		jz	short loc_1AA73
		mov	al, [fs:bx+22h]
		mov	[fs:bx+1Ah], al
		jmp	short loc_1AA88
; ---------------------------------------------------------------------------

loc_1AA73:				; CODE XREF: seg001:1A0Aj seg001:1A17j
					; DATA XREF: ...
		and	[_byte_1DE71], 1Fh
		jnz	short loc_1AA88
		mov	al, [_byte_1DE83]
		sub	[fs:bx+1Ah], al
		jns	short loc_1AA88
		mov	[byte ptr fs:bx+1Ah], 0

loc_1AA88:				; CODE XREF: seg001:1A10j seg001:1A21j ...
		movzx	cx, [byte ptr fs:bx+1Ah]
		shr	cx, 1
		mov	dx, 30
		sub	dx, cx
		jcxz	short _volume_endstr
		mov	si, cx
		mov	cx, 0Dh
		cmp	si, cx
		ja	short _volume_medium
		mov	cx, si

_volume_medium:				; CODE XREF: seg001:1A4Dj
		mov	ax, 7A16h
		cld
		rep stosw
		sub	si, 0Dh
		jbe	short _volume_endstr
		mov	cx, 0Ch
		cmp	si, cx
		ja	short _volume_higher
		mov	cx, si

_volume_higher:				; CODE XREF: seg001:1A61j
		mov	ah, 7Eh	; '~'
		rep stosw
		sub	si, 0Ch
		jbe	short _volume_endstr
		mov	cx, si
		mov	ah, 7Ch	; '|'
		rep stosw

_volume_endstr:				; CODE XREF: seg001:1A44j seg001:1A5Aj ...
		mov	cx, dx
		mov	ax, 7816h
		rep stosw

loc_1AACB:				; CODE XREF: seg001:loc_1AA17j
		pop	di
		push	di
		add	di, 7Ah	; 'z'
		mov	si, offset asc_1D6E0 ; "	       "
		mov	al, [fs:bx+0Ah]
		cmp	al, 1Dh
		jz	short loc_1AB0D
		cmp	al, 0Eh
		jnz	short loc_1AAF0
		mov	si, offset _aSetLoopPoint ; "Set	Loop Point "
		mov	al, [fs:bx+0Bh]
		cmp	al, 60h	; '`'
		jz	short loc_1AAF7
		mov	si, offset _aSetFilter ;	"Set Filter	"
		shr	al, 4

loc_1AAF0:				; CODE XREF: seg001:1A8Dj
		xor	ah, ah
		shl	ax, 4
		add	si, ax

loc_1AAF7:				; CODE XREF: seg001:1A98j seg001:1AF2j ...
		mov	ah, 7Eh	; '~'
		call	_put_message
		pop	di
		pop	cx
		pop	ax
		add	di, 0A0h ; ' '
		add	bx, 50h	; 'P'
		inc	ax
		dec	cx
		jnz	loc_1A93A
		retn
; ---------------------------------------------------------------------------

loc_1AB0D:				; CODE XREF: seg001:1A89j
		mov	si, offset _aArpeggio ; "Arpeggio       "
		mov	al, [fs:bx+0Bh]
		cmp	al, 37h	; '7'
		jz	short loc_1AB5D	; min
		cmp	al, 47h	; 'G'
		jz	short loc_1AB67	; maj
		cmp	al, 48h	; 'H'
		jz	short loc_1AB53	; puls
		xor	cl, cl
		call	sub_1AB8C
		mov	[si+9],	ax
		mov	cl, [fs:bx+0Bh]
		shr	cl, 4
		call	sub_1AB8C
		mov	[si+0Bh], ax
		mov	cl, [fs:bx+0Bh]
		and	cl, 0Fh
		call	sub_1AB8C
		mov	[si+0Dh], ax
		jmp	short loc_1AAF7
; ---------------------------------------------------------------------------

loc_1AB44:				; CODE XREF: seg001:1B26j seg001:1B2Aj
		mov	[dword ptr si+9], '    '
		mov	[word ptr si+0Dh], '  '
		jmp	short loc_1AAF7
; ---------------------------------------------------------------------------

loc_1AB53:				; CODE XREF: seg001:1ACEj
		mov	[dword ptr si+0Bh], 73756C70h ;	puls
		jmp	short loc_1AB6F
; ---------------------------------------------------------------------------

loc_1AB5D:				; CODE XREF: seg001:1AC6j
		mov	[dword ptr si+0Bh], 206E696Dh ;	min
		jmp	short loc_1AB6F
; ---------------------------------------------------------------------------

loc_1AB67:				; CODE XREF: seg001:1ACAj
		mov	[dword ptr si+0Bh], 206A616Dh ;	maj

loc_1AB6F:				; CODE XREF: seg001:1B0Bj seg001:1B15j
		mov	al, [fs:bx+35h]
		and	ax, 0Fh
		jz	short loc_1AB44
		cmp	al, 0Ch
		ja	short loc_1AB44
		shl	ax, 1
		push	si
		mov	si, ax
		mov	ax, [word ptr _notes+si]	; "  C-C#D-D#E-F-F#G-G#A-A#B-"
		pop	si
		mov	[si+9],	ax
		jmp	loc_1AAF7

; =============== S U B	R O U T	I N E =======================================


proc		sub_1AB8C near		; CODE XREF: seg001:1AD2p seg001:1ADFp ...
		mov	al, [fs:bx+35h]
		and	ax, 0Fh
		add	al, cl
		cmp	al, 0Ch
		jbe	short loc_1AB9B
		sub	al, 0Ch

loc_1AB9B:				; CODE XREF: sub_1AB8C+Bj
		shl	ax, 1
		push	si
		mov	si, ax
		mov	ax, [word ptr _notes+si]	; "  C-C#D-D#E-F-F#G-G#A-A#B-"
		pop	si
		cmp	ah, 2Dh	; '-'
		jz	short loc_1ABAB
		retn
; ---------------------------------------------------------------------------

loc_1ABAB:				; CODE XREF: sub_1AB8C+1Cj
		mov	ah, 20h	; ' '
		retn
endp		sub_1AB8C


; =============== S U B	R O U T	I N E =======================================


proc		_txt_1ABAE near		; CODE XREF: seg001:196Fp
		mov	ah, 7Bh	; '{'
		mov	cx, 16h

loc_1ABB3:				; CODE XREF: _txt_1ABAE+10j
		mov	al, [fs:si]
		mov	[es:di], ax
		inc	si
		add	di, 2
		dec	cx
		jnz	short loc_1ABB3
		retn
endp		_txt_1ABAE

; ---------------------------------------------------------------------------

_f4_draw:				; DATA XREF: _keyb_19EFD:_l_f4o
					; _f4_patternnae+6o
		call	_txt_draw_bottom
		les	di, [_videomempointer]
		add	di, 3C6h
		mov	si, offset _aSamplename ; "# SampleName	 "
		mov	ah, 7Eh	; '~'
		call	_text_1BF69
		mov	di, [word ptr _videomempointer]
		add	di, 464h
		lfs	bx, [_dword_1DE2C]
		mov	bp, [_current_patterns]
		imul	ax, bp,	40h
		add	bx, ax
		mov	dl, [byte ptr _word_1DE6E]
		dec	dl

loc_1ABF0:				; CODE XREF: seg001:1CA1j
		cmp	bp, [_word_1DE46]
		jnb	locret_1ACF5
		push	bx
		push	dx
		push	bp
		push	di
		mov	ax, ds
		mov	es, ax
		assume es:dseg
		mov	di, offset _buffer_1 ; 2800h
		cld
		movzx	eax, bp
		inc	ax
		mov	bp, 2
		call	_my_pnt_u32toa_fill
		mov	[dword ptr di],	7B0220h	;  {
		add	di, 3
		mov	si, bx
		mov	cx, 8
		cld
		rep movs [dword	ptr es:di], [dword ptr fs:si]
		test	[byte ptr fs:bx+3Ch], 1
		jnz	short loc_1AC35
		mov	si, offset unk_1D6C3
		mov	cx, 9
		rep movsb
		jmp	loc_1ACD2
; ---------------------------------------------------------------------------

loc_1AC35:				; CODE XREF: seg001:1BD8j
		mov	eax, [fs:bx+20h]
		mov	bp, 7
		call	_my_pnt_u32toa_fill
		movzx	eax, [byte ptr fs:bx+3Dh]
		mov	bp, 3
		call	_my_pnt_u32toa_fill
		mov	eax, 363120h	; ' 16'
		test	[byte ptr fs:bx+3Ch], 4
		jnz	short loc_1AC5F
		mov	eax, 382020h	; '  8'

loc_1AC5F:				; CODE XREF: seg001:1C07j
		mov	[di], eax
		mov	al, 1Dh
		test	[byte ptr fs:bx+3Ch], 10h
		jnz	short loc_1AC6D
		mov	al, ' '

loc_1AC6D:				; CODE XREF: seg001:1C19j
		mov	[di+3],	al
		add	di, 4
		movzx	eax, [word ptr fs:bx+36h]
		mov	bp, 6
		call	_my_pnt_u32toa_fill
		mov	[dword ptr di],	7A487E02h ;  H
		add	di, 4
		mov	[dword ptr di],	7F0220h	;  square
		add	di, 3
		mov	eax, '    '
		mov	ah, [fs:bx+3Eh]
		and	ah, 0Fh
		test	ah, 8
		jz	short loc_1ACAC
		mov	al, '-'
		neg	ah
		add	ah, 10h

loc_1ACAC:				; CODE XREF: seg001:1C53j
		or	ah, '0'
		mov	[di], eax
		add	di, 4
		test	[byte ptr fs:bx+3Ch], 8
		jz	short loc_1ACD2
		mov	eax, [fs:bx+24h]
		mov	bp, 7
		call	_my_pnt_u32toa_fill
		mov	eax, [fs:bx+2Ch]
		mov	bp, 7
		call	_my_pnt_u32toa_fill

loc_1ACD2:				; CODE XREF: seg001:1BE2j seg001:1C6Aj
		mov	[byte ptr di], 0
		pop	di
		push	di
		mov	es, [word ptr _videomempointer+2]
		assume es:nothing
		mov	si, offset _buffer_1 ; 2800h
		mov	ah, 7Fh	; ''
		call	_text_1BF69
		pop	di
		pop	bp
		pop	dx
		pop	bx
		add	bx, 40h	; '@'
		inc	bp
		add	di, 0A0h ; ' '
		dec	dl
		jnz	loc_1ABF0

locret_1ACF5:				; CODE XREF: seg001:1BA4j
		retn

; =============== S U B	R O U T	I N E =======================================


; void __usercall _my_pnt_u32toa_fill(int count<ebp>)
proc		_my_pnt_u32toa_fill near	; CODE XREF: seg001:1BBCp seg001:1BEDp ...
		mov	[word ptr di], 7F02h
		add	di, 2
endp		_my_pnt_u32toa_fill ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


; void __usercall _my_u32toa_fill(int count<ebp>)
proc		_my_u32toa_fill near	; CODE XREF: _filelist_198B8+82p
					; _filelist_198B8+92p ...
		mov	si, offset _buffer_1DC6C
		push	bx
		push	di
		push	bp
		call	_my_u32toa10
		pop	bp
		pop	di
		pop	bx
		cmp	cx, bp
		jb	short loc_1AD0F
		mov	cx, bp

loc_1AD0F:				; CODE XREF: _my_u32toa_fill+Ej
		sub	si, cx
		mov	dx, cx
		neg	cx
		add	cx, bp
		mov	al, ' '
		cld
		rep stosb
		mov	cx, dx
		rep movsb
		retn
endp		_my_u32toa_fill

; ---------------------------------------------------------------------------

_f1_draw:				; DATA XREF: _f1_help+6o
		call	_txt_draw_bottom
		les	di, [_videomempointer]
		assume es:nothing
		mov	si, offset _f1_help_text
		call	_write_scr
		retn

; =============== S U B	R O U T	I N E =======================================


proc		_init_vga_waves near	; CODE XREF: _f2_waves+18p
					; DATA XREF: _f2_waveso	...

; FUNCTION CHUNK AT 1DDD SIZE 0000008D BYTES

		cmp	[_byte_1DE70], 3
		jz	loc_1AEB2
		mov	[_byte_1DE70], 3
		mov	ax, 12h		; VGA 640x480, 16-color; 80 bytes per line; 1 byte-8 pixels
		int	10h		; - VIDEO - SET	VIDEO MODE
					; AL = mode
		mov	ax, ds
		mov	es, ax
		assume es:dseg
		mov	dx, offset _palette_24404
		mov	ax, 1002h
		int	10h		; - VIDEO - SET	ALL PALETTE REGISTERS (Jr, PS, TANDY 1000, EGA,	VGA)
					; ES:DX	-> 17-byte palette register list
		mov	dx, offset _vga_palette
		mov	cx, 10h
		xor	bx, bx
		mov	ax, 1012h
		int	10h		; - VIDEO - SET	BLOCK OF DAC REGISTERS (EGA, VGA/MCGA)
					; BX = starting	color register,	CX = number of registers to set
					; ES:DX	-> table of 3*CX bytes where each 3 byte group represents one
					; byte each of red, green and blue (0-63)
		mov	si, offset _buffer_1DC6C
		call	_getexename
		jb	loc_1AE66
		mov	dx, offset _buffer_1DC6C
		mov	ax, 3D00h
		int	21h		; DOS -	2+ - OPEN DISK FILE WITH HANDLE
					; DS:DX	-> ASCIZ filename
					; AL = access mode
					; 0 - read
		jb	loc_1AE66
		mov	[_fhandle_1DE68], ax
		xor	dx, dx
		xor	cx, cx
		mov	bx, [_fhandle_1DE68]
		mov	ax, 4202h	; get file size
		int	21h		; DOS -	2+ - MOVE FILE READ/WRITE POINTER (LSEEK)
					; AL = method: offset from end of file
		jb	loc_1AE5E
		mov	cx, dx
		mov	dx, ax
		sub	dx, 5AB3h	; read from the	end of file - 15AB3h = the size	of picture
		sbb	cx, 1
		mov	bx, [_fhandle_1DE68]
		mov	ax, 4200h
		int	21h		; DOS -	2+ - MOVE FILE READ/WRITE POINTER (LSEEK)
					; AL = method: offset from beginning of	file
		jb	loc_1AE5E
		mov	dx, offset _buffer_1DC6C
		mov	cx, 2
		mov	bx, [_fhandle_1DE68]
		mov	ah, 3Fh
		int	21h		; DOS -	2+ - READ FROM FILE WITH HANDLE
					; BX = file handle, CX = number	of bytes to read
					; DS:DX	-> buffer
		jb	loc_1AE5E
		cmp	ax, 2
		jnz	loc_1AE5E
		cmp	[word ptr _buffer_1DC6C], 4453h ; 'SD' check picture signature
		jnz	loc_1AE5E
		call	_set_egasequencer
		call	_read2buffer
		mov	dx, 3CEh
		mov	ax, 3
		out	dx, ax		; EGA: graph 1 and 2 addr reg:
					; data rotate and function select for write mode 00. Bits:
					; 0-2: set rotate count	for write mode 00
					; 3-4: fn for write modes 00 and 02
					;      00=no change; 01=AND; 10=OR; 11=XOR
		mov	ax, 0FF08h
		out	dx, ax		; EGA: graph 1 and 2 addr reg:
					; unknown register
		mov	ax, 0A000h
		mov	es, ax
		assume es:nothing
		mov	dx, 3C4h
		mov	al, 2
		out	dx, al		; EGA: sequencer address reg
					; map mask: data bits 0-3 enable writes	to bit planes 0-3
		inc	dl
		xor	bx, bx

loc_1ADE0:				; CODE XREF: _init_vga_waves+12Aj
		mov	ah, 1

loc_1ADE2:				; CODE XREF: _init_vga_waves+121j
		mov	al, ah
		out	dx, al		; EGA port: sequencer data register
		xor	di, di

loc_1ADE7:				; CODE XREF: _init_vga_waves+11Aj
		mov	cl, [si]
		inc	si
		cmp	si, offset _buffer_1seg
		jnb	short loc_1AE0C	; WARNING: push	returns	address	to stack

loc_1ADF0:				; DATA XREF: _init_vga_waves:loc_1AE0Co
		or	cl, cl
		js	short loc_1AE2D
		inc	cl

loc_1ADF6:				; CODE XREF: _init_vga_waves+D9j
		mov	al, [es:bx+di]
		mov	al, [si]
		mov	[es:bx+di], al
		inc	si
		cmp	si, offset _buffer_1seg
		jnb	short loc_1AE11

loc_1AE05:				; DATA XREF: _init_vga_waves:loc_1AE11o
		inc	di
		dec	cl
		jnz	short loc_1ADF6
		jmp	short loc_1AE46
; ---------------------------------------------------------------------------

loc_1AE0C:				; CODE XREF: _init_vga_waves+BFj
		push	offset loc_1ADF0 ; WARNING: push returns address to stack
		jmp	short _read2buffer
; ---------------------------------------------------------------------------

loc_1AE11:				; CODE XREF: _init_vga_waves+D4j
		push	offset loc_1AE05
		jmp	short _read2buffer
; ---------------------------------------------------------------------------

loc_1AE16:				; CODE XREF: _init_vga_waves+109j
		push	offset loc_1AE3A
endp		_init_vga_waves ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


proc		_read2buffer near	; CODE XREF: _init_vga_waves+94p
					; _init_vga_waves+E0j ...
		pusha
		mov	dx, offset _buffer_1 ; 2800h
		mov	cx, 5000h
		mov	bx, [_fhandle_1DE68]
		mov	ah, 3Fh
		int	21h		; DOS -	2+ - READ FROM FILE WITH HANDLE
					; BX = file handle, CX = number	of bytes to read
					; DS:DX	-> buffer
		popa
		mov	si, offset _buffer_1 ; 2800h
		retn
endp		_read2buffer

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR _init_vga_waves

loc_1AE2D:				; CODE XREF: _init_vga_waves+C3j
		neg	cl
		inc	cl
		mov	al, [si]
		inc	si
		cmp	si, offset _buffer_1seg
		jnb	short loc_1AE16

loc_1AE3A:				; CODE XREF: _init_vga_waves+115j
					; DATA XREF: _init_vga_waves:loc_1AE16o
		test	[byte ptr es:bx+di], 0
		mov	[es:bx+di], al
		inc	di
		dec	cl
		jnz	short loc_1AE3A

loc_1AE46:				; CODE XREF: _init_vga_waves+DBj
		cmp	di, 50h	; 'P'
		jb	short loc_1ADE7
		shl	ah, 1
		test	ah, 10h
		jz	short loc_1ADE2
		add	bx, 50h	; 'P'
		cmp	bx, 9600h
		jb	short loc_1ADE0
		call	_graph_1C070

loc_1AE5E:				; CODE XREF: _init_vga_waves+52j
					; _init_vga_waves+6Aj ...
		mov	bx, [_fhandle_1DE68]
		mov	ah, 3Eh
		int	21h		; DOS -	2+ - CLOSE A FILE WITH HANDLE
					; BX = file handle

loc_1AE66:				; CODE XREF: _init_vga_waves+32j
					; _init_vga_waves+3Ej
		pushf
		cli
		mov	dx, 3C4h
		mov	ax, 802h
		out	dx, ax		; EGA: sequencer address reg
					; unknown register
		mov	dx, 3CEh
		mov	ax, 205h
		out	dx, ax		; EGA: graph 1 and 2 addr reg:
					; unknown register
		mov	ax, 3
		out	dx, ax		; EGA: graph 1 and 2 addr reg:
					; data rotate and function select for write mode 00. Bits:
					; 0-2: set rotate count	for write mode 00
					; 3-4: fn for write modes 00 and 02
					;      00=no change; 01=AND; 10=OR; 11=XOR
		popf
		call	_video_prp_mtr_positn

loc_1AE7E:				; CODE XREF: _init_vga_waves+189j
					; _f2_draw_waves2+69j
		mov	ax, ds
		mov	bx, offset _buffer_1 ; 2800h
		shr	bx, 4
		add	ax, bx
		mov	[_buffer_1seg], ax
		add	ax, 280h	; (offset buffer_206E0 - offset	buffer_1DEE0)/16
		mov	[_buffer_2seg], ax
		mov	ax, ds
		mov	es, ax
		assume es:dseg
		mov	di, offset _buffer_1 ; 2800h
		mov	cx, 0A00h
		xor	eax, eax
		cld
		rep stosd
		mov	di, offset _buffer_2
		mov	cx, 0A00h
		mov	eax, 1010101h
		rep stosd
		retn
; ---------------------------------------------------------------------------

loc_1AEB2:				; CODE XREF: _init_vga_waves+5j
		call	_f2_draw_waves2
		call	_video_prp_mtr_positn
		jmp	short loc_1AE7E
; END OF FUNCTION CHUNK	FOR _init_vga_waves

; =============== S U B	R O U T	I N E =======================================


proc		_f2_draw_waves near	; DATA XREF: _f2_waves+6o
		mov	es, [_buffer_1seg]
		assume es:nothing
		xor	di, di
		mov	cx, 128h
		mov	ax, 0C001h
		call	_volume_prep
		mov	ax, 0A000h
		mov	es, ax
		assume es:nothing
		mov	fs, [_buffer_1seg]
		mov	gs, [_buffer_2seg]
		mov	di, offset _x_storage
		xor	si, si
		mov	cx, [_amount_of_x]

_lc_next_meter:				; CODE XREF: _f2_draw_waves+9Cj
		push	cx
		push	si
		push	di
		mov	bp, [di]	; bp = x * 8
		mov	dx, 3CEh
		mov	al, 8
		out	dx, al		; EGA: graph 1 and 2 addr reg:
					; bit mask
					; Bits 0-7 select bits to be masked in all planes
		mov	al, 10000000b	; bits of display memory which can be modified

_lc_nextvideobit:			; CODE XREF: _f2_draw_waves+8Fj
		mov	ah, 37		; 37 * 8 = 296 by x
		mov	dx, 3CFh
		out	dx, al		; EGA port: graphics controller	data register
		mov	bx, bp		; reinit (x*8)

_lc_next_x8:				; CODE XREF: _f2_draw_waves+86j
		movsx	di, [byte ptr gs:si] ; y1
		movsx	dx, [byte ptr fs:si] ; y2
		cmp	di, dx
		jz	short loc_1AF3A
		neg	di
		mov	cx, di
		shl	di, 6
		shl	cx, 4		; multiply by 80 (1 line 80 bytes)
		add	di, cx		; di = y * 80
		lea	cx, [bx+di]
		or	cx, cx		; y * 80 + x
		js	short loc_1AF1E
		cmp	cx, 280*80	; bottom y margin 280
		jnb	short loc_1AF1E
		and	[byte ptr es:bx+di], 111b ; clean previous dot

loc_1AF1E:				; CODE XREF: _f2_draw_waves+58j
					; _f2_draw_waves+5Ej
		neg	dx
		mov	di, dx
		shl	di, 6
		shl	dx, 4
		add	di, dx
		lea	cx, [bx+di]
		or	cx, cx
		js	short loc_1AF3A
		cmp	cx, 280*80
		jnb	short loc_1AF3A
		or	[byte ptr es:bx+di], 1000b ; set new dot

loc_1AF3A:				; CODE XREF: _f2_draw_waves+46j
					; _f2_draw_waves+74j ...
		add	si, 8
		inc	bx		; (x*8)++
		dec	ah
		jnz	short _lc_next_x8 ; y1
		sub	si, 128h
		inc	si
		shr	al, 1		; next video bit
		jnb	short _lc_nextvideobit ;	37 * 8 = 296 by	x
		pop	di
		pop	si
		pop	cx
		add	si, 128h
		add	di, 2		; next x
		dec	cx
		jnz	short _lc_next_meter
		mov	ax, [_buffer_1seg]
		xchg	ax, [_buffer_2seg]
		mov	[_buffer_1seg], ax
		retn
endp		_f2_draw_waves


; =============== S U B	R O U T	I N E =======================================


proc		_f2_draw_waves2 near	; CODE XREF: _init_vga_waves:loc_1AEB2p
					; DATA XREF: _f2_waves+Co
		mov	ax, 0A000h
		mov	es, ax
		mov	fs, [_buffer_1seg]
		mov	gs, [_buffer_2seg]
		mov	di, offset _x_storage
		xor	si, si
		mov	cx, [_amount_of_x]

loc_1AF79:				; CODE XREF: _f2_draw_waves2+67j
		push	cx
		push	si
		push	di
		mov	bp, [di]
		mov	dx, 3CEh
		mov	al, 8
		out	dx, al		; EGA: graph 1 and 2 addr reg:
					; bit mask
					; Bits 0-7 select bits to be masked in all planes
		mov	al, 10000000b

loc_1AF86:				; CODE XREF: _f2_draw_waves2+5Aj
		mov	ah, 37
		mov	dx, 3CFh
		out	dx, al		; EGA port: graphics controller	data register
		mov	bx, bp

loc_1AF8E:				; CODE XREF: _f2_draw_waves2+51j
		movsx	di, [byte ptr gs:si]
		neg	di
		mov	cx, di
		shl	di, 6
		shl	cx, 4
		add	di, cx
		lea	cx, [bx+di]
		or	cx, cx
		js	short loc_1AFAE
		cmp	cx, 22400
		jnb	short loc_1AFAE
		and	[byte ptr es:bx+di], 111b

loc_1AFAE:				; CODE XREF: _f2_draw_waves2+3Fj
					; _f2_draw_waves2+45j
		add	si, 8
		inc	bx
		dec	ah
		jnz	short loc_1AF8E
		sub	si, 128h
		inc	si
		shr	al, 1
		jnb	short loc_1AF86
		pop	di
		pop	si
		pop	cx
		add	si, 128h
		add	di, 2
		dec	cx
		jnz	short loc_1AF79
		jmp	loc_1AE7E
endp		_f2_draw_waves2


; =============== S U B	R O U T	I N E =======================================


proc		_init_f5_spectr near	; CODE XREF: _f5_graphspectr+18p
					; DATA XREF: _f5_graphspectro ...
		cmp	[_byte_1DE70], 4
		jz	locret_1B083
		mov	[_byte_1DE70], 4
		mov	ax, 13h
		int	10h		; - VIDEO - SET	VIDEO MODE
					; AL = mode
		call	_set_egasequencer
		mov	dx, 3C8h
		xor	al, al
		out	dx, al
		jmp	short $+2
		jmp	short $+2
		inc	dx
		out	dx, al
		jmp	short $+2
		out	dx, al
		jmp	short $+2
		out	dx, al
		jmp	short $+2
		mov	bp, 16Ch
		xor	bx, bx

loc_1AFFE:				; CODE XREF: _init_f5_spectr+43j
		mov	al, bh
		out	dx, al
		jmp	short $+2
		mov	al, 3Fh	; '?'
		out	dx, al
		jmp	short $+2
		xor	al, al
		out	dx, al
		jmp	short $+2
		add	bx, bp
		cmp	bh, 40h	; '@'
		jb	short loc_1AFFE

loc_1B014:				; CODE XREF: _init_f5_spectr+58j
		sub	bx, bp
		mov	al, 3Fh	; '?'
		out	dx, al
		jmp	short $+2
		mov	al, bh
		out	dx, al
		jmp	short $+2
		xor	al, al
		out	dx, al
		jmp	short $+2
		or	bh, bh
		jns	short loc_1B014
		mov	dx, 3C8h
		mov	al, 0FCh ; 'ü'
		out	dx, al
		jmp	short $+2
		jmp	short $+2
		inc	dx
		xor	al, al
		out	dx, al
		jmp	short $+2
		out	dx, al
		jmp	short $+2
		out	dx, al
		jmp	short $+2
		mov	al, 10h
		out	dx, al
		jmp	short $+2
		out	dx, al
		jmp	short $+2
		mov	al, 30h	; '0'
		out	dx, al
		jmp	short $+2
		mov	al, 10h
		out	dx, al
		jmp	short $+2
		out	dx, al
		jmp	short $+2
		out	dx, al
		jmp	short $+2
		mov	al, 3Fh	; '?'
		out	dx, al
		jmp	short $+2
		out	dx, al
		jmp	short $+2
		out	dx, al
		call	_graph_1C070
		mov	ax, ds
		mov	es, ax
		assume es:dseg
		mov	di, offset unk_23EE4
		mov	cx, 0C8h ; 'È'
		xor	eax, eax
		cld
		rep stosd
		mov	ax, 200h
		test	[byte ptr _configword], 8
		jnz	short loc_1B080
		shr	ax, 1

loc_1B080:				; CODE XREF: _init_f5_spectr+ADj
		mov	[_word_24524], ax

locret_1B083:				; CODE XREF: _init_f5_spectr+5j
		retn
endp		_init_f5_spectr


; =============== S U B	R O U T	I N E =======================================


proc		_spectr_1B084 near
		mov	[_word_2450E], di
		mov	al, 1
		cmp	al, 1
		jnz	loc_1B240
		call	_spectr_1B406
		mov	ax, [_word_24514]
		xor	si, si

loc_1B098:				; CODE XREF: _spectr_1B084+1Bj
		add	si, 4
		shr	ax, 1
		test	ax, ax
		jnz	short loc_1B098
		sub	si, 4
		mov	ebx, [_tabledword_24526+si]
		mov	[_multip_244D0],	ebx
		mov	eax, [_tabledword_24562+si]
		mov	[_multip_244CC],	eax
		add	eax, 10000h
		mov	[_dword_244C8], eax
		mov	[_dword_244D4], ebx
		mov	cx, [_word_24514]
		shr	cx, 1
		mov	ax, 2

loc_1B0CF:				; CODE XREF: _spectr_1B084+1A2j
		push	cx
		push	ax
		shl	ax, 1
		dec	ax
		mov	di, ax
		inc	ax
		neg	ax
		add	ax, 3
		add	ax, [_word_24514]
		add	ax, [_word_24514]
		mov	si, ax
		mov	eax, [_dword_244C8]
		mov	[_dword_244F4], eax
		mov	eax, [_dword_244D4]
		mov	[_dword_244F8], eax
		dec	si
		shl	si, 2
		dec	di

loc_1B0FB:
		shl	di, 2
		add	si, [_word_2450E]
		add	di, [_word_2450E]
		mov	eax, [di]
		add	eax, [si]
		sar	eax, 1
		mov	[_dword_244E4], eax
		mov	eax, [di+4]
		sub	eax, [si+4]
		sar	eax, 1
		mov	[_dword_244E8], eax
		mov	eax, [di+4]
		add	eax, [si+4]
		sar	eax, 1
		mov	[_dword_244EC], eax
		mov	eax, [si]

loc_1B134:
		sub	eax, [di]
		sar	eax, 1
		mov	[_dword_244F0], eax
		mov	ecx, [_dword_244F4]
		mov	eax, [_dword_244EC]
		imul	ecx
		shrd	eax, edx, 16
		mov	[_dword_244FC], eax
		mov	eax, [_dword_244F0]
		imul	ecx
		shrd	eax, edx, 16
		mov	[_dword_24500], eax
		mov	ecx, [_dword_244F8]
		mov	eax, [_dword_244EC]
		imul	ecx
		shrd	eax, edx, 16
		mov	[_dword_24508], eax
		mov	eax, [_dword_244F0]
		imul	ecx
		shrd	eax, edx, 16
		mov	[_dword_24504], eax
		mov	eax, [_dword_244E4]
		add	eax, [_dword_244FC]
		sub	eax, [_dword_24504]
		mov	[di], eax
		mov	eax, [_dword_244E8]
		add	eax, [_dword_24500]
		add	eax, [_dword_24508]
		mov	[di+4],	eax
		mov	eax, [_dword_244E4]
		sub	eax, [_dword_244FC]
		add	eax, [_dword_24504]
		mov	[si], eax
		mov	eax, [_dword_24500]
		sub	eax, [_dword_244E8]
		add	eax, [_dword_24508]
		mov	[si+4],	eax
		mov	eax, [_dword_244C8]
		mov	[dword ptr unk_244C4], eax
		mov	eax, [_multip_244CC]
		imul	[_dword_244C8]
		shrd	eax, edx, 10h
		add	[_dword_244C8], eax
		mov	eax, [_dword_244D4]
		imul	[_multip_244D0]
		shrd	eax, edx, 10h
		sub	[_dword_244C8], eax
		mov	eax, [_dword_244D4]
		imul	[_multip_244CC]
		shrd	eax, edx, 10h
		add	[_dword_244D4], eax
		mov	eax, [dword ptr	unk_244C4]
		imul	[_multip_244D0]
		shrd	eax, edx, 10h
		add	[_dword_244D4], eax
		pop	ax
		pop	cx
		inc	ax
		dec	cx
		jnz	loc_1B0CF
		mov	si, [_word_2450E]
		mov	eax, [si]
		mov	ebx, [si+4]
		add	[si], ebx
		sub	eax, ebx
		mov	[si+4],	eax
		retn
; ---------------------------------------------------------------------------

loc_1B240:				; CODE XREF: _spectr_1B084+8j
		mov	ax, [_word_24514]
		xor	si, si

loc_1B245:				; CODE XREF: _spectr_1B084+1C8j
		add	si, 4
		shr	ax, 1
		test	ax, ax
		jnz	short loc_1B245
		sub	si, 4
		mov	ebx, [_tabledword_24526+si]
		neg	ebx
		mov	[_multip_244D0],	ebx
		mov	eax, [_tabledword_24562+si]
		neg	eax
		mov	[_multip_244CC],	eax
		add	eax, 10000h
		mov	[_dword_244C8], eax
		mov	[_dword_244D4], ebx
		mov	cx, [_word_24514]
		shr	cx, 1
		mov	ax, 2

loc_1B282:				; CODE XREF: _spectr_1B084+357j
		push	cx
		push	ax
		shl	ax, 1
		dec	ax
		mov	di, ax
		neg	ax
		add	ax, 3
		add	ax, [_word_24514]
		add	ax, [_word_24514]
		mov	si, ax
		mov	eax, [_dword_244C8]
		mov	[_dword_244F4], eax
		mov	eax, [_dword_244D4]
		mov	[_dword_244F8], eax
		dec	si
		shl	si, 2
		dec	di
		shl	di, 2
		mov	eax, [di]
		add	eax, [si]
		sar	eax, 1
		mov	[_dword_244E4], eax
		mov	eax, [di+4]
		sub	eax, [si+4]
		sar	eax, 1
		mov	[_dword_244E8], eax
		mov	eax, [di+4]
		add	eax, [si+4]
		neg	eax
		sar	eax, 1
		mov	[_dword_244EC], eax
		mov	eax, [di]
		sub	eax, [si]
		sar	eax, 1
		mov	[_dword_244F0], eax
		mov	ecx, [_dword_244F4]
		mov	eax, [_dword_244EC]
		imul	ecx
		shrd	eax, edx, 10h
		mov	[_dword_244FC], eax
		mov	eax, [_dword_244F0]
		imul	ecx
		shrd	eax, edx, 10h
		mov	[_dword_24500], eax
		mov	ecx, [_dword_244F8]
		mov	eax, [_dword_244EC]
		imul	ecx
		shrd	eax, edx, 10h
		mov	[_dword_24508], eax
		mov	eax, [_dword_244F0]
		imul	ecx
		shrd	eax, edx, 10h
		mov	[_dword_24504], eax
		mov	eax, [_dword_244E4]
		add	eax, [_dword_244FC]
		sub	eax, [_dword_24504]
		mov	[di], eax
		mov	eax, [_dword_244E8]
		add	eax, [_dword_24500]
		add	eax, [_dword_24508]
		mov	[di+4],	eax
		mov	eax, [_dword_244E4]
		sub	eax, [_dword_244FC]
		add	eax, [_dword_24504]
		mov	[si], eax
		mov	eax, [_dword_24500]
		sub	eax, [_dword_244E8]
		add	eax, [_dword_24508]
		mov	[si+4],	eax
		mov	eax, [_dword_244C8]
		mov	[dword ptr unk_244C4], eax
		mov	eax, [_dword_244C8]
		mov	[dword ptr unk_244C4], eax
		mov	eax, [_multip_244CC]
		imul	[_dword_244C8]
		shrd	eax, edx, 10h
		add	[_dword_244C8], eax
		mov	eax, [_dword_244D4]
		imul	[_multip_244D0]
		shrd	eax, edx, 10h
		sub	[_dword_244C8], eax
		mov	eax, [_dword_244D4]
		imul	[_multip_244CC]
		shrd	eax, edx, 10h
		add	[_dword_244D4], eax
		mov	eax, [dword ptr	unk_244C4]
		imul	[_multip_244D0]
		shrd	eax, edx, 10h
		add	[_dword_244D4], eax
		pop	ax
		pop	cx
		inc	ax
		dec	cx
		jnz	loc_1B282
		mov	si, [_word_2450E]
		mov	eax, [si]
		mov	ebx, [si+4]
		mov	ecx, eax
		add	ecx, ebx
		sar	ecx, 1
		mov	[si], ecx
		mov	ecx, eax
		sub	ecx, ebx
		sar	ecx, 1
		mov	[si], ecx
		call	_spectr_1B406
		retn
endp		_spectr_1B084


; =============== S U B	R O U T	I N E =======================================


proc		_spectr_1B406 near	; CODE XREF: _spectr_1B084+Cp
					; _spectr_1B084+37Ep ...
		mov	[_word_2450E], di
		mov	[_word_2450C], 0
		mov	cx, [_word_24520]
		shl	cx, 1
		mov	[_word_24522], cx
		mov	si, [_word_2450E]
		shr	cx, 1
		mov	di, [_word_2450E]
		mov	bp, di

loc_1B426:				; CODE XREF: _spectr_1B406+5Fj
		push	cx
		cmp	si, di
		jle	short loc_1B440
		mov	edx, [si]
		mov	ebx, [si+4]
		xchg	edx, [di]
		xchg	ebx, [di+4]
		mov	[si], edx
		mov	[si+4],	ebx

loc_1B440:				; CODE XREF: _spectr_1B406+23j
		sub	si, bp
		shr	si, 2
		mov	ax, [_word_24522]
		shr	ax, 1

loc_1B44A:				; CODE XREF: _spectr_1B406+51j
		cmp	ax, 2
		jl	short loc_1B459
		cmp	si, ax
		jl	short loc_1B459
		sub	si, ax
		shr	ax, 1
		jmp	short loc_1B44A
; ---------------------------------------------------------------------------

loc_1B459:				; CODE XREF: _spectr_1B406+47j
					; _spectr_1B406+4Bj
		add	si, ax
		shl	si, 2
		add	si, bp
		pop	cx
		add	di, 8
		dec	cx
		jnz	short loc_1B426
		mov	[_word_24516], 2

loc_1B46D:				; CODE XREF: _spectr_1B406+1BEj
		mov	ax, [_word_24516]
		cmp	[_word_24522], ax
		jle	locret_1B5C7
		shl	ax, 1
		mov	[_word_2451C], ax
		mov	si, [_word_2450C]
		mov	eax, [_tabledword_24526+si]
		mov	[_multip_244D0],	eax
		mov	eax, [_tabledword_24562+si]
		mov	[_multip_244CC],	eax
		add	[_word_2450C], 4
		mov	[_dword_244C8], 10000h
		mov	[_dword_244D4], 0
		mov	cx, [_word_24516]
		shr	cx, 1
		mov	ax, 1

loc_1B4B3:				; CODE XREF: _spectr_1B406+1B4j
		push	cx
		push	ax
		shl	ax, 1
		dec	ax
		mov	[_word_24518], ax
		mov	ax, [_word_24522]
		sub	ax, [_word_24518]
		cwd
		idiv	[_word_2451C]
		mov	cx, ax
		inc	cx
		mov	ax, 0

loc_1B4CD:				; CODE XREF: _spectr_1B406+156j
		push	cx
		push	ax
		imul	[_word_2451C]
		add	ax, [_word_24518]
		mov	[_word_2451E], ax
		add	ax, [_word_24516]
		mov	[_word_2451A], ax
		mov	si, [_word_2451A]
		dec	si
		shl	si, 2
		add	si, [_word_2450E]
		mov	di, [_word_2451E]
		dec	di
		shl	di, 2
		add	di, [_word_2450E]
		mov	ecx, [_dword_244C8]
		mov	ebp, [_dword_244D4]
		mov	eax, [si]
		imul	ecx
		shrd	eax, edx, 10h
		mov	ebx, eax
		mov	eax, [si+4]
		imul	ebp
		shrd	eax, edx, 10h
		sub	ebx, eax
		mov	eax, [si+4]
		imul	ecx
		shrd	eax, edx, 10h
		mov	ecx, eax
		mov	eax, [si]
		imul	ebp
		shrd	eax, edx, 10h
		add	ecx, eax
		mov	eax, [di]
		sub	eax, ebx
		mov	[si], eax
		mov	eax, [di+4]
		sub	eax, ecx
		mov	[si+4],	eax
		add	[di], ebx
		add	[di+4],	ecx
		pop	ax
		pop	cx
		inc	ax
		dec	cx
		jnz	loc_1B4CD
		mov	ecx, [_multip_244CC]
		mov	ebp, [_multip_244D0]
		mov	eax, [_dword_244C8]
		mov	[dword ptr unk_244C4], eax
		mov	eax, [_dword_244C8]
		imul	ecx
		shrd	eax, edx, 10h
		add	[_dword_244C8], eax
		mov	eax, [_dword_244D4]
		imul	ebp
		shrd	eax, edx, 10h
		sub	[_dword_244C8], eax
		mov	eax, [_dword_244D4]
		imul	ecx
		shrd	eax, edx, 10h
		add	[_dword_244D4], eax
		mov	eax, [dword ptr	unk_244C4]
		imul	ebp
		shrd	eax, edx, 10h
		add	[_dword_244D4], eax
		pop	ax
		pop	cx
		inc	ax
		dec	cx
		jnz	loc_1B4B3
		mov	ax, [_word_2451C]
		mov	[_word_24516], ax
		jmp	loc_1B46D
; ---------------------------------------------------------------------------

locret_1B5C7:				; CODE XREF: _spectr_1B406+6Ej
		retn
endp		_spectr_1B406


; =============== S U B	R O U T	I N E =======================================


proc		_f5_draw_spectr near	; DATA XREF: _f5_graphspectr+6o
					; _f5_graphspectr+Co
		mov	ax, ds
		mov	es, ax
		mov	di, offset _buffer_1 ; 2800h
		mov	cx, 200h
		mov	ax, 4001h
		call	_volume_prep
		lfs	bx, [_segfsbx_1DE28]
		mov	si, offset _buffer_1 ; 2800h
		mov	di, offset _byte_24204
		mov	bp, [_amount_of_x]

loc_1B5EC:				; CODE XREF: _f5_draw_spectr+2A1j
		mov	cx, bp
		xor	dx, dx
		cmp	[byte ptr fs:bx+3Ah], 64
		ja	short loc_1B5FC
		mov	al, [si]
		cbw
		add	dx, ax

loc_1B5FC:				; CODE XREF: _f5_draw_spectr+2Dj
		dec	cx
		jz	loc_1B85F
		cmp	[byte ptr fs:bx+8Ah], 64
		ja	short loc_1B610
		mov	al, [si+200h]
		cbw
		add	dx, ax

loc_1B610:				; CODE XREF: _f5_draw_spectr+3Fj
		dec	cx
		jz	loc_1B85F
		cmp	[byte ptr fs:bx+0DAh], 64
		ja	short loc_1B624
		mov	al, [si+400h]
		cbw
		add	dx, ax

loc_1B624:				; CODE XREF: _f5_draw_spectr+53j
		dec	cx
		jz	loc_1B85F
		cmp	[byte ptr fs:bx+12Ah], 64
		ja	short loc_1B638
		mov	al, [si+600h]
		cbw
		add	dx, ax

loc_1B638:				; CODE XREF: _f5_draw_spectr+67j
		dec	cx
		jz	loc_1B85F
		cmp	[byte ptr fs:bx+17Ah], 64
		ja	short loc_1B64C
		mov	al, [si+800h]
		cbw
		add	dx, ax

loc_1B64C:				; CODE XREF: _f5_draw_spectr+7Bj
		dec	cx
		jz	loc_1B85F
		cmp	[byte ptr fs:bx+1CAh], 64
		ja	short loc_1B660
		mov	al, [si+0A00h]
		cbw
		add	dx, ax

loc_1B660:				; CODE XREF: _f5_draw_spectr+8Fj
		dec	cx
		jz	loc_1B85F
		cmp	[byte ptr fs:bx+21Ah], 64
		ja	short loc_1B674
		mov	al, [si+0C00h]
		cbw
		add	dx, ax

loc_1B674:				; CODE XREF: _f5_draw_spectr+A3j
		dec	cx
		jz	loc_1B85F
		cmp	[byte ptr fs:bx+26Ah], 64
		ja	short loc_1B688
		mov	al, [si+0E00h]
		cbw
		add	dx, ax

loc_1B688:				; CODE XREF: _f5_draw_spectr+B7j
		dec	cx
		jz	loc_1B85F
		cmp	[byte ptr fs:bx+2BAh], 64
		ja	short loc_1B69C
		mov	al, [si+1000h]
		cbw
		add	dx, ax

loc_1B69C:				; CODE XREF: _f5_draw_spectr+CBj
		dec	cx
		jz	loc_1B85F
		cmp	[byte ptr fs:bx+30Ah], 64
		ja	short loc_1B6B0
		mov	al, [si+1200h]
		cbw
		add	dx, ax

loc_1B6B0:				; CODE XREF: _f5_draw_spectr+DFj
		dec	cx
		jz	loc_1B85F
		cmp	[byte ptr fs:bx+35Ah], 64
		ja	short loc_1B6C4
		mov	al, [si+1400h]
		cbw
		add	dx, ax

loc_1B6C4:				; CODE XREF: _f5_draw_spectr+F3j
		dec	cx
		jz	loc_1B85F
		cmp	[byte ptr fs:bx+3AAh], 64
		ja	short loc_1B6D8
		mov	al, [si+1600h]
		cbw
		add	dx, ax

loc_1B6D8:				; CODE XREF: _f5_draw_spectr+107j
		dec	cx
		jz	loc_1B85F
		cmp	[byte ptr fs:bx+3FAh], 64
		ja	short loc_1B6EC
		mov	al, [si+1800h]
		cbw
		add	dx, ax

loc_1B6EC:				; CODE XREF: _f5_draw_spectr+11Bj
		dec	cx
		jz	loc_1B85F
		cmp	[byte ptr fs:bx+44Ah], 64
		ja	short loc_1B700
		mov	al, [si+1A00h]
		cbw
		add	dx, ax

loc_1B700:				; CODE XREF: _f5_draw_spectr+12Fj
		dec	cx
		jz	loc_1B85F
		cmp	[byte ptr fs:bx+49Ah], 64
		ja	short loc_1B714
		mov	al, [si+1C00h]
		cbw
		add	dx, ax

loc_1B714:				; CODE XREF: _f5_draw_spectr+143j
		dec	cx
		jz	loc_1B85F
		cmp	[byte ptr fs:bx+4EAh], 40h ; '@'
		ja	short loc_1B728
		mov	al, [si+1E00h]
		cbw
		add	dx, ax

loc_1B728:				; CODE XREF: _f5_draw_spectr+157j
		dec	cx
		jz	loc_1B85F
		cmp	[byte ptr fs:bx+53Ah], 40h ; '@'
		ja	short loc_1B73C
		mov	al, [si+2000h]
		cbw
		add	dx, ax

loc_1B73C:				; CODE XREF: _f5_draw_spectr+16Bj
		dec	cx
		jz	loc_1B85F
		cmp	[byte ptr fs:bx+58Ah], 40h ; '@'
		ja	short loc_1B750
		mov	al, [si+2200h]
		cbw
		add	dx, ax

loc_1B750:				; CODE XREF: _f5_draw_spectr+17Fj
		dec	cx
		jz	loc_1B85F
		cmp	[byte ptr fs:bx+5DAh], 40h ; '@'
		ja	short loc_1B764
		mov	al, [si+2400h]
		cbw
		add	dx, ax

loc_1B764:				; CODE XREF: _f5_draw_spectr+193j
		dec	cx
		jz	loc_1B85F
		cmp	[byte ptr fs:bx+62Ah], 40h ; '@'
		ja	short loc_1B778
		mov	al, [si+2600h]
		cbw
		add	dx, ax

loc_1B778:				; CODE XREF: _f5_draw_spectr+1A7j
		dec	cx
		jz	loc_1B85F
		cmp	[byte ptr fs:bx+67Ah], 40h ; '@'
		ja	short loc_1B78C
		mov	al, [si+2800h]
		cbw
		add	dx, ax

loc_1B78C:				; CODE XREF: _f5_draw_spectr+1BBj
		dec	cx
		jz	loc_1B85F
		cmp	[byte ptr fs:bx+6CAh], 40h ; '@'
		ja	short loc_1B7A0
		mov	al, [si+2A00h]
		cbw
		add	dx, ax

loc_1B7A0:				; CODE XREF: _f5_draw_spectr+1CFj
		dec	cx
		jz	loc_1B85F
		cmp	[byte ptr fs:bx+71Ah], 40h ; '@'
		ja	short loc_1B7B4
		mov	al, [si+2C00h]
		cbw
		add	dx, ax

loc_1B7B4:				; CODE XREF: _f5_draw_spectr+1E3j
		dec	cx
		jz	loc_1B85F
		cmp	[byte ptr fs:bx+76Ah], 40h ; '@'
		ja	short loc_1B7C8
		mov	al, [si+2E00h]
		cbw
		add	dx, ax

loc_1B7C8:				; CODE XREF: _f5_draw_spectr+1F7j
		dec	cx
		jz	loc_1B85F
		cmp	[byte ptr fs:bx+7BAh], 40h ; '@'
		ja	short loc_1B7DC
		mov	al, [si+3000h]
		cbw
		add	dx, ax

loc_1B7DC:				; CODE XREF: _f5_draw_spectr+20Bj
		dec	cx
		jz	loc_1B85F
		cmp	[byte ptr fs:bx+80Ah], 40h ; '@'
		ja	short loc_1B7F0
		mov	al, [si+3200h]
		cbw
		add	dx, ax

loc_1B7F0:				; CODE XREF: _f5_draw_spectr+21Fj
		dec	cx
		jz	short loc_1B85F
		cmp	[byte ptr fs:bx+85Ah], 40h ; '@'
		ja	short loc_1B802
		mov	al, [si+3400h]
		cbw
		add	dx, ax

loc_1B802:				; CODE XREF: _f5_draw_spectr+231j
		dec	cx
		jz	short loc_1B85F
		cmp	[byte ptr fs:bx+8AAh], 40h ; '@'
		ja	short loc_1B814
		mov	al, [si+3600h]
		cbw
		add	dx, ax

loc_1B814:				; CODE XREF: _f5_draw_spectr+243j
		dec	cx
		jz	short loc_1B85F
		cmp	[byte ptr fs:bx+8FAh], 40h ; '@'
		ja	short loc_1B826
		mov	al, [si+3800h]
		cbw
		add	dx, ax

loc_1B826:				; CODE XREF: _f5_draw_spectr+255j
		dec	cx
		jz	short loc_1B85F
		cmp	[byte ptr fs:bx+94Ah], 40h ; '@'
		ja	short loc_1B838
		mov	al, [si+3A00h]
		cbw
		add	dx, ax

loc_1B838:				; CODE XREF: _f5_draw_spectr+267j
		dec	cx
		jz	short loc_1B85F
		cmp	[byte ptr fs:bx+99Ah], 40h ; '@'
		ja	short loc_1B84A
		mov	al, [si+3C00h]
		cbw
		add	dx, ax

loc_1B84A:				; CODE XREF: _f5_draw_spectr+279j
		dec	cx
		jz	short loc_1B85F
		cmp	[byte ptr fs:bx+9EAh], 40h ; '@'
		ja	short loc_1B85C
		mov	al, [si+3E00h]
		cbw
		add	dx, ax

loc_1B85C:				; CODE XREF: _f5_draw_spectr+28Bj
		dec	cx
		jz	short $+2

loc_1B85F:				; CODE XREF: _f5_draw_spectr+35j
					; _f5_draw_spectr+49j ...
		sar	dx, 1
		mov	[di], dl
		inc	si
		inc	di
		cmp	si, offset _byte_1E0E0
		jb	loc_1B5EC
		mov	si, offset _byte_24204
		mov	di, offset _byte_22EE4
		mov	cx, 200h

loc_1B876:				; CODE XREF: _f5_draw_spectr+2C5j
		movsx	eax, [byte ptr si]
		shl	eax, 10h
		mov	[di], eax
		mov	[dword ptr di+4], 0
		inc	si
		add	di, 8
		loop	loc_1B876
		mov	ax, [_word_24524]
		mov	[_word_24520], ax
		mov	[_word_24514], ax
		mov	di, offset _byte_22EE4
		call	_spectr_1B406
		mov	si, offset _byte_22EE4
		mov	di, offset unk_23EE4
		mov	cx, 64h	; 'd'
		call	_spectr_1BBC1
		lfs	bx, [_segfsbx_1DE28]
		mov	si, offset _buffer_1 ; 2800h
		mov	di, offset _byte_24204
		mov	bp, [_amount_of_x]

loc_1B8BC:				; CODE XREF: _f5_draw_spectr+571j
		mov	cx, bp
		xor	dx, dx
		cmp	[byte ptr fs:bx+3Ah], 40h ; '@'
		jb	short loc_1B8CC
		mov	al, [si]
		cbw
		add	dx, ax

loc_1B8CC:				; CODE XREF: _f5_draw_spectr+2FDj
		dec	cx
		jz	loc_1BB2F
		cmp	[byte ptr fs:bx+8Ah], 40h ; '@'
		jb	short loc_1B8E0
		mov	al, [si+200h]
		cbw
		add	dx, ax

loc_1B8E0:				; CODE XREF: _f5_draw_spectr+30Fj
		dec	cx
		jz	loc_1BB2F
		cmp	[byte ptr fs:bx+0DAh], 40h ; '@'
		jb	short loc_1B8F4
		mov	al, [si+400h]
		cbw
		add	dx, ax

loc_1B8F4:				; CODE XREF: _f5_draw_spectr+323j
		dec	cx
		jz	loc_1BB2F
		cmp	[byte ptr fs:bx+12Ah], 40h ; '@'
		jb	short loc_1B908
		mov	al, [si+600h]
		cbw
		add	dx, ax

loc_1B908:				; CODE XREF: _f5_draw_spectr+337j
		dec	cx
		jz	loc_1BB2F
		cmp	[byte ptr fs:bx+17Ah], 40h ; '@'
		jb	short loc_1B91C
		mov	al, [si+800h]
		cbw
		add	dx, ax

loc_1B91C:				; CODE XREF: _f5_draw_spectr+34Bj
		dec	cx
		jz	loc_1BB2F
		cmp	[byte ptr fs:bx+1CAh], 40h ; '@'
		jb	short loc_1B930
		mov	al, [si+0A00h]
		cbw
		add	dx, ax

loc_1B930:				; CODE XREF: _f5_draw_spectr+35Fj
		dec	cx
		jz	loc_1BB2F
		cmp	[byte ptr fs:bx+21Ah], 40h ; '@'
		jb	short loc_1B944
		mov	al, [si+0C00h]
		cbw
		add	dx, ax

loc_1B944:				; CODE XREF: _f5_draw_spectr+373j
		dec	cx
		jz	loc_1BB2F
		cmp	[byte ptr fs:bx+26Ah], 40h ; '@'
		jb	short loc_1B958
		mov	al, [si+0E00h]
		cbw
		add	dx, ax

loc_1B958:				; CODE XREF: _f5_draw_spectr+387j
		dec	cx
		jz	loc_1BB2F
		cmp	[byte ptr fs:bx+2BAh], 40h ; '@'
		jb	short loc_1B96C
		mov	al, [si+1000h]
		cbw
		add	dx, ax

loc_1B96C:				; CODE XREF: _f5_draw_spectr+39Bj
		dec	cx
		jz	loc_1BB2F
		cmp	[byte ptr fs:bx+30Ah], 40h ; '@'
		jb	short loc_1B980
		mov	al, [si+1200h]
		cbw
		add	dx, ax

loc_1B980:				; CODE XREF: _f5_draw_spectr+3AFj
		dec	cx
		jz	loc_1BB2F
		cmp	[byte ptr fs:bx+35Ah], 40h ; '@'
		jb	short loc_1B994
		mov	al, [si+1400h]
		cbw
		add	dx, ax

loc_1B994:				; CODE XREF: _f5_draw_spectr+3C3j
		dec	cx
		jz	loc_1BB2F
		cmp	[byte ptr fs:bx+3AAh], 40h ; '@'
		jb	short loc_1B9A8
		mov	al, [si+1600h]
		cbw
		add	dx, ax

loc_1B9A8:				; CODE XREF: _f5_draw_spectr+3D7j
		dec	cx
		jz	loc_1BB2F
		cmp	[byte ptr fs:bx+3FAh], 40h ; '@'
		jb	short loc_1B9BC
		mov	al, [si+1800h]
		cbw
		add	dx, ax

loc_1B9BC:				; CODE XREF: _f5_draw_spectr+3EBj
		dec	cx
		jz	loc_1BB2F
		cmp	[byte ptr fs:bx+44Ah], 40h ; '@'
		jb	short loc_1B9D0
		mov	al, [si+1A00h]
		cbw
		add	dx, ax

loc_1B9D0:				; CODE XREF: _f5_draw_spectr+3FFj
		dec	cx
		jz	loc_1BB2F
		cmp	[byte ptr fs:bx+49Ah], 40h ; '@'
		jb	short loc_1B9E4
		mov	al, [si+1C00h]
		cbw
		add	dx, ax

loc_1B9E4:				; CODE XREF: _f5_draw_spectr+413j
		dec	cx
		jz	loc_1BB2F
		cmp	[byte ptr fs:bx+4EAh], 40h ; '@'
		jb	short loc_1B9F8
		mov	al, [si+1E00h]
		cbw
		add	dx, ax

loc_1B9F8:				; CODE XREF: _f5_draw_spectr+427j
		dec	cx
		jz	loc_1BB2F
		cmp	[byte ptr fs:bx+53Ah], 40h ; '@'
		jb	short loc_1BA0C
		mov	al, [si+2000h]
		cbw
		add	dx, ax

loc_1BA0C:				; CODE XREF: _f5_draw_spectr+43Bj
		dec	cx
		jz	loc_1BB2F
		cmp	[byte ptr fs:bx+58Ah], 40h ; '@'
		jb	short loc_1BA20
		mov	al, [si+2200h]
		cbw
		add	dx, ax

loc_1BA20:				; CODE XREF: _f5_draw_spectr+44Fj
		dec	cx
		jz	loc_1BB2F
		cmp	[byte ptr fs:bx+5DAh], 40h ; '@'
		jb	short loc_1BA34
		mov	al, [si+2400h]
		cbw
		add	dx, ax

loc_1BA34:				; CODE XREF: _f5_draw_spectr+463j
		dec	cx
		jz	loc_1BB2F
		cmp	[byte ptr fs:bx+62Ah], 40h ; '@'
		jb	short loc_1BA48
		mov	al, [si+2600h]
		cbw
		add	dx, ax

loc_1BA48:				; CODE XREF: _f5_draw_spectr+477j
		dec	cx
		jz	loc_1BB2F
		cmp	[byte ptr fs:bx+67Ah], 40h ; '@'
		jb	short loc_1BA5C
		mov	al, [si+2800h]
		cbw
		add	dx, ax

loc_1BA5C:				; CODE XREF: _f5_draw_spectr+48Bj
		dec	cx
		jz	loc_1BB2F
		cmp	[byte ptr fs:bx+6CAh], 40h ; '@'
		jb	short loc_1BA70
		mov	al, [si+2A00h]
		cbw
		add	dx, ax

loc_1BA70:				; CODE XREF: _f5_draw_spectr+49Fj
		dec	cx
		jz	loc_1BB2F
		cmp	[byte ptr fs:bx+71Ah], 40h ; '@'
		jb	short loc_1BA84
		mov	al, [si+2C00h]
		cbw
		add	dx, ax

loc_1BA84:				; CODE XREF: _f5_draw_spectr+4B3j
		dec	cx
		jz	loc_1BB2F
		cmp	[byte ptr fs:bx+76Ah], 40h ; '@'
		jb	short loc_1BA98
		mov	al, [si+2E00h]
		cbw
		add	dx, ax

loc_1BA98:				; CODE XREF: _f5_draw_spectr+4C7j
		dec	cx
		jz	loc_1BB2F
		cmp	[byte ptr fs:bx+7BAh], 40h ; '@'
		jb	short loc_1BAAC
		mov	al, [si+3000h]
		cbw
		add	dx, ax

loc_1BAAC:				; CODE XREF: _f5_draw_spectr+4DBj
		dec	cx
		jz	loc_1BB2F
		cmp	[byte ptr fs:bx+80Ah], 40h ; '@'
		jb	short loc_1BAC0
		mov	al, [si+3200h]
		cbw
		add	dx, ax

loc_1BAC0:				; CODE XREF: _f5_draw_spectr+4EFj
		dec	cx
		jz	short loc_1BB2F
		cmp	[byte ptr fs:bx+85Ah], 40h ; '@'
		jb	short loc_1BAD2
		mov	al, [si+3400h]
		cbw
		add	dx, ax

loc_1BAD2:				; CODE XREF: _f5_draw_spectr+501j
		dec	cx
		jz	short loc_1BB2F
		cmp	[byte ptr fs:bx+8AAh], 40h ; '@'
		jb	short loc_1BAE4
		mov	al, [si+3600h]
		cbw
		add	dx, ax

loc_1BAE4:				; CODE XREF: _f5_draw_spectr+513j
		dec	cx
		jz	short loc_1BB2F
		cmp	[byte ptr fs:bx+8FAh], 40h ; '@'
		jb	short loc_1BAF6
		mov	al, [si+3800h]
		cbw
		add	dx, ax

loc_1BAF6:				; CODE XREF: _f5_draw_spectr+525j
		dec	cx
		jz	short loc_1BB2F
		cmp	[byte ptr fs:bx+94Ah], 40h ; '@'
		jb	short loc_1BB08
		mov	al, [si+3A00h]
		cbw
		add	dx, ax

loc_1BB08:				; CODE XREF: _f5_draw_spectr+537j
		dec	cx
		jz	short loc_1BB2F
		cmp	[byte ptr fs:bx+99Ah], 40h ; '@'
		jb	short loc_1BB1A
		mov	al, [si+3C00h]
		cbw
		add	dx, ax

loc_1BB1A:				; CODE XREF: _f5_draw_spectr+549j
		dec	cx
		jz	short loc_1BB2F
		cmp	[byte ptr fs:bx+9EAh], 40h ; '@'
		jb	short loc_1BB2C
		mov	al, [si+3E00h]
		cbw
		add	dx, ax

loc_1BB2C:				; CODE XREF: _f5_draw_spectr+55Bj
		dec	cx
		jz	short $+2

loc_1BB2F:				; CODE XREF: _f5_draw_spectr+305j
					; _f5_draw_spectr+319j ...
		sar	dx, 1
		mov	[di], dl
		inc	si
		inc	di
		cmp	si, offset _byte_1E0E0
		jb	loc_1B8BC
		mov	si, offset _byte_24204
		mov	di, offset _byte_22EE4
		mov	cx, 200h

loc_1BB46:				; CODE XREF: _f5_draw_spectr+595j
		movsx	eax, [byte ptr si]
		shl	eax, 10h
		mov	[di], eax
		mov	[dword ptr di+4], 0
		inc	si
		add	di, 8
		loop	loc_1BB46
		mov	ax, [_word_24524]
		mov	[_word_24520], ax
		mov	[_word_24514], ax
		mov	di, offset _byte_22EE4
		call	_spectr_1B406
		mov	si, offset _byte_22EE4
		mov	di, offset unk_24074
		mov	cx, 64h	; 'd'
		call	_spectr_1BBC1
		mov	ax, 0A000h
		mov	es, ax
		assume es:nothing
		mov	bx, offset unk_23EE4
		mov	bp, 7BC4h
		call	_spectr_1BCE9
		mov	bx, offset _byte_23EE5
		mov	bp, 7BD6h
		call	_spectr_1BC2D
		mov	bx, offset unk_24074
		mov	bp, 0F8C4h
		call	_spectr_1BCE9
		mov	bx, offset _byte_24075
		mov	bp, 0F8D6h
		call	_spectr_1BC2D
		mov	ax, ds
		mov	es, ax
		assume es:dseg
		mov	si, offset unk_23EE4
		mov	di, offset _byte_23F48
		mov	cx, 19h
		cld
		rep movsd
		mov	si, offset unk_24074
		mov	di, offset _byte_240D8
		mov	cx, 19h
		rep movsd
		retn
endp		_f5_draw_spectr


; =============== S U B	R O U T	I N E =======================================


proc		_spectr_1BBC1 near	; CODE XREF: _f5_draw_spectr+2DFp
					; _f5_draw_spectr+5AFp ...
		push	cx
		mov	eax, [si]
		imul	eax
		mov	ebx, eax
		mov	ecx, edx
		mov	eax, [si+4]
		imul	eax
		mov	eax, edx
		add	eax, ebx
		adc	edx, ecx
		mov	eax, edx
		mov	cl, [_byte_1DE81]
		sar	eax, cl
		mov	ebx, eax
		call	_spectr_1C4F8
		or	ah, ah
		jz	short loc_1BBF4
		mov	al, 0FFh

loc_1BBF4:				; CODE XREF: _spectr_1BBC1+2Fj
		cmp	[_byte_1DE82], 0
		jz	short loc_1BC0C
		mov	ah, [di+64h]
		sub	ah, [_byte_1DE82]
		jnb	short loc_1BC06
		xor	ah, ah

loc_1BC06:				; CODE XREF: _spectr_1BBC1+41j
		cmp	ah, al
		jb	short loc_1BC0C
		mov	al, ah

loc_1BC0C:				; CODE XREF: _spectr_1BBC1+38j
					; _spectr_1BBC1+47j
		mov	[di], al
		cmp	[byte ptr di+12Ch], 0
		jz	short loc_1BC1B
		cmp	al, [di+0C8h]
		jb	short loc_1BC24

loc_1BC1B:				; CODE XREF: _spectr_1BBC1+52j
		mov	[di+0C8h], al
		mov	[byte ptr di+12Ch], 14h

loc_1BC24:				; CODE XREF: _spectr_1BBC1+58j
		inc	di
		add	si, 8
		pop	cx
		dec	cx
		jnz	short _spectr_1BBC1
		retn
endp		_spectr_1BBC1


; =============== S U B	R O U T	I N E =======================================


proc		_spectr_1BC2D near	; CODE XREF: _f5_draw_spectr+5C6p
					; _f5_draw_spectr+5D8p
		mov	cx, 99

loc_1BC30:				; CODE XREF: _spectr_1BC2D+B7j
		mov	al, [bx]
		cmp	al, 90
		jb	short loc_1BC38
		mov	al, 90

loc_1BC38:				; CODE XREF: _spectr_1BC2D+7j
		mov	ah, [bx+64h]
		cmp	ah, 90
		jb	short loc_1BC42
		mov	ah, 90

loc_1BC42:				; CODE XREF: _spectr_1BC2D+11j
		cmp	al, ah
		jz	short loc_1BC92
		jb	short loc_1BC70
		movzx	dx, ah
		shl	dx, 6
		mov	di, dx
		shl	dx, 2
		add	di, dx
		neg	di
		add	di, bp
		mov	dl, al
		sub	dl, ah
		mov	al, ah

loc_1BC5F:				; CODE XREF: _spectr_1BC2D+3Fj
		mov	[es:di], ax
		inc	al
		inc	ah
		sub	di, 140h
		dec	dl
		jnz	short loc_1BC5F
		jmp	short loc_1BC92
; ---------------------------------------------------------------------------

loc_1BC70:				; CODE XREF: _spectr_1BC2D+19j
		movzx	dx, al
		shl	dx, 6
		mov	di, dx
		shl	dx, 2
		add	di, dx
		neg	di
		add	di, bp
		mov	dl, ah
		sub	dl, al
		xor	ax, ax

loc_1BC87:				; CODE XREF: _spectr_1BC2D+63j
		mov	[es:di], ax
		sub	di, 140h
		dec	dl
		jnz	short loc_1BC87

loc_1BC92:				; CODE XREF: _spectr_1BC2D+17j
					; _spectr_1BC2D+41j
		cmp	[byte ptr bx+12Ch], 0
		jz	short loc_1BCDF
		dec	[byte ptr bx+12Ch]
		jnz	short loc_1BCC0
		movzx	dx, [byte ptr bx+0C8h]
		cmp	dl, 5Ah	; 'Z'
		jb	short loc_1BCAB
		mov	dl, 5Ah	; 'Z'

loc_1BCAB:				; CODE XREF: _spectr_1BC2D+7Aj
		shl	dx, 6
		mov	di, dx
		shl	dx, 2
		add	di, dx
		neg	di

loc_1BCB7:
		add	di, bp
		mov	[word ptr es:di], 0
		jmp	short loc_1BCDF
; ---------------------------------------------------------------------------

loc_1BCC0:				; CODE XREF: _spectr_1BC2D+70j
		movzx	dx, [byte ptr bx+0C8h]
		cmp	dl, 5Ah	; 'Z'
		jb	short loc_1BCCC
		mov	dl, 5Ah	; 'Z'

loc_1BCCC:				; CODE XREF: _spectr_1BC2D+9Bj
		shl	dx, 6
		mov	di, dx
		shl	dx, 2
		add	di, dx
		neg	di
		add	di, bp
		mov	[word ptr es:di], 0FEFEh

loc_1BCDF:				; CODE XREF: _spectr_1BC2D+6Aj
					; _spectr_1BC2D+91j
		inc	bx
		add	bp, 3
		dec	cx
		jnz	loc_1BC30
		retn
endp		_spectr_1BC2D


; =============== S U B	R O U T	I N E =======================================


proc		_spectr_1BCE9 near	; CODE XREF: _f5_draw_spectr+5BDp
					; _f5_draw_spectr+5CFp
		mov	al, [bx]
		cmp	al, 90
		jb	short loc_1BCF1
		mov	al, 90

loc_1BCF1:				; CODE XREF: _spectr_1BCE9+4j
		mov	ah, [bx+64h]
		cmp	ah, 90
		jb	short loc_1BCFB
		mov	ah, 90

loc_1BCFB:				; CODE XREF: _spectr_1BCE9+Ej
		cmp	al, ah
		jz	short locret_1BD67
		jb	short loc_1BD3E
		movzx	dx, ah
		shl	dx, 6
		mov	di, dx
		shl	dx, 2
		add	di, dx
		neg	di
		add	di, bp
		mov	dl, al
		sub	dl, ah
		shr	ah, 1
		mov	eax, 0FCFCFCFCh
		jnb	short loc_1BD26
		or	eax, 1010101h

loc_1BD26:				; CODE XREF: _spectr_1BCE9+35j
					; _spectr_1BCE9+52j
		mov	[es:di], eax
		mov	[es:di+4], eax
		sub	di, 140h
		xor	eax, 1010101h
		dec	dl
		jnz	short loc_1BD26
		retn
; ---------------------------------------------------------------------------

loc_1BD3E:				; CODE XREF: _spectr_1BCE9+16j
		movzx	dx, al
		shl	dx, 6
		mov	di, dx
		shl	dx, 2
		add	di, dx
		neg	di
		add	di, bp
		mov	dl, ah
		sub	dl, al
		xor	eax, eax

loc_1BD56:				; CODE XREF: _spectr_1BCE9+7Cj
		mov	[es:di], eax
		mov	[es:di+4], eax
		sub	di, 140h
		dec	dl
		jnz	short loc_1BD56

locret_1BD67:				; CODE XREF: _spectr_1BCE9+14j
		retn
endp		_spectr_1BCE9

; ---------------------------------------------------------------------------

_f6_draw:				; DATA XREF: _f6_undoc+6o
		call	_txt_draw_bottom
		lfs	bx, [_segfsbx_1DE28]
		les	di, [_videomempointer]
		assume es:nothing
		add	di, 3C4h
		mov	cx, [_amount_of_x]
		cmp	cx, [_word_1DE6E]

loc_1BD80:
		jbe	short loc_1BD86
		mov	cx, [_word_1DE6E]

loc_1BD86:				; CODE XREF: seg001:loc_1BD80j
		xor	ax, ax

loc_1BD88:				; CODE XREF: seg001:2DDCj
		push	ax
		push	cx
		push	di
		mov	dl, al
		add	al, 31h	; '1'
		cmp	al, 39h	; '9'
		jbe	short loc_1BD95
		add	al, 7

loc_1BD95:				; CODE XREF: seg001:2D41j
		mov	ah, 1Eh
		cmp	dl, [_byte_1DE84]
		jz	short loc_1BD9F
		mov	ah, 7Eh	; '~'

loc_1BD9F:				; CODE XREF: seg001:2D4Bj
		mov	[es:di+2], ax
		mov	al, 20h	; ' '
		mov	[es:di], ax
		mov	[es:di+4], ax
		add	di, 6
		mov	si, offset _buffer_1 ; 2800h
		mov	eax, 0C4C4C4C4h
		mov	[word ptr si], 2020h
		mov	[si+2],	eax
		mov	[si+6],	eax
		mov	[si+0Ah], eax
		mov	[si+0Eh], eax
		mov	[word ptr si+12h], 20C4h
		lea	bp, [si+14h]
		mov	al, [fs:bx+3Ah]
		mov	dl, al
		shr	al, 3
		and	ax, 1Fh
		add	si, 2
		add	si, ax
		mov	al, 4Dh	; 'M'
		cmp	dl, 40h	; '@'
		jz	short loc_1BDF2
		mov	al, 4Ch	; 'L'
		jb	short loc_1BDF2
		mov	al, 52h	; 'R'

loc_1BDF2:				; CODE XREF: seg001:2D9Aj seg001:2D9Ej
		mov	[si], al
		mov	si, bp
		mov	[dword ptr si],	20202020h
		cld
		mov	al, [fs:bx+3Ah]
		sub	al, 40h	; '@'
		js	short loc_1BE07
		inc	si

loc_1BE07:				; CODE XREF: seg001:2DB4j
		cmp	al, 0F7h ; '÷'
		jl	short loc_1BE10
		cmp	al, 9
		jg	short loc_1BE10
		inc	si

loc_1BE10:				; CODE XREF: seg001:2DB9j seg001:2DBDj
		push	bx
		call	_my_i8toa10
		pop	bx
		mov	[byte ptr si], 0
		mov	si, offset _buffer_1 ; 2800h
		mov	ah, 7Eh	; '~'
		call	_put_message
		pop	di
		pop	cx
		pop	ax
		add	di, 0A0h ; ' '
		add	bx, 50h	; 'P'
		inc	ax
		dec	cx
		jnz	loc_1BD88
		retn
; ---------------------------------------------------------------------------
		push	ax
		shr	al, 4
		call	_hex_1BE39
		pop	ax

; =============== S U B	R O U T	I N E =======================================


proc		_hex_1BE39 near		; CODE XREF: seg001:2DE5p
		and	al, 0Fh
		or	al, 30h
		cmp	al, 39h	; '9'
		jbe	short loc_1BE43
		add	al, 7

loc_1BE43:				; CODE XREF: _hex_1BE39+6j
		mov	[es:di], ax
		add	di, 2
		retn
endp		_hex_1BE39


; =============== S U B	R O U T	I N E =======================================

; Attributes: bp-based frame




; =============== S U B	R O U T	I N E =======================================


; int __usercall _message_1BE77<eax>(char *_msg<esi>)
proc		_message_1BE77 near	; CODE XREF: _start+2FDp _start+420p ...
		push	ax
		push	si
		mov	ch, al
		sub	ch, 2
		mov	dh, al
		add	dh, 2
		mov	ah, 0FFh

loc_1BE85:				; CODE XREF: _message_1BE77+15j
		mov	al, [si]
		inc	ah
		inc	si
		or	al, al
		jnz	short loc_1BE85
		mov	cl, 4Eh	; 'N'
		sub	cl, ah
		shr	ah, 1
		mov	dl, 2Ah	; '*'
		add	dl, ah
		mov	al, ch
		inc	al
		mov	ah, 0A0h ; ' '
		mul	ah
		movzx	di, cl
		and	di, 0FFFEh
		add	ax, di
		add	ax, 0A4h ; '¤'
		push	ax
		shr	cl, 1
		mov	bl, 78h	; 'x'
		mov	ax, 7F03h
		call	_draw_frame
		pop	ax
		pop	si		; str
		les	di, [_videomempointer]
		add	di, ax
		pop	ax
		call	_text_1BF69
		retn
endp		_message_1BE77


; =============== S U B	R O U T	I N E =======================================


proc		_draw_frame near		; CODE XREF: _start+1FEp _start+278p ...
		push	es
		les	bp, [_videomempointer]
		movzx	di, cl
		movzx	si, ch
		imul	si, 80
		add	di, si
		shl	di, 1
		add	di, bp
		movzx	bp, dl
		inc	bp
		movzx	si, cl
		sub	bp, si
		jbe	short loc_1BF57
		sub	bp, 2
		jb	short loc_1BF57
		mov	dl, dh
		inc	dl
		sub	dl, ch
		jbe	short loc_1BF57
		xor	dh, dh
		sub	dx, 2
		jb	short loc_1BF57
		cmp	al, 6
		jnb	short loc_1BF57
		movzx	si, al
		imul	si, 6
		add	si, offset _frameborder ; "	ÛÛÛÛÛÛÉ»È¼ÍºÚ¿ÀÙÄ³Ö·Ó½ÄºÕ¸Ô¾Í³"
		mov	al, [si]
		cld
		stosw
		mov	cx, bp
		jcxz	short loc_1BF11
		mov	al, [si+4]
		rep stosw

loc_1BF11:				; CODE XREF: _draw_frame+47j
		xchg	bl, ah
		mov	al, [si+1]
		stosw
		or	dx, dx
		jz	short loc_1BF3A

loc_1BF1B:				; CODE XREF: _draw_frame+75j
		xchg	bl, ah
		add	di, 156
		sub	di, bp
		sub	di, bp
		mov	al, [si+5]
		stosw
		mov	cx, bp
		jcxz	short loc_1BF31
		mov	al, ' '
		rep stosw

loc_1BF31:				; CODE XREF: _draw_frame+68j
		xchg	bl, ah
		mov	al, [si+5]
		stosw
		dec	dx
		jnz	short loc_1BF1B

loc_1BF3A:				; CODE XREF: _draw_frame+56j
		xchg	bl, ah
		add	di, 156
		sub	di, bp
		sub	di, bp
		mov	al, [si+2]
		stosw
		xchg	bl, ah
		mov	cx, bp
		jcxz	short loc_1BF53
		mov	al, [si+4]
		rep stosw

loc_1BF53:				; CODE XREF: _draw_frame+89j
		mov	al, [si+3]
		stosw

loc_1BF57:				; CODE XREF: _draw_frame+1Dj
					; _draw_frame+22j ...
		pop	es
		retn
endp		_draw_frame


; =============== S U B	R O U T	I N E =======================================


; void __usercall _write_scr(char *str<esi>)
proc		_write_scr near		; CODE XREF: _start+20Bp _start+72Ap ...
		mov	bp, di
		add	di, [si]
		add	si, 2
		jmp	short _n2_setcolor
endp		_write_scr

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR _text_1BF69

_n1_movepos:				; CODE XREF: _text_1BF69+9j
		mov	di, [si]
		add	di, bp
		add	si, 2
; END OF FUNCTION CHUNK	FOR _text_1BF69

; =============== S U B	R O U T	I N E =======================================


; void __usercall _text_1BF69(char *str<esi>)
proc		_text_1BF69 near		; CODE XREF: _filelist_198B8+102p
					; _filelist_198B8+112p ...

; FUNCTION CHUNK AT 2F12 SIZE 00000007 BYTES

		mov	al, [si]
		inc	si		; str
		or	al, al
		jz	short locret_1BF85
		cmp	al, 1
		jz	short _n1_movepos
		cmp	al, 2
		jz	short _n2_setcolor
		mov	[es:di], ax
		add	di, 2
		jmp	short _text_1BF69
; ---------------------------------------------------------------------------

_n2_setcolor:				; CODE XREF: _write_scr+7j
					; _text_1BF69+Dj
		lodsb
		mov	ah, al
		jmp	short _text_1BF69
; ---------------------------------------------------------------------------

locret_1BF85:				; CODE XREF: _text_1BF69+5j
		retn
endp		_text_1BF69 ; sp-analysis failed

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR _put_message

loc_1BF86:				; CODE XREF: _put_message+4j
		stosw
; END OF FUNCTION CHUNK	FOR _put_message

; =============== S U B	R O U T	I N E =======================================


; void __usercall _put_message(char color<ah>, char *str<esi>, void *videoptr<edi>)
proc		_put_message near	; CODE XREF: _start+2A8p _start+2EDp ...

; FUNCTION CHUNK AT 2F36 SIZE 00000001 BYTES

		cld
		lodsb
		or	al, al
		jnz	short loc_1BF86
		retn
endp		_put_message ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


; void __usercall _put_message2(char *str<esi>, void *buf<edi>)
proc		_put_message2 near	; CODE XREF: _put_message2+6j
		stosw
		cld
		lods	[byte ptr fs:si]
		or	al, al
		jnz	short _put_message2
		retn
endp		_put_message2


; =============== S U B	R O U T	I N E =======================================


proc		_loadcfg	near		; CODE XREF: _start:loc_190D3p
		mov	dx, offset _sIplay_cfg ;	"C:\\IPLAY.CFG"
		mov	ax, 3D00h
		int	21h		; DOS -	2+ - OPEN DISK FILE WITH HANDLE
					; DS:DX	-> ASCIZ filename
					; AL = access mode
					; 0 - read
		jb	short loc_1BFE3
		mov	bx, ax
		mov	dx, offset _cfg_buffer
		mov	cx, 4
		mov	ah, 3Fh	; '?'
		push	bx
		int	21h		; DOS -	2+ - READ FROM FILE WITH HANDLE
					; BX = file handle, CX = number	of bytes to read
					; DS:DX	-> buffer
		pop	bx
		jb	short loc_1BFC9
		mov	eax, [_dword_1DCEC]
		cmp	eax, [dword ptr	_cfg_buffer]
		stc
		jnz	short loc_1BFC9
		mov	dx, offset _snd_card_type
		mov	cx, 0Ch
		mov	ah, 3Fh	; '?'
		push	bx
		int	21h		; DOS -	2+ - READ FROM FILE WITH HANDLE
					; BX = file handle, CX = number	of bytes to read
					; DS:DX	-> buffer
		pop	bx

loc_1BFC9:				; CODE XREF: _loadcfg+18j _loadcfg+24j
		pushf
		mov	ah, 3Eh
		int	21h		; DOS -	2+ - CLOSE A FILE WITH HANDLE
					; BX = file handle
		popf
		jb	short loc_1BFE3
		mov	si, offset _snd_card_type
		mov	cx, 0Ch
		xor	al, al

loc_1BFD9:				; CODE XREF: _loadcfg+45j
		add	al, [si]
		inc	si
		loop	loc_1BFD9
		or	al, al
		jnz	short loc_1BFE3
		retn
; ---------------------------------------------------------------------------

loc_1BFE3:				; CODE XREF: _loadcfg+8j _loadcfg+38j ...
		mov	ax, cs
		mov	ds, ax
		assume ds:seg001
		mov	dx, offset _aConfigFileNotF ; "Config file not found. Run ISETUP	first"...
		mov	ah, 9
		int	21h		; DOS -	PRINT STRING
					; DS:DX	-> string terminated by	"$"
		mov	ax, 4C01h
		int	21h		; DOS -	2+ - QUIT WITH EXIT CODE (EXIT)
endp		_loadcfg			; AL = exit code

; ---------------------------------------------------------------------------
_aConfigFileNotF	db 'Config file not found. Run ISETUP first',0Dh,0Ah,'$'
					; DATA XREF: _loadcfg+50o
		db 0Dh,0Ah,'$'
		assume ds:dseg

; =============== S U B	R O U T	I N E =======================================


; char *__usercall _getexename<esi>()
proc		_getexename near		; CODE XREF: _init_vga_waves+2Fp
		mov	es, [_esseg_atstart]
		mov	es, [word ptr es:2Ch]
		xor	di, di
		xor	al, al
		cld
		mov	cx, 8000h

loc_1C031:				; CODE XREF: _getexename+18j
		repne scasb
		jnz	short loc_1C050
		cmp	[es:di], al
		jnz	short loc_1C031
		mov	cx, [es:di+1]
		jcxz	short loc_1C050
		add	di, 3

loc_1C043:				; CODE XREF: _getexename+2Cj
		mov	al, [es:di]
		mov	[si], al
		inc	di
		inc	si
		or	al, al
		jnz	short loc_1C043
		clc
		retn
; ---------------------------------------------------------------------------

loc_1C050:				; CODE XREF: _getexename+13j
					; _getexename+1Ej
		stc
		retn
endp		_getexename


; =============== S U B	R O U T	I N E =======================================





; =============== S U B	R O U T	I N E =======================================


proc		_set_egasequencer near	; CODE XREF: _init_vga_waves+91p
					; _init_f5_spectr+13p
		mov	dx, 3C4h
		mov	al, 1
		out	dx, al		; EGA: sequencer address reg
					; clocking mode. Data bits:
					; 0: 1=8 dots/char; 0=9	dots/char
					; 1: CRT bandwidth: 1=low; 0=high
					; 2: 1=shift every char; 0=every 2nd char
					; 3: dot clock:	1=halved
		inc	dl
		in	al, dx		; EGA port: sequencer data register
		or	al, 100000b	; 9 dots/char
					; high bandwidth
					; shift	every 2	char
					; dot clock
					; .
					; dont know
		out	dx, al		; EGA port: sequencer data register
		retn
endp		_set_egasequencer


; =============== S U B	R O U T	I N E =======================================


proc		_graph_1C070 near	; CODE XREF: _init_vga_waves+12Cp
					; _init_f5_spectr+91p
		mov	dx, 3C4h
		mov	al, 1
		out	dx, al		; EGA: sequencer address reg
					; clocking mode. Data bits:
					; 0: 1=8 dots/char; 0=9	dots/char
					; 1: CRT bandwidth: 1=low; 0=high
					; 2: 1=shift every char; 0=every 2nd char
					; 3: dot clock:	1=halved
		inc	dl
		in	al, dx		; EGA port: sequencer data register
		and	al, 0DFh
		out	dx, al		; EGA port: sequencer data register
		retn
endp		_graph_1C070

		assume ds:seg003

; =============== S U B	R O U T	I N E =======================================


proc		_int9_keyb far		; DATA XREF: _start+133o
		cmp	[cs:_byte_1C1B8], 1
		jz	loc_1C11F
		push	ax
		in	al, 60h		; 8042 keyboard	controller data	register
		cmp	al, 0E0h ; 'à'
		jz	_l_escaped_scancode
		cmp	al, 0E1h ; 'á'
		jz	_l_escaped_scancode
		mov	ah, [cs:_prev_scan_code]
		or	ah, ah
		jz	short loc_1C0A5
		mov	[cs:_prev_scan_code], 0

loc_1C0A5:				; CODE XREF: _int9_keyb+20j
		cmp	al, 36h	; '6'
		jz	short _l_rshift
		cmp	al, 0B6h ; '¶'
		jz	short _l_rshiftup
		cmp	al, 2Ah	; '*'
		jz	short _l_lshift
		cmp	al, 0AAh ; 'ª'
		jz	short _l_lshiftup
		cmp	al, 1Dh
		jz	short _l_ctrl
		cmp	al, 9Dh	; ''
		jz	short _l_lctrlup
		cmp	al, 38h	; '8'
		jz	short _l_alt
		cmp	al, 0B8h ; '¸'
		jz	short _l_altup
		mov	[cs:_key_code], ax

loc_1C0C9:				; CODE XREF: _int9_keyb+62j
					; _int9_keyb+6Aj ...
		in	al, 61h		; PC/XT	PPI port B bits:
					; 0: Tmr 2 gate	ÍËÍ OR	03H=spkr ON
					; 1: Tmr 2 data	Í¼  AND	0fcH=spkr OFF
					; 3: 1=read high switches
					; 4: 0=enable RAM parity checking
					; 5: 0=enable I/O channel check
					; 6: 0=hold keyboard clock low
					; 7: 0=enable kbrd
		or	al, 80h
		out	61h, al		; PC/XT	PPI port B bits:
					; 0: Tmr 2 gate	ÍËÍ OR	03H=spkr ON
					; 1: Tmr 2 data	Í¼  AND	0fcH=spkr OFF
					; 3: 1=read high switches
					; 4: 0=enable RAM parity checking
					; 5: 0=enable I/O channel check
					; 6: 0=hold keyboard clock low
					; 7: 0=enable kbrd
		and	al, 7Fh
		out	61h, al		; PC/XT	PPI port B bits:
					; 0: Tmr 2 gate	ÍËÍ OR	03H=spkr ON
					; 1: Tmr 2 data	Í¼  AND	0fcH=spkr OFF
					; 3: 1=read high switches
					; 4: 0=enable RAM parity checking
					; 5: 0=enable I/O channel check
					; 6: 0=hold keyboard clock low
					; 7: 0=enable kbrd
		mov	al, 20h	; ' '
		out	20h, al		; Interrupt controller,	8259A.
		pop	ax
		iret
; ---------------------------------------------------------------------------

_l_rshift:				; CODE XREF: _int9_keyb+2Aj
		or	[cs:_keyb_switches], 1
		jmp	short loc_1C0C9
; ---------------------------------------------------------------------------

_l_rshiftup:				; CODE XREF: _int9_keyb+2Ej
		and	[cs:_keyb_switches], not	1
		jmp	short loc_1C0C9
; ---------------------------------------------------------------------------

_l_lshift:				; CODE XREF: _int9_keyb+32j
		or	[cs:_keyb_switches], 10b
		jmp	short loc_1C0C9
; ---------------------------------------------------------------------------

_l_lshiftup:				; CODE XREF: _int9_keyb+36j
		and	[cs:_keyb_switches], not	10b
		jmp	short loc_1C0C9
; ---------------------------------------------------------------------------

_l_ctrl:					; CODE XREF: _int9_keyb+3Aj
		or	[cs:_keyb_switches], 100b
		jmp	short loc_1C0C9
; ---------------------------------------------------------------------------

_l_lctrlup:				; CODE XREF: _int9_keyb+3Ej
		and	[cs:_keyb_switches], not	100b
		jmp	short loc_1C0C9
; ---------------------------------------------------------------------------
		assume ds:dseg

_l_alt:					; CODE XREF: _int9_keyb+42j
		or	[cs:_keyb_switches], 1000b
		jmp	short loc_1C0C9
; ---------------------------------------------------------------------------

_l_altup:				; CODE XREF: _int9_keyb+46j
		and	[cs:_keyb_switches], not	1000b
		jmp	short loc_1C0C9
; ---------------------------------------------------------------------------

_l_escaped_scancode:			; CODE XREF: _int9_keyb+Fj
					; _int9_keyb+15j
		mov	[cs:_prev_scan_code], al
		jmp	short loc_1C0C9
; ---------------------------------------------------------------------------

loc_1C11F:				; CODE XREF: _int9_keyb+6j
		jmp	[cs:_oint9_1C1A4]
endp		_int9_keyb


; =============== S U B	R O U T	I N E =======================================


proc		_get_keybsw near
		push	es
		xor	ax, ax
		mov	es, ax
		assume es:nothing
		mov	ax, [es:17h]
		mov	[cs:_keyb_switches], ax
		pop	es
		assume es:nothing
		retn
endp		_get_keybsw


; =============== S U B	R O U T	I N E =======================================


proc		_set_keybsw near
		push	es
		xor	ax, ax
		mov	es, ax
		assume es:nothing
		mov	ax, [cs:_keyb_switches]
		mov	[es:17h], ax
		pop	es
		assume es:nothing
		retn
endp		_set_keybsw

; ---------------------------------------------------------------------------
; ---------------------------------------------------------------------------
_key_code	dw 0			; DATA XREF: _start:loc_193FFr
					; _start+37Aw ...
_keyb_switches	dw 0			; DATA XREF: _start+5D8r
					; _keyb_19EFD+1DEr ...
_prev_scan_code	db 0			; DATA XREF: _int9_keyb+19r
					; _int9_keyb+22w ...

; =============== S U B	R O U T	I N E =======================================


proc		_int24 far		; DATA XREF: _start+13Bo
		mov	al, 3
		test	ah, 8
		jnz	short locret_1C159
		mov	al, 0
		test	ah, 20h
		jnz	short locret_1C159
		mov	al, 1

locret_1C159:				; CODE XREF: _int24+5j _int24+Cj
		iret
endp		_int24


; =============== S U B	R O U T	I N E =======================================


proc		_int2f_checkmyself far	; DATA XREF: _start+143o
		pushf
		cmp	ax, 60FFh
		jz	short _lyesitsme	; DS

loc_1C160:				; CODE XREF: _int2f_checkmyself+10j
					; _int2f_checkmyself+16j
		popf
		jmp	[cs:_oint2f_1C1B4]
; ---------------------------------------------------------------------------

_lyesitsme:				; CODE XREF: _int2f_checkmyself+4j
		cmp	bx, 5344h	; DS
		jnz	short loc_1C160
		cmp	cx, 4D50h	; PM
		jnz	short loc_1C160
		popf
		cmp	dl, 1
		jz	short loc_1C17C
		mov	ax, 4F4Bh	; KO
		iret
; ---------------------------------------------------------------------------

loc_1C17C:				; CODE XREF: _int2f_checkmyself+1Cj
		push	ax
		push	ds
		mov	ax, dseg
		mov	ds, ax
		mov	[_byte_1DE7C], 1
		pop	ds
		pop	ax
		iret
endp		_int2f_checkmyself


; =============== S U B	R O U T	I N E =======================================


proc		_int1a_timer near	; DATA XREF: _dosexec+47o
		pushf
		or	ah, ah
		jnz	short loc_1C19C
		pushad
		push	ds
		push	es
		call	_rereadrtc_settmr
		pop	es
		pop	ds
		popad

loc_1C19C:				; CODE XREF: _int1a_timer+3j
		popf
		jmp	[cs:_int1Avect]
endp		_int1a_timer

; ---------------------------------------------------------------------------
; ---------------------------------------------------------------------------
_oint9_1C1A4	dd 0			; DATA XREF: _start+106w _start+1E0r ...
_int1Avect	dd 0			; DATA XREF: _int1a_timer+12r
					; _dosexec+38w ...
_oint24_1C1AC	dd 0			; DATA XREF: _start+115w _start+1D4r ...
		db 4 dup(0)
_oint2f_1C1B4	dd 0			; DATA XREF: _start+124w _start+1C8r ...
_byte_1C1B8	db 0			; DATA XREF: _int9_keybr _dosexec+58w ...

; =============== S U B	R O U T	I N E =======================================


proc		_dosexec	near		; CODE XREF: _start+747p
					; _keyb_19EFD+338p
		mov	ax, 3
		int	10h		; - VIDEO - SET	VIDEO MODE
					; AL = mode
		call	_txt_enableblink
		mov	cx, 0
		mov	dx, 94Fh
		mov	bl, 78h	; 'x'
		mov	ax, 7F03h
		call	_draw_frame
		call	_txt_draw_top_title
		mov	si, offset _word_1D26D ;	str
		les	di, [_videomempointer]
		call	_write_scr
		mov	dx, 0A00h
		xor	bh, bh
		mov	ah, 2
		int	10h		; - VIDEO - SET	CURSOR POSITION
					; DH,DL	= row, column (0,0 = upper left)
					; BH = page number
		test	[_byte_1DE78], 2
		jz	short loc_1C209
		mov	ax, 351Ah
		int	21h		; DOS -	2+ - GET INTERRUPT VECTOR
					; AL = interrupt number
					; Return: ES:BX	= value	of interrupt vector
		mov	[word ptr cs:_int1Avect], bx
		mov	[word ptr cs:_int1Avect+2], es
		push	ds
		mov	ax, cs
		mov	ds, ax
		assume ds:seg001
		mov	dx, offset _int1a_timer
		mov	ax, 251Ah
		int	21h		; DOS -	SET INTERRUPT VECTOR
					; AL = interrupt number
					; DS:DX	= new vector to	be used	for specified interrupt
		pop	ds
		assume ds:dseg

loc_1C209:				; CODE XREF: _dosexec+31j
		mov	si, offset _byte_1DD3F ;	str
		call	_dosgetcurdir
		mov	al, 1
		mov	[cs:_byte_1C1B8], al
		call	sub_12D35
		mov	es, [_esseg_atstart]
		mov	ax, [es:2Ch]
		mov	[_word_24445], ax
		call	_get_comspec
		jb	short loc_1C23E
		mov	dx, di
		push	ds
		mov	ax, ds
		mov	es, ax
		assume es:dseg
		mov	bx, offset _word_24445
		mov	ds, [_word_24445]
		mov	ax, 4B00h
		int	21h		; DOS -	2+ - LOAD OR EXECUTE (EXEC)
					; DS:DX	-> ASCIZ filename
					; ES:BX	-> parameter block
					; AL = subfunc:	load & execute program
		pop	ds

loc_1C23E:				; CODE XREF: _dosexec+6Fj
		mov	al, 0
		mov	[cs:_byte_1C1B8], al
		call	sub_12D35
		test	[_byte_1DE78], 2
		jz	short loc_1C25C
		push	ds
		lds	dx, [cs:_int1Avect]
		mov	ax, 251Ah
		int	21h		; DOS -	SET INTERRUPT VECTOR
					; AL = interrupt number
					; DS:DX	= new vector to	be used	for specified interrupt
		pop	ds

loc_1C25C:				; CODE XREF: _dosexec+95j
		mov	si, offset _byte_1DD3F ;	str
		call	_doschdir
		mov	[_byte_1DE70], 0FFh
		retn
endp		_dosexec


; =============== S U B	R O U T	I N E =======================================


proc		_get_comspec near	; CODE XREF: _dosexec+6Cp
		mov	es, [_esseg_atstart]
		assume es:nothing
		mov	es, [word ptr es:2Ch]
		xor	di, di

loc_1C273:				; CODE XREF: _get_comspec+2Fj
		cmp	[byte ptr es:di], 0
		stc
		jz	short locret_1C29D
		cmp	[dword ptr es:di], 534D4F43h ; COMSPEC=
		jnz	short loc_1C28F
		cmp	[dword ptr es:di+4], 3D434550h
		jz	short loc_1C299

loc_1C28F:				; CODE XREF: _get_comspec+1Aj
					; _get_comspec+2Cj
		inc	di
		cmp	[byte ptr es:di], 0
		jnz	short loc_1C28F
		inc	di
		jmp	short loc_1C273
; ---------------------------------------------------------------------------

loc_1C299:				; CODE XREF: _get_comspec+25j
		add	di, 8
		clc

locret_1C29D:				; CODE XREF: _get_comspec+10j
		retn
endp		_get_comspec


; =============== S U B	R O U T	I N E =======================================


proc		_find_mods near		; CODE XREF: _start+1A1p
					; _modules_search+65p ...
		mov	ax, ds
		mov	es, ax
		assume es:dseg
		mov	di, offset _buffer_1DB6C
		mov	si, di
		mov	cx, 120
		xor	al, al
		cld
		repne scasb
		jnz	short loc_1C321
		dec	di
		mov	[_word_1DE4A], di

loc_1C2B6:				; CODE XREF: _find_mods+2Aj
		mov	al, [di-1]
		or	al, al
		jz	short loc_1C2CA
		cmp	al, '\'
		jz	short loc_1C2CA
		cmp	al, ':'
		jz	short loc_1C2CA
		dec	di
		cmp	si, di
		jb	short loc_1C2B6

loc_1C2CA:				; CODE XREF: _find_mods+1Dj
					; _find_mods+21j ...
		sub	di, si
		mov	[_word_1DE4C], di
		mov	dx, offset _buffer_1DBEC
		mov	ah, 1Ah
		int	21h		; DOS -	SET DISK TRANSFER AREA ADDRESS
					; DS:DX	-> disk	transfer buffer
		mov	dx, offset _buffer_1DB6C
		mov	cx, [_word_1DE4E]
		mov	ah, 4Eh
		int	21h		; DOS -	2+ - FIND FIRST	ASCIZ (FINDFIRST)
					; CX = search attributes
					; DS:DX	-> ASCIZ filespec
					; (drive, path,	and wildcards allowed)
		jnb	short loc_1C309
		mov	si, offset _a_mod_nst_669_s ; ".MOD.NST.669.STM.S3M.MTM.PSM.WOW.INR.FA"...

loc_1C2E7:				; CODE XREF: _find_mods+69j
		cmp	[byte ptr si], 0
		jz	short loc_1C321
		mov	di, [_word_1DE4A]
		mov	eax, [si]
		mov	[di], eax
		mov	[byte ptr di+4], 0
		add	si, 4
		mov	dx, offset _buffer_1DB6C
		mov	cx, 2
		mov	ah, 4Eh
		int	21h		; DOS -	2+ - FIND FIRST	ASCIZ (FINDFIRST)
					; CX = search attributes
					; DS:DX	-> ASCIZ filespec
					; (drive, path,	and wildcards allowed)
		jb	short loc_1C2E7

loc_1C309:				; CODE XREF: _find_mods+44j
					; _dosfindnext+Bj
		mov	ax, ds
		mov	es, ax
		mov	si, offset _byte_1DC0A
		mov	di, offset _buffer_1DB6C
		add	di, [_word_1DE4C]
		cld
		mov	cx, 3
		rep movsd
		movsb
		clc
		retn
; ---------------------------------------------------------------------------

loc_1C321:				; CODE XREF: _find_mods+11j
					; _find_mods+4Cj
		mov	[_byte_1DE7E], 2
		mov	[word ptr _messagepointer], offset _aModuleNotFound ; "Module not	found.\r\n$"
		mov	[word ptr _messagepointer+2], ds
		stc
		retn
endp		_find_mods


; =============== S U B	R O U T	I N E =======================================


proc		_dosfindnext near	; CODE XREF: _modules_search+CBp
					; _modules_search+247p ...
		mov	dx, offset _buffer_1DBEC
		mov	ah, 1Ah
		int	21h		; DOS -	SET DISK TRANSFER AREA ADDRESS
					; DS:DX	-> disk	transfer buffer
		mov	ah, 4Fh
		int	21h		; DOS -	2+ - FIND NEXT ASCIZ (FINDNEXT)
					; [DTA]	= data block from
					; last AH = 4Eh/4Fh call
		jnb	short loc_1C309
		retn
endp		_dosfindnext


; =============== S U B	R O U T	I N E =======================================


proc		_video_prp_mtr_positn near ; CODE XREF: _read_module+C5p
					; _init_vga_waves+14Cp ...
		pushf
		cli
		mov	[_byte_1DE79], 0
		mov	[_byte_1DE7A], 0
		lfs	bx, [_segfsbx_1DE28]
		mov	cx, [_amount_of_x]

loc_1C355:				; CODE XREF: _video_prp_mtr_positn+2Dj
		mov	al, [fs:bx+3Ah]
		cmp	al, 40h	; '@'
		jb	short loc_1C365
		inc	[_byte_1DE7A]
		cmp	al, 40h	; '@'
		ja	short loc_1C369

loc_1C365:				; CODE XREF: _video_prp_mtr_positn+1Bj
		inc	[_byte_1DE79]

loc_1C369:				; CODE XREF: _video_prp_mtr_positn+23j
		add	bx, 50h	; 'P'
		dec	cx
		jnz	short loc_1C355
		movzx	ecx, [_byte_1DE79]
		cmp	cl, [_byte_1DE7A]
		ja	short loc_1C37F
		mov	cl, [_byte_1DE7A]

loc_1C37F:				; CODE XREF: _video_prp_mtr_positn+39j
		mov	al, 3
		cmp	cl, 2
		jbe	short loc_1C396
		mov	al, 2
		cmp	cl, 4
		jbe	short loc_1C396
		mov	al, 1
		cmp	cl, 8
		jbe	short loc_1C396
		mov	al, 0

loc_1C396:				; CODE XREF: _video_prp_mtr_positn+44j
					; _video_prp_mtr_positn+4Bj ...
		add	al, 8
		mov	[_byte_1DE81], al
		xor	edx, edx
		mov	eax, 18350080
		jcxz	short loc_1C3A9
		div	ecx

loc_1C3A9:				; CODE XREF: _video_prp_mtr_positn+64j
		mov	ebp, eax
		mov	si, offset _x_storage
		mov	cx, [_amount_of_x]
		lfs	bx, [_segfsbx_1DE28]
		mov	edi, ebp
		shr	edi, 1
		mov	edx, edi

loc_1C3C1:				; CODE XREF: _video_prp_mtr_positn+B5j
		cmp	[byte ptr fs:bx+3Ah], 40h ; '@'
		jz	short loc_1C3EE
		ja	short loc_1C3DC
		mov	eax, edi
		shr	eax, 16
		imul	ax, 80
		add	ax, 1
		add	edi, ebp
		jmp	short loc_1C3EC
; ---------------------------------------------------------------------------

loc_1C3DC:				; CODE XREF: _video_prp_mtr_positn+88j
		mov	eax, edx
		shr	eax, 16
		imul	ax, 80
		add	ax, 42
		add	edx, ebp

loc_1C3EC:				; CODE XREF: _video_prp_mtr_positn+9Aj
		mov	[si], ax

loc_1C3EE:				; CODE XREF: _video_prp_mtr_positn+86j
		add	si, 2
		add	bx, 50h	; 'P'
		dec	cx
		jnz	short loc_1C3C1
		mov	si, offset _x_storage
		mov	cx, [_amount_of_x]
		lfs	bx, [_segfsbx_1DE28]
		cmp	edi, edx
		ja	short loc_1C40B
		mov	edi, edx

loc_1C40B:				; CODE XREF: _video_prp_mtr_positn+C6j
					; _video_prp_mtr_positn+EBj
		cmp	[byte ptr fs:bx+3Ah], 40h ; '@'
		jnz	short loc_1C424
		mov	eax, edi
		shr	eax, 16
		imul	ax, 80
		add	ax, 21
		add	edi, ebp
		mov	[si], ax

loc_1C424:				; CODE XREF: _video_prp_mtr_positn+D0j
		add	si, 2
		add	bx, 50h	; 'P'
		dec	cx
		jnz	short loc_1C40B
		popf
		retn
endp		_video_prp_mtr_positn


; =============== S U B	R O U T	I N E =======================================


proc		_callsubx near		; CODE XREF: _start:loc_19050p
					; _start+1A6p ...
		mov	al, [_snd_card_type]
		mov	dx, [_snd_base_port_0]
		mov	cl, [_irq_number_1]
		mov	ch, [_dma_channel_1]
		mov	ah, [_freq_1DCF6]
		movzx	di, [_byte_1DCFB]
		mov	si, [_configword]
		mov	bl, [_byte_1DCF7]
		mov	bh, [_byte_1DCF8]
		call	sub_12DA8
		mov	[_byte_1DE7E], 1
		mov	[word ptr _messagepointer], dx
		mov	[word ptr _messagepointer+2], fs
		jb	short locret_1C4A7
		mov	[_byte_1DE7E], 0
		call	_read_sndsettings
		mov	[_snd_card_type], al
		mov	[_snd_base_port_0], dx
		mov	[_irq_number_1],	cl
		mov	[_dma_channel_1], ch
		mov	[_freq_1DCF6], ah
		mov	[_byte_1DCF7], bl
		mov	[_byte_1DCF8], bh
		mov	[_configword], si
		mov	[_outp_freq], bp
		mov	[_byte_1DE7C], 1
		cmp	[_snd_card_type], 0
		jnz	short loc_1C4A6
		mov	[byte ptr cs:loc_1AA73+4], 0Fh

loc_1C4A6:				; CODE XREF: _callsubx+6Fj
		clc

locret_1C4A7:				; CODE XREF: _callsubx+36j
		retn
endp		_callsubx


; =============== S U B	R O U T	I N E =======================================


proc		_rereadrtc_settmr near	; CODE XREF: _int1a_timer+9p
		mov	ah, 2
		int	1Ah		; CLOCK	- READ REAL TIME CLOCK (AT,XT286,CONV,PS)
					; Return: CH = hours in	BCD
					; CL = minutes in BCD
					; DH = seconds in BCD
		xor	eax, eax
		mov	al, dh
		mov	ah, al
		shr	ah, 4
		and	al, 0Fh
		aad
		mov	ebx, eax
		mov	al, ch
		mov	ah, al
		shr	ah, 4
		and	al, 0Fh
		aad
		imul	edx, eax, 60
		mov	al, cl
		mov	ah, al
		shr	ah, 4
		and	al, 0Fh
		aad
		add	dx, ax
		imul	eax, edx, 60
		add	eax, ebx
		mov	edx, 1193180
		mul	edx
		shrd	eax, edx, 10h
		xor	dx, dx
		mov	es, dx
		assume es:nothing
		mov	[es:46Ch], eax
		retn
endp		_rereadrtc_settmr


; =============== S U B	R O U T	I N E =======================================


proc		_spectr_1C4F8 near	; CODE XREF: _spectr_1BBC1+2Ap
		xor	eax, eax
		mov	edx, 40000000h

loc_1C501:				; CODE XREF: _spectr_1C4F8+21j
		mov	ecx, eax
		add	ecx, edx
		shr	eax, 1
		cmp	ecx, ebx
		jg	short loc_1C515
		sub	ebx, ecx
		add	eax, edx

loc_1C515:				; CODE XREF: _spectr_1C4F8+15j
		shr	edx, 2
		jnz	short loc_1C501
		cmp	eax, ebx
		jge	short locret_1C521
		inc	ax

locret_1C521:				; CODE XREF: _spectr_1C4F8+26j
		retn
endp		_spectr_1C4F8


; =============== S U B	R O U T	I N E =======================================


proc		_txt_blinkingoff	near	; CODE XREF: _setvideomode+1Cp
					; _text_init2+11Dp
		xor	bl, bl
		mov	ax, 1003h
		int	10h		; - VIDEO - TOGGLE INTENSITY/BLINKING BIT (Jr, PS, TANDY 1000, EGA, VGA)
					; BL = 00h enable background intensity
					; = 01h	enable blink
		retn
endp		_txt_blinkingoff


; =============== S U B	R O U T	I N E =======================================


proc		_txt_enableblink	near	; CODE XREF: _start+1F0p _dosexec+5p
		mov	bl, 1
		mov	ax, 1003h
		int	10h		; - VIDEO - TOGGLE INTENSITY/BLINKING BIT (Jr, PS, TANDY 1000, EGA, VGA)
					; BL = 00h enable background intensity
					; = 01h	enable blink
		retn
endp		_txt_enableblink


; =============== S U B	R O U T	I N E =======================================


proc		_my_u32tox near		; CODE XREF: _useless_sprint_12+8p
		ror	eax, 10h
		call	_my_u16tox
		ror	eax, 10h
endp		_my_u32tox ; sp-analysis	failed


; =============== S U B	R O U T	I N E =======================================


proc		_my_u16tox near		; CODE XREF: _my_u32tox+4p
					; _useless_sprint_11+7p
		xchg	al, ah
		call	_my_u8tox
		mov	al, ah
endp		_my_u16tox ; sp-analysis	failed


; =============== S U B	R O U T	I N E =======================================


proc		_my_u8tox near		; CODE XREF: _my_u16tox+2p
					; _useless_sprint_10+7p
		push	ax
		shr	al, 4
		call	_my_u4tox
		pop	ax
endp		_my_u8tox ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


proc		_my_u4tox near		; CODE XREF: _my_u8tox+4p
		and	al, 0Fh
		or	al, '0'
		cmp	al, '9'
		jbe	short loc_1C556
		add	al, 7

loc_1C556:				; CODE XREF: _my_u4tox+6j
		mov	[si], al
		inc	si
		retn
endp		_my_u4tox


; =============== S U B	R O U T	I N E =======================================


proc		_my_i8toa10 near		; CODE XREF: seg001:2DC1p
					; _useless_sprint_7+7p
		cbw

_my_i16toa10:				; CODE XREF: _useless_sprint_8+7p
		cwde

_my_i32toa10:				; CODE XREF: _useless_sprint_9+8p
		xor	cx, cx
		or	eax, eax
		jns	short _my_i32toa10_
		mov	dl, '-'
		call	_myputdigit
		neg	eax
		jmp	short _my_i32toa10_
endp		_my_i8toa10


; =============== S U B	R O U T	I N E =======================================


proc		_my_u8toa10 near		; CODE XREF: _text_init2:loc_1A6A1p
					; _text_init2+239p ...
		xor	ah, ah
endp		_my_u8toa10


; =============== S U B	R O U T	I N E =======================================


proc		_my_u16toa10 near	; CODE XREF: _text_init2+28Fp
					; _txt_draw_bottom+13Ep	...
		movzx	eax, ax
endp		_my_u16toa10 ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


proc		_my_u32toa10 near	; CODE XREF: _my_u32toa_fill+6p
					; _useless_sprint_6+8p
		xor	cx, cx

_my_i32toa10_:				; CODE XREF: _my_i8toa10+8j
					; _my_i8toa10+12j
		mov	ebx, 10
endp		_my_u32toa10 ; sp-analysis failed


; =============== S U B	R O U T	I N E =======================================


proc		_my_u32toa near		; CODE XREF: _my_u32toa+Dp
		xor	edx, edx
		div	ebx
		or	eax, eax
		jz	short loc_1C58E
		push	edx
		call	_my_u32toa
		pop	edx

loc_1C58E:				; CODE XREF: _my_u32toa+9j
		or	dl, '0'
endp		_my_u32toa ; sp-analysis	failed


; =============== S U B	R O U T	I N E =======================================


proc		_myputdigit near		; CODE XREF: _my_i8toa10+Cp
		mov	[si], dl
		inc	si
		inc	cx
		retn
endp		_myputdigit

; ---------------------------------------------------------------------------

; =============== S U B	R O U T	I N E =======================================





; =============== S U B	R O U T	I N E =======================================





; =============== S U B	R O U T	I N E =======================================





; =============== S U B	R O U T	I N E =======================================





; =============== S U B	R O U T	I N E =======================================





; =============== S U B	R O U T	I N E =======================================





; =============== S U B	R O U T	I N E =======================================





; =============== S U B	R O U T	I N E =======================================





; =============== S U B	R O U T	I N E =======================================


proc		_mystrlen near		; CODE XREF: _start+2D6p
		mov	ax, -1
		dec	si

loc_1C6AB:				; CODE XREF: _mystrlen+9j
		inc	ax
		inc	si
		cmp	[byte ptr si], 0
		jnz	short loc_1C6AB
		sub	si, ax
		retn
endp		_mystrlen


; =============== S U B	R O U T	I N E =======================================


proc		_strcpy_count near	; CODE XREF: _useless_mysprintf+26p
					; _useless_mysprintf+43p
		xor	cx, cx
		jmp	short loc_1C6BE
; ---------------------------------------------------------------------------

loc_1C6B9:				; CODE XREF: _strcpy_count+Ej
		mov	[es:di], al
		inc	si
		inc	di

loc_1C6BE:				; CODE XREF: _strcpy_count+2j
		mov	al, [si]
		inc	cx
		or	al, al
		jnz	short loc_1C6B9
		retn
endp		_strcpy_count


; =============== S U B	R O U T	I N E =======================================


proc		_mouse_init near		; CODE XREF: _start+16Dp _start+74Ap
		mov	[_mouse_visible], 0
		xor	ax, ax
		mov	es, ax
		assume es:nothing
		cmp	[dword ptr es:0CCh], 0
		jz	short loc_1C708
		mov	ax, 21h	; '!'
		int	33h		; - MS MOUSE - SOFTWARE	RESET
					; Return: AX = FFFFh if	mouse driver installed
					; AX = 0021h if	mouse driver not installed
					; BX = 2 if mouse driver is installed
		cmp	ax, 0FFFFh
		jz	short loc_1C6EF
		xor	ax, ax
		int	33h		; - MS MOUSE - RESET DRIVER AND	READ STATUS
					; Return: AX = status
					; BX = number of buttons
		test	ax, ax
		jz	short loc_1C708
		cmp	ax, 0FFFFh
		jnz	short loc_1C708

loc_1C6EF:				; CODE XREF: _mouse_init+1Aj
		mov	[_mouse_exist_flag], 1
		push	es
		mov	ax, seg001
		mov	es, ax
		assume es:seg001
		mov	dx, offset loc_1C72C
		mov	cx, 1Fh
		mov	ax, 0Ch
		int	33h		; - MS MOUSE - DEFINE INTERRUPT	SUBROUTINE PARAMETERS
					; CX = call mask, ES:DX	-> FAR routine
		pop	es
		assume es:nothing
		clc
		retn
; ---------------------------------------------------------------------------

loc_1C708:				; CODE XREF: _mouse_init+10j
					; _mouse_init+22j ...
		mov	[_mouse_exist_flag], 0
		stc
		retn
endp		_mouse_init


; =============== S U B	R O U T	I N E =======================================


proc		_mouse_deinit near	; CODE XREF: _start:loc_19256p
					; _start:loc_197D6p
		cmp	[_mouse_exist_flag], 1
		jnz	short locret_1C72B
		mov	[_mouse_exist_flag], 0
		mov	[_mouse_visible], 0
		xor	dx, dx
		mov	es, dx
		assume es:nothing
		mov	cx, dx
		mov	ax, 0Ch
		int	33h		; - MS MOUSE - DEFINE INTERRUPT	SUBROUTINE PARAMETERS
					; CX = call mask, ES:DX	-> FAR routine

locret_1C72B:				; CODE XREF: _mouse_deinit+5j
		retn
endp		_mouse_deinit

; ---------------------------------------------------------------------------

loc_1C72C:				; DATA XREF: _mouse_init+34o
		push	ds
		push	dseg
		pop	ds
		mov	[_mousecolumn], cx
		mov	[_mouserow], dx
		mov	[_byte_1DE90], bl
		pop	ds
		retf

; =============== S U B	R O U T	I N E =======================================


proc		_mouse_show near		; CODE XREF: _start+332p
		cmp	[_mouse_exist_flag], 1
		jnz	short locret_1C755
		cmp	[_mouse_visible], 1
		jz	short locret_1C755
		mov	[_mouse_visible], 1
		call	_mouse_showcur

locret_1C755:				; CODE XREF: _mouse_show+5j
					; _mouse_show+Cj
		retn
endp		_mouse_show


; =============== S U B	R O U T	I N E =======================================


proc		_mouse_hide near		; CODE XREF: _start+376p
					; _start:loc_19827p ...
		cmp	[_mouse_exist_flag], 1
		jnz	short locret_1C76C
		cmp	[_mouse_visible], 0
		jz	short locret_1C76C
		mov	[_mouse_visible], 0
		call	_mouse_hide2

locret_1C76C:				; CODE XREF: _mouse_hide+5j
					; _mouse_hide+Cj
		retn
endp		_mouse_hide


; =============== S U B	R O U T	I N E =======================================


proc		_mouse_getpos near
		cmp	[_mouse_exist_flag], 1
		jnz	short loc_1C783
		mov	ax, 3
		int	33h		; - MS MOUSE - RETURN POSITION AND BUTTON STATUS
					; Return: BX = button status, CX = column, DX =	row
		mov	[_mousecolumn], cx
		mov	[_mouserow], dx
		clc
		retn
; ---------------------------------------------------------------------------

loc_1C783:				; CODE XREF: _mouse_getpos+5j
		xor	bx, bx
		xor	cx, cx
		xor	dx, dx
		stc
		retn
endp		_mouse_getpos


; =============== S U B	R O U T	I N E =======================================


proc		_mouse_showcur near	; CODE XREF: _mouse_show+13p
		cmp	[_mouse_exist_flag], 1
		jnz	short loc_1C7A7
		mov	ax, 1
		int	33h		; - MS MOUSE - SHOW MOUSE CURSOR
					; SeeAlso: AX=0002h, INT 16/AX=FFFEh
		clc
		retn
endp		_mouse_showcur


; =============== S U B	R O U T	I N E =======================================


proc		_mouse_hide2 near	; CODE XREF: _mouse_hide+13p
		cmp	[_mouse_exist_flag], 1
		jnz	short loc_1C7A7
		mov	ax, 2
		int	33h		; - MS MOUSE - HIDE MOUSE CURSOR
					; SeeAlso: AX=0001h, INT 16/AX=FFFFh
		clc
		retn
; ---------------------------------------------------------------------------

loc_1C7A7:				; CODE XREF: _mouse_showcur+5j
					; _mouse_hide2+5j
		stc
		retn
endp		_mouse_hide2


; =============== S U B	R O U T	I N E =======================================


proc		_mouse_1C7A9 near	; CODE XREF: _mouse_1C7CF+10p
		cmp	cx, si
		jbe	short loc_1C7AF
		xchg	cx, si

loc_1C7AF:				; CODE XREF: _mouse_1C7A9+2j
		cmp	dx, di
		jbe	short loc_1C7B5
		xchg	dx, di

loc_1C7B5:				; CODE XREF: _mouse_1C7A9+8j
		cmp	ax, cx
		jb	short loc_1C7CA
		cmp	ax, si
		ja	short loc_1C7CA
		cmp	bp, dx
		jb	short loc_1C7CA
		cmp	bp, di
		ja	short loc_1C7CA
		sub	ax, cx
		sub	bp, dx
		retn
; ---------------------------------------------------------------------------

loc_1C7CA:				; CODE XREF: _mouse_1C7A9+Ej
					; _mouse_1C7A9+12j ...
		stc
		retn
endp		_mouse_1C7A9

; ---------------------------------------------------------------------------
; START	OF FUNCTION CHUNK FOR _mouse_1C7CF

loc_1C7CC:				; CODE XREF: _mouse_1C7CF+13j
		add	bx, 0Ah
; END OF FUNCTION CHUNK	FOR _mouse_1C7CF

; =============== S U B	R O U T	I N E =======================================


; void *__usercall _mouse_1C7CF<ebx>(struct struct_0 *_mystr<ebx>)
proc		_mouse_1C7CF near	; CODE XREF: _start+7ADp _start+7C9p ...

; FUNCTION CHUNK AT 377C SIZE 00000003 BYTES

		mov	cx, [bx]
		cmp	cx, -1
		jz	short loc_1C7E9
		mov	dx, [bx+2]
		mov	si, [bx+4]
		mov	di, [bx+6]
		call	_mouse_1C7A9
		jb	short loc_1C7CC
		mov	bx, [bx+8]
		clc
		retn
; ---------------------------------------------------------------------------

loc_1C7E9:				; CODE XREF: _mouse_1C7CF+5j
		stc
		retn
endp		_mouse_1C7CF ; sp-analysis failed

; ---------------------------------------------------------------------------
		db 5 dup(0)
ends		seg001

; ===========================================================================

; Segment type:	Pure data
segment		dseg para public 'DATA' use16
		assume cs:dseg
_aInertiaPlayerV1_ db 'Inertia Player V1.22 written by Stefan Danes and Ramon van Gorkom'
		db 0Dh,0Ah
		db 0Ah
		db 'Usage: IPLAY [Switches] [FileName.Ext|@FileList.Ext]',0Dh,0Ah
		db 0Ah
		db 'Switches:',0Dh,0Ah
		db ' /?  This help screen',0Dh,0Ah
		db ' /h  This help screen (again???)',0Dh,0Ah
		db ' /i  Display current soundcard settings',0Dh,0Ah
		db ' /l  Loop module when it',27h,'s done',0Dh,0Ah
		db ' /d  Disable module looping',0Dh,0Ah
		db ' /g  Start with graphical scopes [F-2]',0Dh,0Ah
		db ' /t  Start with textmode VU meters [F-3]',0Dh,0Ah
		db ' /f  Start with FastFourier screen [F-5]',0Dh,0Ah
		db ' /e  Disable EMS usage',0Dh,0Ah
		db ' /u  Disable UMB usage',0Dh,0Ah
		db ' /o  Enable GUS Channel Optimize [Use minimum number of voices]',0Dh
		db 0Ah
		db ' /c  Disable GUS Channel Optimize [Always use 32 voices]',0Dh,0Ah
		db ' /v  Desqview mode: Only use 80x25 textmode',0Dh,0Ah,'$'
_aCurrentSoundcard db 0Dh,'Current Soundcard settings:',0Dh,0Ah ; DATA XREF: _start:loc_19057o
		db 0Ah,'$'
_myendl		db 0Dh,0Ah,'$'          ; DATA XREF: _start-1Do
off_1CA8E	dw offset _f3_textmetter	; DATA XREF: _start+182r
		dw offset _f2_waves
		dw offset _f5_graphspectr
		dw offset _f4_patternnae
		dw offset _f1_help
		dw offset _f6_undoc
_table_sndcrdname dw offset _aGravisUltrasou ; DATA XREF:	_text_init2+19Dr
					; "Gravis UltraSound"
		dw offset _aProAudioSpectr ; "Pro Audio Spectrum	16"
		dw offset _aWindowsSoundSy ; "Windows Sound System"
		dw offset _aSoundBlaster16 ; "Sound Blaster 16/16ASP"
		dw offset _aSoundBlasterPr ; "Sound Blaster Pro"
		dw offset _aSoundBlaster	; "Sound Blaster"
		dw offset _aCovox	; "Covox"
		dw offset _aStereoOn1	; "Stereo-On-1"
		dw offset _aAdlibSoundcard ; "Adlib SoundCard"
		dw offset _aPcHonker	; "PC Honker"
		dw offset _aGeneralMidi	; "General MIDI"
_aGravisUltrasou	db 'Gravis UltraSound',0 ; DATA XREF: dseg:_table_sndcrdnameo
_aGravisMaxCodec	db 'Gravis MAX Codec',0
_aProAudioSpectr	db 'Pro Audio Spectrum 16',0 ; DATA XREF: dseg:02ACo
_aWindowsSoundSy	db 'Windows Sound System',0 ; DATA XREF: dseg:02AEo
_aSoundBlaster16	db 'Sound Blaster 16/16ASP',0 ; DATA XREF: dseg:02B0o
_aSoundBlasterPr	db 'Sound Blaster Pro',0 ; DATA XREF: dseg:02B2o
_aSoundBlaster	db 'Sound Blaster',0    ; DATA XREF: dseg:02B4o
_aCovox		db 'Covox',0            ; DATA XREF: dseg:02B6o
_aStereoOn1	db 'Stereo-On-1',0      ; DATA XREF: dseg:02B8o
_aAdlibSoundcard	db 'Adlib SoundCard',0  ; DATA XREF: dseg:02BAo
_aPcHonker	db 'PC Honker',0        ; DATA XREF: dseg:02BCo
_aGeneralMidi	db 'General MIDI',0     ; DATA XREF: dseg:02BEo
_atop_title	dw 152h			; DATA XREF: _txt_draw_top_title+12o
		db 7Fh
_aInertiaPlayerV1_22A db	'Inertia Player V1.22 Assembly ',27h,'94 CD Edition by Sound Solution'
		db 's'
		db    1
		db 0F4h	; ô
		db    1
_aCopyrightC1994	db 'Copyright (c) 1994,1995 by Stefan Danes and Ramon van Gorkom',0
		db 2
		db  78h	; x
		db    1
		db 0AAh	; ª
		db    1
_aShell130295211	db 'Shell: 13/02/95 21:15:58'
		db    1
		db  46h	; F
		db    1
_aPlayer13029521	db 'Player: '
_a130295211558	db '13/02/95 21:15:58',0 ; DATA XREF: _read_module+BEw
_bottom_menu	dw 0Ah			; DATA XREF: _text_init2+21Fo
		db 7Fh
asc_1CC2D	db '                              ' ; DATA XREF: _read_module+A3o
		db    1
		dw 0AAh
		db    2
		db 7Eh
_aFilename_0	db 'Filename      : '
		db    2
		db 7Fh
_aFilename_ext	db 'FileName.Ext'       ; DATA XREF: _read_module:loc_19E41o
		db    1
		dw 14Ah
		db    2
		db 7Eh
_aModuleType_0	db 'Module Type   : '
		db    2
		db  7Fh	; 
_module_type_txt	db '    '               ; DATA XREF: _read_module+6Fw
		db    2
		db  7Eh	; ~
		db    1
		dw 1EAh
_aChannels	db 'Channels      :'
		db    1
		dw 28Ah
_aSamplesUsed	db 'Samples Used  :'
		db    1
		dw 32Ah
_aCurrentTrack	db 'Current Track :'
		db    1
		dw 3CAh
_aTrackPosition	db 'Track Position:'
		db    1
		dw 46Ah
_aSpeed		db 'Speed'
		db    1
		dw 486h
		db ':'
		db    2
		db  78h	; x
		db    1
		dw 4A4h
_aTab		db 'Tab'
		db    1
		dw 0F8h
		db    2
_byte_1CCEB	db 78h			; DATA XREF: _text_init2:loc_1A6C2w
		db 0FEh	; þ
		db    2
		db 7Eh
_aPlayingInStereoFree db	' Playing in Stereo, Free:'
		db    1
		dw 198h
		db    2
		db  78h	; x
		db 0FEh	; þ
		db    2
		db 7Eh
_aProtracker1_0_0 db ' ProTracker 1.0'
		db    1
		dw 1CEh
		db    2
		db 78h
_aF9_4		db 'F-9'
		db    1
		dw 238h
		db    2
		db  78h	; x
		db 0FEh	; þ
		db    2
		db 7Eh
_aIgnoreBpmChanges db ' Ignore BPM changes'
		db    1
		dw 26Eh
		db    2
		db 78h
_aF10_1		db 'F-10'
		db    2
		db  7Eh	; ~
		db    1
		dw 2D8h
		db    2
		db  78h	; x
		db 0FEh	; þ
		db    2
		db 7Eh
_aLoopModuleWhenDone db ' Loop Module when done'
		db    1
		dw 30Eh
		db    2
		db 78h
_aF11_1		db 'F-11'
		db    2
		db 7Eh
		db    1
		dw 378h
		db    2
		db 78h
		db 0FEh	; þ
		db    2
		db 7Eh
_a24bitInterpolation db ' 24bit Interpolation'
		db    1
		dw 3AEh
		db    2
		db 78h
_aF12_1		db 'F-12'
		db    2
		db  7Eh	; ~
		db    1
		dw 418h
_aMainVolume	db 'Main Volume   :'
		db 1
		dw 44Eh
		db    2
		db 78h
		db '- +'
		db    2
		db  7Eh	; ~
		db    1
		dw 4B8h
_aVolumeAmplify	db 'Volume Amplify:'
		db    1
		dw 4EEh
		db    2
		db  78h	; x
		db '[ ]',0
_f1_help_text	dw 3F8h			; DATA XREF: seg001:1CD8o
		db 7Fh
_aSoYouWantedSomeHelp db	'So you wanted some help?'
		db    1
		dw 468h
		db    2
		db 7Fh
_aF2_0		db 'F-2'
		db    2
		db 7Eh
_aGraphicalScopesOneF db	'  Graphical scopes, one for each channel'
		db    1
		dw 508h
		db    2
		db 7Fh
_aF3_0		db 'F-3'
		db    2
		db 7Eh
_aRealtimeVuMeters db '  Realtime VU meters'
		db    1
		dw 5A8h
		db    2
		db 7Fh
_aF4_0		db 'F-4'
		db    2
		db 7Eh
_aViewSampleNamesTwic db	'  View sample names (twice for more)'
		db    1
		dw 648h
		db    2
		db 7Fh
_aF5_0		db 'F-5'
		db    2
		db 7Eh
_aFastfourierFrequenc db	'  FastFourier Frequency Analysis'
		db    1
		dw 6E8h
		db    2
		db 7Fh
_aF8_0		db 'F-8'
		db    2
_aDosShellTypeEx	db 7Eh
_aDosShellTypeExitToR db	'  DOS Shell (Type EXIT to return)'
		db    1
		dw 788h
		db    2
_aF9_1		db 7Fh
_aF9_2		db 'F-9'
		db    2
_aProtracker1_0C	db 7Eh
_aProtracker1_0Compat db	'  ProTracker 1.0 compatibility on/off'
		db    1
		dw 828h
		db    2
_aF10		db 7Fh
_aF10_0		db 'F-10'
		db    2
_aDisableBpmOnOf	db 7Eh
_aDisableBpmOnOff db ' Disable BPM on/off'
		db    1
		dw 8C8h
		db    2
_aF11		db 7Fh
_aF11_0		db 'F-11'
		db    2
_aLoopModule	db 7Eh
_aLoopModule_0	db ' Loop module'
		db    1
		dw 968h
		db    2
_aF12		db 7Fh
_aF12_0		db 'F-12'
		db    2
_aToggle24bitInt	db 7Eh
_aToggle24bitInterpol db	' Toggle 24bit Interpolation'
		db    1
		dw 4C4h
		db    2
_aGray		db 7Fh
_aGray_0		db 'Gray - +'
		db    2
_aDecIncVolume	db 7Eh
_aDecIncVolume_0	db '  Dec/Inc volume'
		db    1
		dw 56Eh
		db    2
		db 7Fh
		db '[ ]'
		db    2
_aDecIncAmplify	db 7Eh
_aDecIncAmplify_0 db '  Dec/Inc amplify'
		db    1
		dw 600h
		db    2
_aCursor		db 7Fh
_aCursor_1	db 'Cursor '
		db  1Ah
		db ' '
		db  18h
		db    2
		db  7Eh	; ~
_aFastErForward	db '  Fast(er) forward'
		db    1
		dw 6A0h
		db    2
		db 7Fh
_aCursor_0	db 'Cursor ',1Bh,' '
		db  19h
		db    2
		db  7Eh	; ~
_aFastErRewind	db '  Fast(er) rewind'
		db    1
		dw 744h
		db    2
		db 7Fh
_a1Thru0		db '1 Thru 0'
		db    2
		db  7Eh	; ~
_aMuteChannel	db '  Mute channel'
		db    1
		dw 7E0h
		db    2
		db 7Fh
_aScrolllock	db 'ScrollLock'
		db    2
		db  7Eh	; ~
_aLoopPattern	db '  Loop pattern'
		db    1
		dw 88Ah
		db    2
		db  7Fh	; 
_aPause		db 'Pause'
		db    2
		db  7Eh	; ~
_aGuess___	db '  Guess...'
		db    1
		dw 92Eh
		db    2
		db 7Fh
_aEnd		db 'End'
		db    2
		db  7Eh	; ~
_aEndPattern	db '  End pattern'
		db    1
		dw 9CEh
		db    2
		db 7Fh
_aTab_0		db 'Tab'
		db    2
		db  7Eh	; ~
_aTogglePalNtsc	db '  Toggle PAL/NTSC',0
; char _hopeyoulike[1]
_hopeyoulike	dw 3C6h			; DATA XREF: _start+204o
		db 7Eh
_aHopeYouLikedUsingTh db	'Hope you liked using the '
		db    2
		db  7Fh	; 
_aInertiaPlayer	db 'Inertia Player'
		db    2
		db  7Eh	; ~
_aWhichIsWrittenIn db ' which is written in '
		db    2
		db  7Fh	; 
_a100Assembler	db '100% assembler!'
		db    2
		db  7Eh	; ~
		db    1
		dw 50Ch
_aIfYouHaveBugReports db	'If you have bug-reports, suggestions or comments send a message t'
		db 'o:'
		db    1
		dw 5ACh
_aInternet	db 'Internet : '
		db    2
		db  7Fh	; 
_aSdanes@marvels_hack db	'sdanes@marvels.hacktic.nl'
		db    2
		db  7Eh	; ~
		db    1
		dw 64Ch
_aFidonet	db 'FidoNet  : '
		db    2
		db  7Fh	; 
_a2284116_8	db '2:284/116.8'
		db    2
		db  7Eh	; ~
		db    1
		dw 826h
_aSendEmailTo	db 'Send email to '
		db    2
		db  7Fh	; 
_aListserver@oliver_s db	'listserver@oliver.sun.ac.za'
		db    2
		db  7Eh	; ~
_aToSubscribeToOneOrB db	' to subscribe to one or both of'
		db    1
		dw 8C6h
_aThe		db 'the '
		db    2
		db  7Fh	; 
_aInertiaMailinglists db	'Inertia Mailinglists'
		db    2
		db  7Eh	; ~
_aAndWriteFollowingTe db	' and write following text in your message:'
		db    1
		dw 966h
_aToConnectToBinaryIn db	'To connect to Binary Inertia releases: '
		db    2
		db  7Fh	; 
_aSubscribeInertiaLis db	'subscribe inertia-list YourRealName'
		db    2
		db  7Eh	; ~
		db    1
		dw 0A06h
_aToConnectToDiscussi db	'To connect to Discussion Mailing list: '
		db    2
		db  7Fh	; 
_aSubscribeInertiaTal db	'subscribe inertia-talk YourRealName',0
; char _word_1D26D
_word_1D26D	dw 3F2h			; DATA XREF: _dosexec+19o
		db  7Eh	; ~
_aShellingToOperating db	'Shelling to Operating System...'
		db    1
		dw 52Ah
_aType		db 'Type '
		db    2
		db  7Fh	; 
_aExit		db 'EXIT'
		db    2
		db  7Eh	; ~
_aToReturnTo	db ' to return to '
		db    2
		db  7Fh	; 
_aInertiaPlayer_0 db 'Inertia Player',0
; char _msg[]
_msg		db 'Searching directory for modules  ',0 ; DATA XREF: _start+2F7o
; char _aLoadingModule[]
_aLoadingModule	db 'Loading module',0   ; DATA XREF: _start+41Ao
; char _aModuleIsCorrupt[]
_aModuleIsCorrupt db 'Module is corrupt!',0 ; DATA XREF: _start+439o
_aNotEnoughDram_0 db 'Not enough DRAM on your UltraSound to load all samples!',0
					; DATA XREF: _start+431o
_aNotEnoughMemo_0 db 'Not enough memory available to load all samples!',0
					; DATA XREF: _start+429o
; char _aDeleteMarkedFil[]
_aDeleteMarkedFil db 'Delete marked files? [Y/N]',0 ; DATA XREF: _start+635o
; char _aDeletingFile[15]
_aDeletingFile	db 'Deleting file: '    ; DATA XREF: _start+69Fo
_aFile		db 'File'               ; DATA XREF: _start+689w _start+6A8o
_aName		db 'name'               ; DATA XREF: _start+692w
_a_ext		db '.Ext'               ; DATA XREF: _start+69Bw
		db 0
_aPal		db '(PAL) ',0           ; DATA XREF: _txt_draw_bottom+49o
; char _aNtsc[]
_aNtsc		db '(NTSC)',0           ; DATA XREF: _txt_draw_bottom+53o
; char _word_1D3B0[1]
_word_1D3B0	dw 49Eh			; DATA XREF: _start+723o
		db  7Bh	; {
_aFileSelectorHelp db 'File Selector Help'
		db    1
		dw 6F2h
		db    2
		db  7Eh	; ~
_aUse		db 'Use '
		db    2
		db  7Fh	; 
_aHome		db 'Home'
		db    2
		db  7Eh	; ~
		db ','
		db    2
		db  7Fh	; 
_aEnd_0		db 'End'
		db    2
		db  7Eh	; ~
		db ','
		db    2
		db  7Fh	; 
_aPgup		db 'PgUp'
		db    2
		db  7Eh	; ~
		db ','
		db    2
		db  7Fh	; 
_aPgdn		db 'PgDn'
		db    2
		db  7Eh	; ~
		db ','
		db    2
		db  7Fh	; 
		db  18h
		db    2
		db  7Eh	; ~
_aAnd		db ' and '
		db    2
		db  7Fh	; 
		db  19h
		db    2
		db  7Eh	; ~
_aToMoveTheHighlighte db	' to move the highlighted bar'
		db    1
		dw 792h
_aPress		db 'Press '
		db    2
		db  7Fh	; 
_aEnter		db 'Enter'
		db    2
		db  7Eh	; ~
_aToPlayTheModuleOrSe db	' to play the module or select the drive/directory'
		db    1
		dw 8D2h
		db    2
		db  7Fh	; 
_aEsc		db 'ESC'
		db    2
		db  7Eh	; ~
		db    1
		dw 8E6h
_aQuitIplay	db 'Quit IPLAY'
		db    1
		dw 972h
		db    2
		db  7Fh	; 
_aF1		db 'F-1'
		db    2
		db  7Eh	; ~
		db    1
		dw 986h
_aThisHelpScreenButIG db	'This help screen, but I guess you already found it...'
		db    1
		dw 0A12h
		db    2
		db  7Fh	; 
_aF8_1		db 'F-8'
		db    2
		db  7Eh	; ~
		db    1
		dw 0A26h
_aDosShellTypeExitT_0 db	'DOS Shell (Type EXIT to return)'
		db    1
		dw 0AB2h
		db    2
		db  7Fh	; 
_aF9_3		db 'F-9'
		db    2
		db  7Eh	; ~
		db    1
		dw 0AC6h
_aToggleQuickreadingO db	'Toggle QuickReading of module name'
		db    1
		dw 0B52h
unk_1D516	db    2
		db  7Fh	; 
_aDel		db 'Del'
		db    2
		db  7Eh	; ~
		db    1
		dw 0B66h
_aMarkFileToDelete db 'Mark file to delete'
		db    1
		dw 0BF2h
		db    2
		db  7Fh	; 
_aCtrlDel	db 'Ctrl Del'
		db    2
		db  7Eh	; ~
		db    1
		dw 0C06h
_aDeleteAllFilesWhich db	'Delete all files which are marked to delete'
		db    1
		dw 0C92h
		db    2
		db  7Fh	; 
_aBackspace	db 'BackSpace'
		db    2
		db  7Eh	; ~
		db    1
		dw 0CA6h
_aReturnToPlaymodeOnl db	'Return to playmode [Only if the music is playing]'
		db    1
		dw 0E86h
		db    2
		db  7Eh	; ~
_aPressAnyKeyToReturn db	'Press any key to return to the fileselector',0
; char _aPressF1ForHelpQu[11]
_aPressF1ForHelpQu db '                 Press F-1 for help, QuickRead='
					; DATA XREF: _start+367o
_word_1D614	dw 2020h		; DATA XREF: _useless_197F2+7w
					; _useless_197F2:loc_19810w
_byte_1D616	db 20h			; DATA XREF: _useless_197F2+Dw
					; _useless_197F2+24w
_aF9		db ' [F-9]              ',0
_aHitBackspaceToRe db 'Hit backspace to return to playmode, F-1 for help, QuickRead='
					; DATA XREF: _start+35Do
_word_1D669	dw 2020h		; DATA XREF: _useless_197F2+12w
					; _useless_197F2+29w
_byte_1D66B	db 20h			; DATA XREF: _useless_197F2+18w
					; _useless_197F2+2Fw
_aF9_0		db ' [F-9]',0
_aSamplename	db '# SampleName   '    ; DATA XREF: seg001:1B7Co
		db    2
_aXpressF4ForMor	db 'xPress F-4 for more'
		db    2
_aSizeVolModeC2T	db '~   Size Vol Mode  C-2 Tune LoopPos LoopEnd',0
unk_1D6C3	db    2			; DATA XREF: seg001:1BDAo
_aUnused256	db ' Unused'
_a256		db '256',0              ; DATA XREF: _text_init2+1CEo
_a512		db '512',0
_a768		db '768',0
_a1024		db '1024',0
; char _aKb[]
_aKb		db 'KB',0               ; DATA XREF: _text_init2+1D7o
asc_1D6E0	db '               ',0  ; DATA XREF: seg001:1A80o
_aPortamentoUp	db 'Portamento Up  ',0
_aPortamentoDown	db 'Portamento Down',0
_aTonePortamento	db 'Tone Portamento',0
_aVibrato	db 'Vibrato        ',0
_aPortVolslide	db 'Port + VolSlide',0
_aVibrVolslide	db 'Vibr + VolSlide',0
_aTremolo	db 'Tremolo        ',0
_aFinePanning	db 'Fine Panning   ',0
_aSetSampleOfs	db 'Set Sample Ofs ',0
_aVolumeSliding	db 'Volume Sliding ',0
_aPositionJump	db 'Position Jump  ',0
_aVolumeChange	db 'Volume Change  ',0
_aPatternBreak	db 'Pattern Break  ',0
_aE_command	db 'E_Command      ',0
_aSetSpeedBpm	db 'Set Speed/BPM  ',0
_aSetSpeed	db 'Set Speed      ',0
_aFinePortaUp	db 'Fine Porta Up  ',0
_aFinePortaDown	db 'Fine Porta Down',0
_aFineTonePorta	db 'Fine Tone Porta',0
_aFineVibrato	db 'Fine Vibrato   ',0
_aFineVolSlide	db 'Fine Vol Slide ',0
_aFinePortVolsl	db 'Fine Port+VolSl',0
_aFineVibrVolsl	db 'Fine Vibr+VolSl',0
_aSetStmSpeed	db 'Set STM Speed  ',0
_aAutoToneporta	db 'Auto TonePorta ',0
_aTriller	db 'Triller        ',0
_aTremor		db 'Tremor         ',0
_aRetrigVolume	db 'Retrig+Volume  ',0
_aArpeggio	db 'Arpeggio       ',0  ; DATA XREF: seg001:loc_1AB0Do
_aSetAmplify	db 'Set Amplify    ',0
_aFarTempo	db 'FAR Tempo      ',0
_aFarFineTempo	db 'FAR Fine Tempo ',0
_aSetFilter	db 'Set Filter     ',0  ; DATA XREF: seg001:1A9Ao
_aFineslideUp	db 'FineSlide Up   ',0
_aFineslideDown	db 'FineSlide Down ',0
_aGlissandoCtrl	db 'Glissando Ctrl ',0
_aVibratoControl	db 'Vibrato Control',0
_aSetFinetune	db 'Set FineTune   ',0
_aJumpToLoop	db 'Jump To Loop   ',0
_aTremoloControl	db 'Tremolo Control',0
_aSetPanning	db 'Set Panning    ',0
_aRetriggerNote	db 'Retrigger Note ',0
_aFinevolumeUp	db 'FineVolume Up  ',0
_aFinevolumeDown	db 'FineVolume Down',0
_aNoteCut	db 'Note Cut       ',0
_aNoteDelay	db 'Note Delay     ',0
_aPatternDelay	db 'Pattern Delay  ',0
_aInvertLoop	db 'Invert Loop    ',0
_aSetLoopPoint	db 'Set Loop Point ',0  ; DATA XREF: seg001:1A8Fo
asc_1DA00	db '                      ',0 ; DATA XREF: _modules_search:loc_19BDDo
					; seg001:loc_1A9A5o
_aMute		db '<Mute>                ',0 ; DATA XREF: seg001:1949o
; char _aMarkedToDelete[]
_aMarkedToDelete	db '<Marked to Delete>    ',0 ; DATA XREF: _filelist_198B8+10Do
_notes		db '  C-C#D-D#E-F-F#G-G#A-A#B-' ; DATA XREF: seg001:1930r
					; seg001:1B31r	...
_slider		db 'Ä\|/Ä\|/'           ; DATA XREF: _modules_search+7Fr
					; _modules_search+F8r
_aModuleNotFound	db 'Module not found.',0Dh,0Ah,'$' ; DATA XREF: _find_mods+88o
_aModuleLoadErro	db 'Module load error.',0Dh,0Ah,'$' ; DATA XREF: _readallmoules+1Bo
					; _read_module+5o
_aNotEnoughMemor	db 'Not enough memory.',0Dh,0Ah,'$' ; DATA XREF: _start+23Do
_aListFileNotFou	db 'List file not found.',0Dh,0Ah,'$' ; DATA XREF: _start+D07o
_aCriticalErrorT	db 0Dh,0Ah		; DATA XREF: _start+31o
		db 0Ah
		db 'Critical error: The player jumped to DOS, and should not be invok'
		db 'ed again.',0Dh,0Ah
		db 'Close this DOS session first with the "EXIT" command.',0Dh,0Ah
		db 0Ah
		db '(Press any key to continue)$'
_sIplay_cfg	db 'C:\IPLAY.CFG',0     ; DATA XREF: _loadcfgo
_buffer_1DB6C	db 128 dup(0)		; DATA XREF: _start+189r _start+192r ...
_buffer_1DBEC	db 0			; DATA XREF: _find_mods+32o
					; _dosfindnexto
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
unk_1DC01	db    0			; DATA XREF: _modules_search+8Fr
					; _modules_search+108r ...
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
_byte_1DC0A	db 62h dup(0)		; DATA XREF: _find_mods+6Fo
; char _buffer_1DC6C[]
_buffer_1DC6C	dd 0			; DATA XREF: _start+2C5w _start+2D3o ...
unk_1DC70	db    0			; DATA XREF: _modules_search+1D8o
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db 0
unk_1DC7B	db    0			; DATA XREF: _modules_search+1C9o
_byte_1DC7C	db 70h dup(0)		; DATA XREF: _modules_search+1BAo
					; _modules_search+202o
_dword_1DCEC	dd 10524E49h		; DATA XREF: _loadcfg+1Ar
_cfg_buffer	db    4			; DATA XREF: _loadcfg+Co _loadcfg+1Er
_snd_card_type	db 3			; DATA XREF: _text_init2+18Er
					; _text_init2+1ADr ...
_snd_base_port_0	dw 0FFFFh		; DATA XREF: _callsubx+3r _callsubx+45w
_irq_number_1	db 0FFh			; DATA XREF: _callsubx+7r _callsubx+49w
_dma_channel_1	db 0FFh			; DATA XREF: _callsubx+Br _callsubx+4Dw
_freq_1DCF6	db 2Ch			; DATA XREF: _callsubx+Fr _callsubx+51w
_byte_1DCF7	db 0FFh			; DATA XREF: _callsubx+1Cr _callsubx+55w
_byte_1DCF8	db 14h			; DATA XREF: _start+DAr	_callsubx+20r ...
_configword	dw 218Bh		; DATA XREF: _start+60w	_start+6Cw ...
_byte_1DCFB	db 4Bh			; DATA XREF: _callsubx+13r
		db    0
; char _mystr[66]
_mystr		db 42h dup(0)		; DATA XREF: _start:loc_192E0o
					; _start:loc_1964Eo
; char _byte_1DD3F[69]
_byte_1DD3F	db 45h dup(0)		; DATA XREF: _dosexec:loc_1C209o
					; _dosexec:loc_1C25Co
_a_mod_nst_669_s	db '.MOD.NST.669.STM.S3M.MTM.PSM.WOW.INR.FAR.ULT.OKT.OCT',0,0,0,0
					; DATA XREF: _modules_search+12Do
					; _find_mods+46o
_aPlaypausloop	db 'PlayPausLoop'       ; DATA XREF: _txt_draw_bottom+164o
_aJanfebmaraprmayj db '   JanFebMarAprMayJunJulAugSepOctNovDec'
					; DATA XREF: _filelist_198B8+A4o
_frameborder	db '      ÛÛÛÛÛÛÉ»È¼ÍºÚ¿ÀÙÄ³Ö·Ó½ÄºÕ¸Ô¾Í³',0 ; DATA XREF: _draw_frame+3Do
_oint8off_1DE14	dw 0			; DATA XREF: _start+F9w
_oint8seg_1DE16	dw 0			; DATA XREF: _start+FDw
_critsectpoint_off dw 0			; DATA XREF: _start+150w
_critsectpoint_seg dw 0			; DATA XREF: _start+154w
_swapdata_off	dw 0			; DATA XREF: _start+161w
_swapdata_seg	dw 0			; DATA XREF: _start+165w
_videomempointer	dd 0			; DATA XREF: _start:loc_1917Dw
					; _start+207r ...
_videopoint_shiftd dd 0			; DATA XREF: _text_init2+5Fw
					; _text_init2+BEw ...
_segfsbx_1DE28	dd 0			; DATA XREF: _read_module+99w
					; _keyb_19EFD:_l_rightr ...
_dword_1DE2C	dd 0			; DATA XREF: _text_init2+22Aw
					; seg001:196Br	...
_messagepointer	dd 0			; DATA XREF: _start+228r _start+23Dw ...
_volume_1DE34	dd 0			; DATA XREF: _read_module+DAw
					; seg001:19F4r
_outp_freq	dw 0			; DATA XREF: _read_module+82w
					; _text_init2:loc_1A699r ...
_esseg_atstart	dw 0			; DATA XREF: _start+5w _parse_cmdline+7r ...
off_1DE3C	dw offset loc_19050	; DATA XREF: _start+186w _start+6E7r ...
_offs_draw	dw offset loc_19050	; DATA XREF: _keyb_19EFD+32r
					; _keyb_19EFD:_l_f4r ...
_offs_draw2	dw offset loc_19050	; DATA XREF: _keyb_19EFD+486r
					; _keyb_19EFD+49Ar ...
off_1DE42	dw offset loc_19050	; DATA XREF: _keyb_19EFD:_l_f8r
					; _f1_help+12w ...
_amount_of_x	dw 0			; DATA XREF: _read_module+75w
					; _read_module+D1r ...
_word_1DE46	dw 0			; DATA XREF: _keyb_19EFD+316r
					; _text_init2+244w ...
_current_patterns dw 0			; DATA XREF: _read_module+5Fw
					; _keyb_19EFD+30Fw ...
_word_1DE4A	dw 0			; DATA XREF: _find_mods+14w
					; _find_mods+4Er
_word_1DE4C	dw 0			; DATA XREF: _find_mods+2Ew
					; _find_mods+75r
_word_1DE4E	dw 0			; DATA XREF: _start+19Bw
					; _modules_search+5Fw ...
_word_1DE50	dw 0			; DATA XREF: _start:loc_19242r
					; _readallmoules:loc_19D75r ...
_word_1DE52	dw 0			; DATA XREF: _start+3DCr _start+5D2r ...
_word_1DE54	dw 0			; DATA XREF: _start+4B1r
					; _start:loc_1955Dr ...
_word_1DE56	dw 0			; DATA XREF: _modules_search+4Cw
					; _modules_search+B1w
_word_1DE58	dw 0			; DATA XREF: _modules_search+52w
					; _modules_search+172w
_word_1DE5A	dw 0			; DATA XREF: _modules_search+58w
					; _modules_search+27Dw
_word_1DE5C	dw 0			; DATA XREF: _start+5FFw _start+60Cw ...
_word_1DE5E	dw 0			; DATA XREF: _start+25Aw
					; _start:loc_19464r ...
_word_1DE60	dw 0			; DATA XREF: _start+308w _start+5EBw ...
_word_1DE62	dw 0			; DATA XREF: _start+254w _start+31Fr ...
_word_1DE64	dw 0			; DATA XREF: _modules_searchw
					; _modules_search+75r ...
_word_1DE66	dw 0			; DATA XREF: _modules_search+6w
					; _modules_search+79r ...
_fhandle_1DE68	dw 0			; DATA XREF: _init_vga_waves+42w
					; _init_vga_waves+49r ...
_word_1DE6A	dw 0			; DATA XREF: _keyb_19EFD+1Cw
					; _txt_draw_bottom+118r
_word_1DE6C	dw 0			; DATA XREF: _keyb_19EFD+27w
					; _txt_draw_bottom+13Br
_word_1DE6E	dw 0			; DATA XREF: _keyb_19EFD+30Br
					; _text_init2+52w ...
_byte_1DE70	db 0			; DATA XREF: _start+168w _start+268w ...
_byte_1DE71	db 0			; DATA XREF: seg001:loc_1A934w
					; seg001:loc_1AA73w
_byte_1DE72	db 0			; DATA XREF: _keyb_19EFD+5w
					; _txt_draw_bottom+66r
_byte_1DE73	db 0			; DATA XREF: _read_module+79w
					; _txt_draw_bottom+72r
_byte_1DE74	db 0			; DATA XREF: _keyb_19EFD+9w
					; _txt_draw_bottom+92r
_byte_1DE75	db 0			; DATA XREF: _keyb_19EFD+Cw
					; _txt_draw_bottom+1Br
_byte_1DE76	db 0			; DATA XREF: _keyb_19EFD+10w
					; _txt_draw_bottom+2Br
_flg_play_settings db 0			; DATA XREF: _keyb_19EFD+2Fw
					; _txt_draw_bottom+4Cr ...
_byte_1DE78	db 0			; DATA XREF: _read_module+8Bw
					; _dosexec+2Cr ...
_byte_1DE79	db 0			; DATA XREF: _video_prp_mtr_positn+2w
					; _video_prp_mtr_positn:loc_1C365w ...
_byte_1DE7A	db 0			; DATA XREF: _video_prp_mtr_positn+7w
					; _video_prp_mtr_positn+1Dw ...
_byte_1DE7B	db 0			; DATA XREF: _read_module+96w
					; _text_init2+20Fr
_byte_1DE7C	db 0			; DATA XREF: _start:loc_193BCr
					; _start+347r ...
_byte_1DE7D	db 0			; DATA XREF: _start+32Fw _start+34Ar ...
_byte_1DE7E	db 0			; DATA XREF: _start+1B9w _start+217r ...
_byte_1DE7F	db 0			; DATA XREF: _start+260w _start+2F0r ...
		db    1
_byte_1DE81	db 0			; DATA XREF: _spectr_1BBC1+20r
					; _video_prp_mtr_positn+58w
_byte_1DE82	db 0			; DATA XREF: _start+E1w
					; _spectr_1BBC1:loc_1BBF4r ...
_byte_1DE83	db 3			; DATA XREF: _start+E7w
					; seg001:loc_1AA4Fr ...
_byte_1DE84	db 0			; DATA XREF: _read_module+65w
					; _keyb_19EFD:_l_upw ...
_byte_1DE85	db 0			; DATA XREF: _keyb_19EFD+2EBw
					; _keyb_19EFD+2FBw ...
_byte_1DE86	db 0			; DATA XREF: _start+D7w	_text_init2r ...
		db 0
_dword_1DE88	dd 0			; DATA XREF: _start+7DBr _start+7E2w ...
_mousecolumn	dw 0			; DATA XREF: _start+7A0r _start+7BCr ...
_mouserow	dw 0			; DATA XREF: _start+7A3r _start+7BFr ...
_byte_1DE90	db 0			; DATA XREF: _start:loc_193C7r
					; _start+33Er ...
_mouse_exist_flag db 0			; DATA XREF: _mouse_init:loc_1C6EFw
					; _mouse_init:loc_1C708w ...
_mouse_visible	db 0Ah dup(0)		; DATA XREF: _mouse_initw
					; _mouse_deinit+Cw ...
_x_storage	dw  0, 0, 0, 0,	0, 0, 0, 0, 0, 0, 0, 0,	0, 0, 0, 0, 0
					; DATA XREF: _f2_draw_waves+1Eo
					; _f2_draw_waves2+Do ...
		dw  0, 0, 0, 0,	0, 0, 0, 0, 0, 0, 0, 0,	0, 0, 0, 0
		db    0
		align 10h
; char _buffer_1[272]
_buffer_1	db 200h	dup(0)		; DATA XREF: _start-30o
					; _start:loc_1906Eo ...
					; 2800h
_byte_1E0E0	db 7BBh	dup(0)		; DATA XREF: _f5_draw_spectr+29Do
					; _f5_draw_spectr+56Do
_byte_1E89B	db 1E44h dup(0)
		align 10h
_buffer_2	db 2800h dup(0)		; DATA XREF: _init_vga_waves+173o
_buffer_1seg	dw 0			; DATA XREF: _text_init2+18Bw
					; seg001:18B2r	...
_buffer_2seg	dw 0			; DATA XREF: seg001:loc_1A913w
					; seg001:19D1r	...
_byte_22EE4	db 1000h dup(0)		; DATA XREF: _f5_draw_spectr+2A8o
					; _f5_draw_spectr+2D0o ...
unk_23EE4	db    0			; DATA XREF: _init_f5_spectr+98o
					; _f5_draw_spectr+2D9o ...
_byte_23EE5	db 63h dup(0)		; DATA XREF: _f5_draw_spectr+5C0o
_byte_23F48	db 12Ch	dup(0)		; DATA XREF: _f5_draw_spectr+5E2o
unk_24074	db    0			; DATA XREF: _f5_draw_spectr+5A9o
					; _f5_draw_spectr+5C9o ...
_byte_24075	db 63h dup(0)		; DATA XREF: _f5_draw_spectr+5D2o
_byte_240D8	db 12Ch	dup(0)		; DATA XREF: _f5_draw_spectr+5EFo
_byte_24204	db 200h	dup(0)		; DATA XREF: _f5_draw_spectr+1Ao
					; _f5_draw_spectr+2A5o ...
_palette_24404	db    0			; DATA XREF: _init_vga_waves+17o
		db    1
		db    2
		db    3
		db    4
		db    5
		db    6
		db    7
		db    8
		db    9
		db  0Ah
		db  0Bh
		db  0Ch
		db  0Dh
		db  0Eh
		db  0Fh
		db    0
_vga_palette	db 0,0,0		; DATA XREF: _init_vga_waves+1Fo
		db 2,2,6
		db 4,5,0Dh
		db 7,8,15h
		db 0Ah,0Bh,1Bh
		db 0Dh,0Eh,21h
		db 10h,11h,2Ah
		db 13h,14h,31h
		db 0,2Ah,2Ah
		db 0,2Dh,2Dh
		db 0,30h,30h
		db 0,33h,33h
		db 0,36h,36h
		db 0,39h,39h
		db 0,3Ch,3Ch
		db 0,3Fh,3Fh
_word_24445	dw 0			; DATA XREF: _dosexec+69w _dosexec+78o ...
		dd unk_24453
		dd unk_24456
		dd unk_24456
unk_24453	db    0			; DATA XREF: dseg:7C57o
		db  20h
		db  0Dh
unk_24456	db  20h			; DATA XREF: dseg:7C5Bo dseg:7C5Fo
		db  20h
		db  20h
		db  20h
		db  20h
		db  20h
		db  20h
		db  20h
		db  20h
		db  20h
		db  20h
; struct struct_0 _str_24461
_str_24461	struct_0 <6, 9,	49h, 9,	offset loc_1957F> ; DATA XREF: _start+79Do
		struct_0 <6, 19h, 49h, 19h, offset loc_1953C>
		struct_0 <8, 0Ah, 47h, 18h, offset loc_19880>
		struct_0 <2, 1,	4Dh, 4,	offset loc_19762>
		dw 0FFFFh
; struct struct_0 stru_2448B
stru_2448B	struct_0 <6, 9,	49h, 9,	offset loc_1957F> ; DATA XREF: _start+7B9o
		struct_0 <6, 19h, 49h, 19h, offset loc_1953C>
		struct_0 <2, 1,	4Dh, 4,	offset loc_1964E>
		dw 0FFFFh
; struct struct_0 stru_244AB
stru_244AB	struct_0 <2, 1,	4Dh, 4,	offset _l_enter>	; DATA XREF: _keyb_19EFD+4AFo
		dw 0FFFFh
; struct struct_0 stru_244B7
stru_244B7	struct_0 <0, 0,	4Fh, 31h, offset _l_esc>	; DATA XREF: _keyb_19EFD:loc_1A3C5o
		dw 0FFFFh
		db    0
unk_244C4	db    0			; DATA XREF: _spectr_1B084+14Ew
					; _spectr_1B084+18Br ...
		db    0
		db    0
		db    0
_dword_244C8	dd 0			; DATA XREF: _spectr_1B084+39w
					; _spectr_1B084+62r ...
_multip_244CC	dd 0			; DATA XREF: _spectr_1B084+2Fw
					; _spectr_1B084+152r ...
_multip_244D0	dd 0			; DATA XREF: _spectr_1B084+25w
					; _spectr_1B084+169r ...
_dword_244D4	dd 0			; DATA XREF: _spectr_1B084+3Dw
					; _spectr_1B084+6Ar ...
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
		db    0
_dword_244E4	dd 0			; DATA XREF: _spectr_1B084+8Bw
					; _spectr_1B084+104r ...
_dword_244E8	dd 0			; DATA XREF: _spectr_1B084+9Aw
					; _spectr_1B084+115r ...
_dword_244EC	dd 0			; DATA XREF: _spectr_1B084+A9w
					; _spectr_1B084+BFr ...
_dword_244F0	dd 0			; DATA XREF: _spectr_1B084+B6w
					; _spectr_1B084+CFr ...
_dword_244F4	dd 0			; DATA XREF: _spectr_1B084+66w
					; _spectr_1B084+BAr ...
_dword_244F8	dd 0			; DATA XREF: _spectr_1B084+6Ew
					; _spectr_1B084+DFr ...
_dword_244FC	dd 0			; DATA XREF: _spectr_1B084+CBw
					; _spectr_1B084+108r ...
_dword_24500	dd 0			; DATA XREF: _spectr_1B084+DBw
					; _spectr_1B084+119r ...
_dword_24504	dd 0			; DATA XREF: _spectr_1B084+100w
					; _spectr_1B084+10Dr ...
_dword_24508	dd 0			; DATA XREF: _spectr_1B084+F0w
					; _spectr_1B084+11Er ...
_word_2450C	dw 0			; DATA XREF: _spectr_1B406+4w
					; _spectr_1B406+77r ...
_word_2450E	dw 0			; DATA XREF: _spectr_1B084w
					; _spectr_1B084+7Ar ...
		db    0
		db    0
		db    0
		db    0
_word_24514	dw 0			; DATA XREF: _spectr_1B084+Fr
					; _spectr_1B084+42r ...
_word_24516	dw 0			; DATA XREF: _spectr_1B406+61w
					; _spectr_1B406:loc_1B46Dr ...
_word_24518	dw 0			; DATA XREF: _spectr_1B406+B2w
					; _spectr_1B406+B8r ...
_word_2451A	dw 0			; DATA XREF: _spectr_1B406+D8w
					; _spectr_1B406+DBr
_word_2451C	dw 0			; DATA XREF: _spectr_1B406+74w
					; _spectr_1B406+BDr ...
_word_2451E	dw 0			; DATA XREF: _spectr_1B406+D1w
					; _spectr_1B406+E7r
_word_24520	dw 0			; DATA XREF: _spectr_1B406+Ar
					; _f5_draw_spectr+2CAw ...
_word_24522	dw 0			; DATA XREF: _spectr_1B406+10w
					; _spectr_1B406+3Fr ...
_word_24524	dw 0			; DATA XREF: _init_f5_spectr:loc_1B080w
					; _f5_draw_spectr+2C7r ...
_tabledword_24526 dd    0,65536,46340,25079,12785,6423,3215,1608, 804, 402
					; DATA XREF: _spectr_1B084+20r
					; _spectr_1B084+1CDr ...
		dd  201, 100,  50,  25,	 12
_tabledword_24562 dd -131072,-65536,-19196,-4989,-1260,-316, -79, -20,  -5
					; DATA XREF: _spectr_1B084+2Ar
					; _spectr_1B084+1DAr ...
		dd   -2,  -1,  -1,  -1,	 -1,   0
		db    0
		db    0
ends		dseg

; ===========================================================================

segment	 seg004	byte stack 'STACK' use16
ends	 seg004
segment		seg003 byte public 'UNK' use16
ends	seg003
		end _start
